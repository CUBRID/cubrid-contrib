-- File Open : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\rangeresortopin\RangeResortOpinTrgtState.xml


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\rangeresortopin\RangeResortOpinTrgtState.xml
-- Query    : select
-- Query Id : findRangeResortTrgtCurStateRecordPagedList

 			SELECT E.*			FROM (				SELECT ROWNUM AS rnum					, C.*				FROM (					SELECT D.LAST_READ_RESORT_YYYY						, SUM(CUR_ALL) AS CUR_ALL						, SUM(CUR_LIST) AS CUR_LIST						, SUM(CUR_UNUSE) AS CUR_UNUSE						, SUM(PLAN_ALL) AS PLAN_ALL						, SUM(PLAN_LIST) AS PLAN_LIST						, SUM(PLAN_UNUSE) AS PLAN_UNUSE 					FROM (					    SELECT A.LAST_READ_RESORT_YYYY					    	, SUM(CASE  WHEN A.OPER_READ_RANGE_CD = '01' THEN 1 ELSE 0 END) CUR_ALL					    	, SUM(CASE  WHEN A.OPER_READ_RANGE_CD = '02' THEN 1 ELSE 0 END) CUR_LIST					    	, SUM(CASE  WHEN A.OPER_READ_RANGE_CD = '03' THEN 1 ELSE 0 END) CUR_UNUSE					    	, 0  PLAN_ALL					    	, 0  PLAN_LIST					    	, 0  PLAN_UNUSE 			            FROM TB_RDRECORD A, TB_RDFOLDER B  					    WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID 						AND A.FOLDER_ID = B.FOLDER_ID 						AND A.RECORD_CENTER_ID = '1'						AND B.FOLDER_KEEP_STATE_CD IN('01', '04')					    AND A.LAST_READ_RESORT_YYYY IS NOT NULL					    GROUP BY A.LAST_READ_RESORT_YYYY					    UNION ALL					    SELECT O.BEF_RESORT_YYYY					    	, 0  CUR_ALL					    	, 0  CUR_LIST					    	, 0  CUR_UNUSE					    	, SUM(CASE  WHEN R.OPER_READ_RANGE_CD = '01' THEN 1 ELSE 0 END) PLAN_ALL					    	, SUM(CASE  WHEN R.OPER_READ_RANGE_CD = '02' THEN 1 ELSE 0 END) PLAN_LIST					    	, SUM(CASE  WHEN R.OPER_READ_RANGE_CD = '03' THEN 1 ELSE 0 END) PLAN_UNUSE			            FROM TB_RDRANGERESORTOPIN O, TB_RDRECORD R			            WHERE O.RECORD_CENTER_ID = '1'			            AND O.RECORD_CENTER_ID = R.RECORD_CENTER_ID			            AND	O.RECORD_ID = R.RECORD_ID			            AND	O.CASE_TYPE = '01' AND 					        O.RESORT_YYYY = '1'					     					    GROUP BY  O.BEF_RESORT_YYYY					) D					WHERE D.LAST_READ_RESORT_YYYY IS NOT NULL					GROUP BY D.LAST_READ_RESORT_YYYY					ORDER BY D.LAST_READ_RESORT_YYYY DESC				) C				WHERE ROWNUM <= '1'			) E			WHERE E.rnum >= '1'		 ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\rangeresortopin\RangeResortOpinTrgtState.xml
-- Query    : select
-- Query Id : countRangeResortTrgtCurStateRecordPagedList

 			SELECT COUNT(1) CNT			FROM (		        SELECT D.LAST_READ_RESORT_YYYY					, SUM(CUR_ALL) AS CUR_ALL					, SUM(CUR_LIST) AS CUR_LIST					, SUM(CUR_UNUSE) AS CUR_UNUSE					, SUM(PLAN_ALL) AS PLAN_ALL					, SUM(PLAN_LIST) AS PLAN_LIST					, SUM(PLAN_UNUSE) AS PLAN_UNUSE 				FROM (				    SELECT A.LAST_READ_RESORT_YYYY				    	, SUM(CASE  WHEN A.OPER_READ_RANGE_CD = '01' THEN 1 ELSE 0 END) CUR_ALL				    	, SUM(CASE  WHEN A.OPER_READ_RANGE_CD = '02' THEN 1 ELSE 0 END) CUR_LIST				    	, SUM(CASE  WHEN A.OPER_READ_RANGE_CD = '03' THEN 1 ELSE 0 END) CUR_UNUSE				    	, 0  PLAN_ALL				    	, 0  PLAN_LIST				    	, 0  PLAN_UNUSE 		            FROM TB_RDRECORD A, TB_RDFOLDER B  				    WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID 					AND A.FOLDER_ID = B.FOLDER_ID 					AND A.RECORD_CENTER_ID = '1'					AND B.FOLDER_KEEP_STATE_CD IN('01', '04')				    AND A.LAST_READ_RESORT_YYYY IS NOT NULL				    GROUP BY A.LAST_READ_RESORT_YYYY				    UNION ALL				    SELECT O.BEF_RESORT_YYYY				    	, 0  CUR_ALL				    	, 0  CUR_LIST				    	, 0  CUR_UNUSE				    	, SUM(CASE  WHEN R.OPER_READ_RANGE_CD = '01' THEN 1 ELSE 0 END) PLAN_ALL				    	, SUM(CASE  WHEN R.OPER_READ_RANGE_CD = '02' THEN 1 ELSE 0 END) PLAN_LIST				    	, SUM(CASE  WHEN R.OPER_READ_RANGE_CD = '03' THEN 1 ELSE 0 END) PLAN_UNUSE		            FROM TB_RDRANGERESORTOPIN O, TB_RDRECORD R		            WHERE O.RECORD_CENTER_ID = '1'		            AND O.RECORD_CENTER_ID = R.RECORD_CENTER_ID		            AND	O.RECORD_ID = R.RECORD_ID		            AND	O.CASE_TYPE = '01'				     AND 				        O.RESORT_YYYY = '1'				     				    GROUP BY  O.BEF_RESORT_YYYY				) D				WHERE D.LAST_READ_RESORT_YYYY IS NOT NULL				GROUP BY D.LAST_READ_RESORT_YYYY			)		 ;


-- File Close : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\rangeresortopin\RangeResortOpinTrgtState.xml
