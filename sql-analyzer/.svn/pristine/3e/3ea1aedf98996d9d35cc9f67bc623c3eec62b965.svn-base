-- File Open : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\openresortopin\OpenResortOpinCurState.xml


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\openresortopin\OpenResortOpinCurState.xml
-- Query    : select
-- Query Id : findOpenResortRsltStatList

		SELECT resort_yyyy			, open_total		    , open_choice_total		    , ot_open_rslt_cnt		    , ot_part_open_rslt_cnt		    , ot_close_rslt_cnt		    , (ot_open_rslt_cnt+ot_part_open_rslt_cnt+ot_close_rslt_cnt) as ot_open_total		    , part_open_total		    , part_open_choice_total		    , pt_open_rslt_cnt		    , pt_part_open_rslt_cnt		    , pt_close_rslt_cnt		    , pt_close_rslt_cnt		    , (pt_open_rslt_cnt+pt_part_open_rslt_cnt+pt_close_rslt_cnt) as pt_open_total		    , close_total		    , close_choice_total		    , ct_open_rslt_cnt		    , ct_part_open_rslt_cnt		    , ct_close_rslt_cnt		    , ct_close_rslt_cnt		    , (ct_open_rslt_cnt+ct_part_open_rslt_cnt+ct_close_rslt_cnt) as ct_open_total		FROM (			SELECT a.resort_yyyy				, (SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '1' ) as open_total				, (SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '1' AND resort_prog_state_cd IN ('2','3','4','5','6','7') ) as open_choice_total				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '1' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '1' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '1' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '1' AND discu_trgt_flag = '1' )) as ot_open_rslt_cnt				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '1' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '2' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '1' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '2' AND discu_trgt_flag = '1' )) as ot_part_open_rslt_cnt				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '1' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '3' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '1' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '3' AND discu_trgt_flag = '1' )) as ot_close_rslt_cnt				, (SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '2' ) as part_open_total				, (SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '2' AND resort_prog_state_cd IN ('2','3','4','5','6','7') ) as part_open_choice_total				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '2' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '1' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '2' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '1' AND discu_trgt_flag = '1' )) as pt_open_rslt_cnt				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '2' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '2' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '2' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '2' AND discu_trgt_flag = '1' )) as pt_part_open_rslt_cnt				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '2' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '3' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '2' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '3' AND discu_trgt_flag = '1' )) as pt_close_rslt_cnt				, (SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '3' ) as close_total				, (SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '3' AND resort_prog_state_cd IN ('2','3','4','5','6','7') ) as close_choice_total				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '3' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '1' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '3' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '1' AND discu_trgt_flag = '1' )) as ct_open_rslt_cnt				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '3' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '2' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '3' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '2' AND discu_trgt_flag = '1' )) as ct_part_open_rslt_cnt				, ((SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '3' AND resort_prog_state_cd = '7' AND expert_org_open_div_cd = '3' AND discu_trgt_flag = '0' )+(SELECT COUNT(*) FROM tb_rdopenresortopin WHERE record_center_id = a.record_center_id AND resort_yyyy = a.resort_yyyy AND current_open_div_cd = '3' AND resort_prog_state_cd = '7' AND review_org_open_div_cd = '3' AND discu_trgt_flag = '1' )) as ct_close_rslt_cnt			FROM (				SELECT resort_yyyy					, '1' as record_center_id			    FROM tb_rdopenresortopin			    WHERE record_center_id = '1'			    AND resort_yyyy BETWEEN '1' AND '1'			    			    GROUP BY resort_yyyy			) a		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\openresortopin\OpenResortOpinCurState.xml
-- Query    : select
-- Query Id : findOpenResortRsltCaseStatList

		SELECT a.cur_keep_org_cd		    , (SELECT dept_abbr_nm FROM tb_stdept WHERE record_center_id = a.record_center_id AND org_cd = a.cur_keep_org_cd) dept_abbr_nm		    , (SELECT close_flag FROM tb_stdept WHERE record_center_id = a.record_center_id AND org_cd = a.cur_keep_org_cd) close_flag		    , SUM(CASE WHEN a.current_open_div_cd = '1'  THEN 1 ELSE 0 END) as open_total		    , SUM(CASE WHEN a.current_open_div_cd = '1' AND a.resort_prog_state_cd IN ('2','3','4','5','6','7')  THEN 1 ELSE 0 END) as open_choice_total		    , (SUM(CASE WHEN a.current_open_div_cd = '1' AND a.resort_prog_state_cd = '7' AND a.expert_org_open_div_cd = '1' AND a.discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '1' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '1' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as ot_open_rslt_cnt		    , (SUM(CASE WHEN a.current_open_div_cd = '1' AND a.resort_prog_state_cd = '7' AND a.expert_org_open_div_cd = '2' AND a.discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '1' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '2' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as ot_part_open_rslt_cnt		    , (SUM(CASE WHEN a.current_open_div_cd = '1' AND a.resort_prog_state_cd = '7' AND a.expert_org_open_div_cd = '3' AND a.discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '1' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '3' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as ot_close_rslt_cnt		    , SUM(CASE WHEN a.current_open_div_cd = '2'  THEN 1 ELSE 0 END) as part_open_total		    , SUM(CASE WHEN a.current_open_div_cd = '2' AND a.resort_prog_state_cd IN ('2','3','4','5','6','7')  THEN 1 ELSE 0 END) as part_open_choice_total		    , (SUM(CASE WHEN a.current_open_div_cd = '2' AND a.resort_prog_state_cd = '7' AND a.expert_org_open_div_cd = '1' AND a.discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '2' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '1' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as pt_open_rslt_cnt		    , (SUM(CASE WHEN a.current_open_div_cd = '2' AND a.resort_prog_state_cd = '7' AND a.expert_org_open_div_cd = '2' AND a.discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '2' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '2' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as pt_part_open_rslt_cnt		    , (SUM(CASE WHEN a.current_open_div_cd = '2' AND a.resort_prog_state_cd = '7' AND a.expert_org_open_div_cd = '3' AND a.discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '2' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '3' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as pt_close_rslt_cnt		    , SUM(CASE WHEN a.current_open_div_cd = '3'  THEN 1 ELSE 0 END) as close_total		    , SUM(CASE WHEN a.current_open_div_cd = '3' AND a.resort_prog_state_cd IN ('2','3','4','5','6','7')  THEN 1 ELSE 0 END) as close_choice_total		    , (SUM(CASE WHEN a.current_open_div_cd = '3' AND a.resort_prog_state_cd = '7' AND expert_org_open_div_cd = '1' AND discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '3' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '1' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as ct_open_rslt_cnt		    , (SUM(CASE WHEN a.current_open_div_cd = '3' AND a.resort_prog_state_cd = '7' AND expert_org_open_div_cd = '2' AND discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '3' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '2' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as ct_part_open_rslt_cnt		    , (SUM(CASE WHEN a.current_open_div_cd = '3' AND a.resort_prog_state_cd = '7' AND expert_org_open_div_cd = '3' AND discu_trgt_flag = '0'  THEN 1 ELSE 0 END) + SUM(CASE WHEN a.current_open_div_cd = '3' AND a.resort_prog_state_cd = '7' AND a.review_org_open_div_cd = '3' AND a.discu_trgt_flag = '1'  THEN 1 ELSE 0 END)) as ct_close_rslt_cnt		FROM (		    SELECT f.cur_keep_org_cd		    	, d.current_open_div_cd		    	, d.resort_prog_state_cd		    	, d.expert_org_open_div_cd		    	, d.discu_trgt_flag		    	, d.review_org_open_div_cd		    	, '1' as resort_yyyy		    	, '1' as record_center_id		    	, resort_case		    FROM tb_rdopenresortopin d, tb_rdfolder f		    WHERE d.record_center_id = f.record_center_id		    AND d.folder_id = f.folder_id		    AND d.record_center_id = '1'		    AND d.resort_yyyy = '1'		) a		GROUP BY a.record_center_id, a.cur_keep_org_cd		ORDER BY close_flag, a.cur_keep_org_cd ASC	;


-- File Close : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\openresortopin\OpenResortOpinCurState.xml
