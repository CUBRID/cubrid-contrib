<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="eval.disuseeval">


	<!-- 평가폐기 폐기현황 -->
	<resultMap id="disuseCurState-result" class="rms.eval.disuseeval.domain.DisuseCurState" >
		<result property="discuYyyy" 		column="discu_yyyy"/>
		<result property="curPresvTermCd" 	column="cur_presv_Term_cd"/>
		<result property="curPresvTermNm" 	column="cur_presv_Term_nm"/>
		<result property="totCnt" 			column="TOT_CNT"/>
		<result property="opinCnt1" 		column="opin_cnt1"/>
		<result property="opinCnt2" 		column="opin_cnt2"/>
		<result property="opinCnt3" 		column="opin_cnt3"/>
		<result property="opinCnt4" 		column="opin_cnt4"/>
		<result property="opinCnt1Req" 		column="opin_cnt1_req"/>
		<result property="opinCnt2Req" 		column="opin_cnt2_req"/>
	</resultMap>
	<!-- 평가폐기 폐기현황 -->
	<select id="findDisuseCurStateList" parameterClass="rms.eval.disuseeval.domain.DisuseCurState" resultMap="disuseCurState-result">
		SELECT ZZ.DISCU_YYYY      
			, ZZ.COM_CD    AS CUR_PRESV_TERM_CD      
			, ZZ.COM_CD_NM AS CUR_PRESV_TERM_NM      
			, NVL(A.TOT_CNT1,0) AS TOT_CNT      
			, NVL(A.OPIN1_CNT1,0) AS OPIN_CNT1
			, NVL(A.OPIN1_CNT1_REQ,0) AS OPIN_CNT1_REQ
			, NVL(A.OPIN2_CNT1,0) AS OPIN_CNT2
			, NVL(A.OPIN2_CNT1_REQ,0) AS OPIN_CNT2_REQ
			, NVL(A.OPIN3_CNT1,0) AS OPIN_CNT3      
			, NVL(A.OPIN4_CNT1,0) AS OPIN_CNT4
		FROM (
			SELECT YY.DISCU_YYYY
				, ZZ.COM_CD
				, ZZ.COM_CD_NM           
			FROM TB_ZZCOMCD ZZ, (
				SELECT (#discuYyyyFrom:VARCHAR#+LEVEL-1) AS DISCU_YYYY FROM DUAL CONNECT BY LEVEL <![CDATA[<=]]> (#discuYyyyTo:VARCHAR# - #discuYyyyFrom:VARCHAR#)+1
			) YY
			<dynamic>
				<isNotEmpty prepend="WHERE">
					<isEqual property="disusePresv30yearDiv" compareValue="1">
					ZZ.COM_TYPE_CD = 'RD07' AND ZZ.COM_CD IN ('01','03','05','10','25')
					</isEqual>
				 	<isNotEqual property="disusePresv30yearDiv" compareValue="1">
					ZZ.COM_TYPE_CD = 'RD07' AND ZZ.COM_CD IN ('01','03','05','10')
					</isNotEqual>
				</isNotEmpty>
			</dynamic>
		) ZZ       
		LEFT OUTER JOIN(
			SELECT A.DISCU_YYYY
				, A.CUR_PRESV_TERM_CD             
				, COUNT(*) AS TOT_CNT1             
				, SUM(CASE WHEN A.DISCU_PROG_STATE_CD = '09' AND ( (A.DISCU_REQ_FLAG='0' AND A.REVIEW_DIV_CD = '1') OR (A.DISCU_REQ_FLAG='1' AND A.NAT_CMT_DIV_CD = '1') ) THEN 1 ELSE 0 END) AS OPIN1_CNT1
				, SUM(CASE WHEN A.DISCU_PROG_STATE_CD = '09' AND ( (A.DISCU_REQ_FLAG='0' AND A.REVIEW_DIV_CD = '1') OR (A.DISCU_REQ_FLAG='1' AND A.NAT_CMT_DIV_CD = '1') ) AND A.DISCU_REQ_FLAG = '1' THEN 1 ELSE 0 END) AS OPIN1_CNT1_REQ	
				, SUM(CASE WHEN A.DISCU_PROG_STATE_CD = '09' AND ( (A.DISCU_REQ_FLAG='0' AND A.REVIEW_DIV_CD = '2') OR (A.DISCU_REQ_FLAG='1' AND A.NAT_CMT_DIV_CD = '2') ) THEN 1 ELSE 0 END) AS OPIN2_CNT1
				, SUM(CASE WHEN A.DISCU_PROG_STATE_CD = '09' AND ( (A.DISCU_REQ_FLAG='0' AND A.REVIEW_DIV_CD = '2') OR (A.DISCU_REQ_FLAG='1' AND A.NAT_CMT_DIV_CD = '2') ) AND A.DISCU_REQ_FLAG = '1' THEN 1 ELSE 0 END) AS OPIN2_CNT1_REQ             
				, SUM(CASE WHEN A.DISCU_PROG_STATE_CD = '09' AND ( (A.DISCU_REQ_FLAG='0' AND A.REVIEW_DIV_CD = '3') OR (A.DISCU_REQ_FLAG='1' AND A.NAT_CMT_DIV_CD = '3') ) THEN 1 ELSE 0 END) AS OPIN3_CNT1
				, SUM(CASE WHEN A.DISCU_PROG_STATE_CD <![CDATA[<>]]> '09' THEN 1 ELSE 0 END) AS OPIN4_CNT1
			FROM TB_DFDISUSEOPIN A         
			WHERE A.RECORD_CENTER_ID = #recordCenterId:VARCHAR#           
			AND A.DISCU_YYYY BETWEEN #discuYyyyFrom:VARCHAR# AND #discuYyyyTo:VARCHAR#
			AND A.DISCU_PROG_STATE_CD <![CDATA[<>]]> '01'
			GROUP BY A.DISCU_YYYY, A.CUR_PRESV_TERM_CD      
		) A       
		ON A.DISCU_YYYY = ZZ.DISCU_YYYY AND A.CUR_PRESV_TERM_CD = ZZ.COM_CD  
		ORDER BY ZZ.DISCU_YYYY DESC, ZZ.COM_CD 	
	</select>
	
	
	<!-- 평가폐기 폐기현황 상세 -->
	<resultMap id="disuseCurStateDetail-result" class="rms.eval.disuseeval.domain.DisuseCurState" >
		<result property="discuYyyy" 		column="discu_yyyy"/>
		<result property="creatYyyy" 		column="creat_yyyy"/>
		<result property="folderId" 		column="FOLDER_ID"/>
		<result property="title" 			column="TITLE"/>
		<result property="orgNm" 			column="ORG_NM"/>
		<result property="curPresvTermCd" 	column="cur_presv_Term_cd"/>
		<result property="curPresvTermNm" 	column="cur_presv_Term_nm"/>
		<result property="handlRslt" 		column="HANDL_RSLT"/>
		<result property="expertRslt" 		column="EXPERT_RSLT"/>
		<result property="reviewRslt" 		column="REVIEW_RSLT"/>
		<result property="natCmtRslt" 		column="NAT_CMT_RSLT"/>
		<result property="discuReqFlag" 	column="DISCU_REQ_FLAG"/>
		<result property="discuReqFlagNm" 	column="DISCU_REQ_FLAG_NM"/>
		<result property="finalRslt" 		column="FINAL_RSLT"/>
	</resultMap>
	<!-- 
		SELECT - 평가폐기 폐기현황 상세
	 -->
	<select id="findDisuseCurStateDetailPagedList" parameterClass="rms.eval.disuseeval.domain.DisuseCurState" resultMap="disuseCurStateDetail-result">
		SELECT D.*
		FROM (
			SELECT ROWNUM AS rnum
				, C.*
			FROM (
				SELECT LST.DISCU_YYYY
				    , LST.CREAT_YYYY
				    , LST.FOLDER_ID
				    , LST.TITLE
				    , LST.ORG_NM
				    , LST.CUR_PRESV_TERM_CD
				    , LST.CUR_PRESV_TERM_NM
				    , LST.HANDL_ORG_DISU_DIV_NM ||
				      CASE WHEN LST.HANDL_ORG_DISU_DIV_CD = '2' THEN '(' || LST.HANDL_ORG_DEFER_NM || ')'
				           WHEN LST.HANDL_ORG_DISU_DIV_CD = '3' THEN '(' || LST.HANDL_ORG_TERM_NM || ')'
				      END AS HANDL_RSLT
				    , LST.EXPERT_DISU_DIV_NM ||
				      CASE WHEN LST.EXPERT_DISU_DIV_CD = '2' THEN '(' || LST.EXPERT_DISU_DEFER_NM || ')'
				           WHEN LST.EXPERT_DISU_DIV_CD = '3' THEN '(' || LST.EXPERT_DISU_TERM_NM || ')'
				      END AS EXPERT_RSLT
				    , LST.REVIEW_DIV_NM ||
				      CASE WHEN LST.REVIEW_DIV_CD = '2' THEN '(' || LST.REVIEW_DEFER_NM || ')'
				           WHEN LST.REVIEW_DIV_CD = '3' THEN '(' || LST.REVIEW_TERM_NM || ')'
				      END AS REVIEW_RSLT
				    , LST.NAT_CMT_DIV_NM ||
				      CASE WHEN LST.NAT_CMT_DIV_CD = '2' THEN '(' || LST.NAT_CMT_DEFER_NM || ')'
				           WHEN LST.NAT_CMT_DIV_CD = '3' THEN '(' || LST.NAT_CMT_TERM_NM || ')'
				      END AS NAT_CMT_RSLT
				    , LST.DISCU_REQ_FLAG
				    , LST.DISCU_REQ_FLAG_NM
				    , CASE WHEN LST.DISCU_REQ_FLAG = '1' THEN
					       LST.NAT_CMT_DIV_NM ||
					       CASE WHEN LST.NAT_CMT_DIV_CD = '2' THEN '(' || LST.NAT_CMT_DEFER_NM || ')'
					            WHEN LST.NAT_CMT_DIV_CD = '3' THEN '(' || LST.NAT_CMT_TERM_NM || ')'
					       END
				      ELSE
					       LST.REVIEW_DIV_NM ||
					       CASE WHEN LST.REVIEW_DIV_CD = '2' THEN '(' || LST.REVIEW_DEFER_NM || ')'
					            WHEN LST.REVIEW_DIV_CD = '3' THEN '(' || LST.REVIEW_TERM_NM || ')'
					       END       
				      END AS FINAL_RSLT
				FROM (
					SELECT U.DISCU_YYYY
						, U.creat_yyyy
						, U.FOLDER_ID
						, U.TITLE
						, U.ORG_NM
						, U.CUR_PRESV_TERM_CD
						, U.HANDL_ORG_DISU_DIV_CD
						, U.EXPERT_DISU_DIV_CD
						, U.REVIEW_DIV_CD
						, U.NAT_CMT_DIV_CD
						, U.DISCU_REQ_FLAG
						, U.CUR_PRESV_TERM_NM
						, U.HANDL_ORG_DISU_DIV_NM     
						, U.HANDL_ORG_DEFER_NM
						, U.HANDL_ORG_TERM_NM
						, U.EXPERT_DISU_DIV_NM
						, U.EXPERT_DISU_DEFER_NM
						, U.EXPERT_DISU_TERM_NM
						, U.REVIEW_DIV_NM
						, U.REVIEW_DEFER_NM
						, U.REVIEW_TERM_NM
						, U.NAT_CMT_DIV_NM
						, U.NAT_CMT_DEFER_NM
						, U.NAT_CMT_TERM_NM
						, U.DISCU_REQ_FLAG_NM     
				    FROM (
				    	(SELECT A.DISCU_YYYY
						    , B.creat_yyyy
						    , B.FOLDER_ID
						    , B.TITLE
						    , ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD ) AS ORG_NM
						    , A.CUR_PRESV_TERM_CD
						    , A.HANDL_ORG_DISU_DIV_CD
						    , A.EXPERT_DISU_DIV_CD
						    , A.REVIEW_DIV_CD
						    , A.NAT_CMT_DIV_CD
						    , A.DISCU_REQ_FLAG
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM     
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.EXPERT_DISU_DIV_CD) AS EXPERT_DISU_DIV_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.REVIEW_DIV_CD) AS REVIEW_DIV_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.REVIEW_DEFER_CD) AS REVIEW_DEFER_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.REVIEW_REFIX_AFT_PRESV_TERM) AS REVIEW_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.NAT_CMT_DIV_CD) AS NAT_CMT_DIV_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.NAT_CMT_DEFER_CD) AS NAT_CMT_DEFER_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.NAT_CMT_REFIX_AFT_PRESV_TERM) AS NAT_CMT_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM
						FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B
						WHERE A.folder_id = B.folder_id
						AND A.RECORD_CENTER_ID = B.RECORD_CENTER_ID
						AND A.DISCU_PROG_STATE_CD != '01'
						AND A.RECORD_CENTER_ID = #recordCenterId:VARCHAR#
						AND A.DISCU_YYYY = #discuYyyy:VARCHAR#
						) UNION ALL (
						SELECT A.DISCU_YYYY
						    , B.creat_yyyy
						    , B.FOLDER_ID
						    , B.TITLE
						    , ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD ) AS ORG_NM
						    , A.CUR_PRESV_TERM_CD
						    , A.HANDL_ORG_DISU_DIV_CD
						    , A.EXPERT_DISU_DIV_CD
						    , A.REVIEW_DIV_CD
						    , A.NAT_CMT_DIV_CD
						    , A.DISCU_REQ_FLAG
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM     
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.EXPERT_DISU_DIV_CD) AS EXPERT_DISU_DIV_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.REVIEW_DIV_CD) AS REVIEW_DIV_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.REVIEW_DEFER_CD) AS REVIEW_DEFER_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.REVIEW_REFIX_AFT_PRESV_TERM) AS REVIEW_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.NAT_CMT_DIV_CD) AS NAT_CMT_DIV_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.NAT_CMT_DEFER_CD) AS NAT_CMT_DEFER_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.NAT_CMT_REFIX_AFT_PRESV_TERM) AS NAT_CMT_TERM_NM
						    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM
						FROM TB_DFDISUSEOPIN A, TB_NKFOLDER B
						WHERE A.folder_id = B.folder_id
						AND A.RECORD_CENTER_ID = B.RECORD_CENTER_ID
						AND A.DISCU_PROG_STATE_CD != '01'
						AND A.RECORD_CENTER_ID = #recordCenterId:VARCHAR#
						AND A.DISCU_YYYY = #discuYyyy:VARCHAR#)
						) U
				    ) LST
				ORDER BY LST.CREAT_YYYY, LST.TITLE
			) C
			WHERE ROWNUM <![CDATA[<=]]> #pagedEnd:NUMBER#
		) D
		WHERE D.rnum <![CDATA[>=]]> #pagedStart:NUMBER#
	</select>
	<!-- 
		COUNT - 폐기현황 상세
	 -->
	<select id="countDisuseCurStateDetailPagedList" parameterClass="rms.eval.disuseeval.domain.DisuseCurState" resultClass="java.lang.Long" >
		SELECT COUNT(*)
		FROM (
			SELECT A.DISCU_YYYY
				, B.creat_yyyy
				, B.TITLE
				, ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD ) AS ORG_NM
				, A.CUR_PRESV_TERM_CD
				, A.HANDL_ORG_DISU_DIV_CD
				, A.EXPERT_DISU_DIV_CD
				, A.REVIEW_DIV_CD
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM     
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.EXPERT_DISU_DIV_CD) AS EXPERT_DISU_DIV_NM
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.REVIEW_DIV_CD) AS REVIEW_DIV_NM
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.REVIEW_DEFER_CD) AS REVIEW_DEFER_NM
				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.REVIEW_REFIX_AFT_PRESV_TERM) AS REVIEW_TERM_NM
			FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B
			WHERE A.folder_id = B.folder_id
			AND A.RECORD_CENTER_ID = B.RECORD_CENTER_ID
			AND A.DISCU_PROG_STATE_CD != '01'
			AND A.RECORD_CENTER_ID = #recordCenterId:VARCHAR#
			AND A.DISCU_YYYY = #discuYyyy:VARCHAR#
		) LST
	</select>
	<!-- 
		SELECT - 평가폐기 폐기현황 상세
	 -->
	<select id="findDisuseCurStateDetailList" parameterClass="rms.eval.disuseeval.domain.DisuseCurState" resultMap="disuseCurStateDetail-result">
		SELECT LST.DISCU_YYYY
		    , LST.CREAT_YYYY
		    , LST.FOLDER_ID
		    , LST.TITLE
		    , LST.ORG_NM
		    , LST.CUR_PRESV_TERM_CD
		    , LST.CUR_PRESV_TERM_NM
		    , LST.HANDL_ORG_DISU_DIV_NM ||
		      CASE WHEN LST.HANDL_ORG_DISU_DIV_CD = '2' THEN '(' || LST.HANDL_ORG_DEFER_NM || ')'
		           WHEN LST.HANDL_ORG_DISU_DIV_CD = '3' THEN '(' || LST.HANDL_ORG_TERM_NM || ')'
		      END AS HANDL_RSLT
		    , LST.EXPERT_DISU_DIV_NM ||
		      CASE WHEN LST.EXPERT_DISU_DIV_CD = '2' THEN '(' || LST.EXPERT_DISU_DEFER_NM || ')'
		           WHEN LST.EXPERT_DISU_DIV_CD = '3' THEN '(' || LST.EXPERT_DISU_TERM_NM || ')'
		      END AS EXPERT_RSLT
		    , LST.REVIEW_DIV_NM ||
		      CASE WHEN LST.REVIEW_DIV_CD = '2' THEN '(' || LST.REVIEW_DEFER_NM || ')'
		           WHEN LST.REVIEW_DIV_CD = '3' THEN '(' || LST.REVIEW_TERM_NM || ')'
		      END AS REVIEW_RSLT
		    , LST.NAT_CMT_DIV_NM ||
		      CASE WHEN LST.NAT_CMT_DIV_CD = '2' THEN '(' || LST.NAT_CMT_DEFER_NM || ')'
		           WHEN LST.NAT_CMT_DIV_CD = '3' THEN '(' || LST.NAT_CMT_TERM_NM || ')'
		      END AS NAT_CMT_RSLT
		    , LST.DISCU_REQ_FLAG
		    , LST.DISCU_REQ_FLAG_NM
		    , CASE WHEN LST.DISCU_REQ_FLAG = '1' THEN
			       LST.NAT_CMT_DIV_NM ||
			       CASE WHEN LST.NAT_CMT_DIV_CD = '2' THEN '(' || LST.NAT_CMT_DEFER_NM || ')'
			            WHEN LST.NAT_CMT_DIV_CD = '3' THEN '(' || LST.NAT_CMT_TERM_NM || ')'
			       END
		      ELSE
			       LST.REVIEW_DIV_NM ||
			       CASE WHEN LST.REVIEW_DIV_CD = '2' THEN '(' || LST.REVIEW_DEFER_NM || ')'
			            WHEN LST.REVIEW_DIV_CD = '3' THEN '(' || LST.REVIEW_TERM_NM || ')'
			       END       
		      END AS FINAL_RSLT
		FROM (
			SELECT U.DISCU_YYYY
				, U.creat_yyyy
				, U.FOLDER_ID
				, U.TITLE
				, U.ORG_NM
				, U.CUR_PRESV_TERM_CD
				, U.HANDL_ORG_DISU_DIV_CD
				, U.EXPERT_DISU_DIV_CD
				, U.REVIEW_DIV_CD
				, U.NAT_CMT_DIV_CD
				, U.DISCU_REQ_FLAG
				, U.CUR_PRESV_TERM_NM
				, U.HANDL_ORG_DISU_DIV_NM     
				, U.HANDL_ORG_DEFER_NM
				, U.HANDL_ORG_TERM_NM
				, U.EXPERT_DISU_DIV_NM
				, U.EXPERT_DISU_DEFER_NM
				, U.EXPERT_DISU_TERM_NM
				, U.REVIEW_DIV_NM
				, U.REVIEW_DEFER_NM
				, U.REVIEW_TERM_NM
				, U.NAT_CMT_DIV_NM
				, U.NAT_CMT_DEFER_NM
				, U.NAT_CMT_TERM_NM
				, U.DISCU_REQ_FLAG_NM     
		    FROM (
		    	(SELECT A.DISCU_YYYY
				    , B.creat_yyyy
				    , B.FOLDER_ID
				    , B.TITLE
				    , ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD ) AS ORG_NM
				    , A.CUR_PRESV_TERM_CD
				    , A.HANDL_ORG_DISU_DIV_CD
				    , A.EXPERT_DISU_DIV_CD
				    , A.REVIEW_DIV_CD
				    , A.NAT_CMT_DIV_CD
				    , A.DISCU_REQ_FLAG
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM     
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.EXPERT_DISU_DIV_CD) AS EXPERT_DISU_DIV_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.REVIEW_DIV_CD) AS REVIEW_DIV_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.REVIEW_DEFER_CD) AS REVIEW_DEFER_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.REVIEW_REFIX_AFT_PRESV_TERM) AS REVIEW_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.NAT_CMT_DIV_CD) AS NAT_CMT_DIV_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.NAT_CMT_DEFER_CD) AS NAT_CMT_DEFER_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.NAT_CMT_REFIX_AFT_PRESV_TERM) AS NAT_CMT_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM
				FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B
				WHERE A.folder_id = B.folder_id
				AND A.RECORD_CENTER_ID = B.RECORD_CENTER_ID
				AND A.DISCU_PROG_STATE_CD != '01'
				AND A.RECORD_CENTER_ID = #recordCenterId:VARCHAR#
				AND A.DISCU_YYYY = #discuYyyy:VARCHAR#
				) UNION ALL (
				SELECT A.DISCU_YYYY
				    , B.creat_yyyy
				    , B.FOLDER_ID
				    , B.TITLE
				    , ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD ) AS ORG_NM
				    , A.CUR_PRESV_TERM_CD
				    , A.HANDL_ORG_DISU_DIV_CD
				    , A.EXPERT_DISU_DIV_CD
				    , A.REVIEW_DIV_CD
				    , A.NAT_CMT_DIV_CD
				    , A.DISCU_REQ_FLAG
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM     
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.EXPERT_DISU_DIV_CD) AS EXPERT_DISU_DIV_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.REVIEW_DIV_CD) AS REVIEW_DIV_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.REVIEW_DEFER_CD) AS REVIEW_DEFER_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.REVIEW_REFIX_AFT_PRESV_TERM) AS REVIEW_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.NAT_CMT_DIV_CD) AS NAT_CMT_DIV_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.NAT_CMT_DEFER_CD) AS NAT_CMT_DEFER_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.NAT_CMT_REFIX_AFT_PRESV_TERM) AS NAT_CMT_TERM_NM
				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM
				FROM TB_DFDISUSEOPIN A, TB_NKFOLDER B
				WHERE A.folder_id = B.folder_id
				AND A.RECORD_CENTER_ID = B.RECORD_CENTER_ID
				AND A.DISCU_PROG_STATE_CD != '01'
				AND A.RECORD_CENTER_ID = #recordCenterId:VARCHAR#
				AND A.DISCU_YYYY = #discuYyyy:VARCHAR#)
				) U
		    ) LST
	</select>
</sqlMap>