-- File Open : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfJobGroupId

		SELECT TO_CHAR(SYSDATE,'YYYY')||LPAD(TB_STFORMAT_GROUP_SQ01.NEXTVAL,13,'0') FROM DUAL	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfMediumInfo

		SELECT medium_cd			, medium_detail_cd		FROM (		    SELECT medium_cd, medium_detail_cd		    FROM  TB_STMEDIUM		    WHERE record_center_id = '1'		    AND   volm_id IN (SELECT volm_id FROM TB_STVOLM WHERE del_flag='0' AND volm_div_cd='2')		    AND   del_flag = '0'		    AND   (tot_size - use_size) > 0		    ORDER BY record_center_id, medium_id		)		WHERE ROWNUM = 1;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfOrgPagedList

		SELECT COUNT(1)		FROM (			SELECT DISTINCT A.record_center_id, A.org_cd			FROM TB_RDFOLDER A			WHERE A.record_center_id = '1'			 AND 				A.org_cd = '1'			  AND  					(A.creat_yyyy BETWEEN '1' AND '1')				  			AND   A.folder_keep_state_cd IN ('01','04')		);


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfOrgPagedList

		SELECT E.record_center_id			, E.org_cd			, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=E.record_center_id AND Z.org_cd=E.org_cd) org_nm			, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=E.record_center_id AND Z.org_cd=E.org_cd) org_abbr_nm		    , SUM(E.folder_tot_cnt) folder_tot_cnt		    , SUM(E.folder_def_cnt) folder_def_cnt		    , SUM(E.folder_ing_cnt) folder_ing_cnt		    , SUM(E.folder_fail_cnt) folder_fail_cnt		    , SUM(E.folder_end_cnt) folder_end_cnt		    , SUM(E.record_tot_cnt) record_tot_cnt		    , SUM(E.record_def_cnt) record_def_cnt		    , SUM(E.record_ing_cnt) record_ing_cnt		    , SUM(E.record_fail_cnt) record_fail_cnt		    , SUM(E.record_end_cnt) record_end_cnt		FROM (			SELECT D.record_center_id				, D.org_cd				, 1 folder_tot_cnt				, (CASE WHEN (D.pdf_a1_trans_state IS NULL OR D.pdf_a1_trans_state='0') THEN 1 ELSE 0 END) folder_def_cnt				, (CASE WHEN D.pdf_a1_trans_state IN ('1','2','3') THEN 1 ELSE 0 END) folder_ing_cnt				, (CASE WHEN D.pdf_a1_trans_state='5' THEN 1 ELSE 0 END) folder_fail_cnt				, (CASE WHEN D.pdf_a1_trans_state IN ('4','6') THEN 1 ELSE 0 END) folder_end_cnt				, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id) record_tot_cnt				, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND (R.pdf_a1_trans_state IS NULL OR R.pdf_a1_trans_state='0')) record_def_cnt				, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('1','2','3')) record_ing_cnt				, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state='5') record_fail_cnt				, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('4','6')) record_end_cnt			FROM TB_RDFOLDER D			where			EXISTS (				SELECT 1				FROM (					SELECT ROWNUM AS rnum, B.*					FROM (						SELECT DISTINCT A.record_center_id, A.org_cd						FROM TB_RDFOLDER A						WHERE A.record_center_id = '1'						 AND 							A.org_cd = '1'						  AND  								(A.creat_yyyy BETWEEN '1' AND '1')							  						AND   A.folder_keep_state_cd IN ('01','04')		                ORDER BY A.record_center_id, A.org_cd		            ) B		            WHERE ROWNUM <= '1'			    AND B.record_center_id = D.record_center_id			    AND B.org_cd = D.org_cd		        ) C		        WHERE C.rnum >= '1'		    ) AND  					(D.creat_yyyy BETWEEN '1' AND '1')				  		    AND   D.folder_keep_state_cd IN ('01','04')		) E		GROUP BY E.record_center_id, E.org_cd	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfOrgFolderPagedList

		SELECT COUNT(1)		FROM (			SELECT A.record_center_id, A.folder_id			FROM TB_RDFOLDER A			WHERE A.record_center_id = '1'			AND   A.org_cd = '1' AND  					(A.creat_yyyy BETWEEN '1' AND '1')				  			AND   A.folder_keep_state_cd IN ('01','04')		);


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfOrgFolderPagedList

		SELECT D.record_center_id			, D.folder_id			, D.title folder_title			, D.pdf_a1_trans_state folder_state			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='ST02' AND Z.com_cd=D.pdf_a1_trans_state) folder_state_nm			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id) record_tot_cnt			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('0')) record_def_cnt			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('1','2','3')) record_ing_cnt			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('5')) record_fail_cnt			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('4','6')) record_end_cnt		FROM TB_RDFOLDER D				WHERE		EXISTS (			SELECT 1			FROM (				SELECT ROWNUM AS rnum, B.*				FROM (					SELECT A.record_center_id, A.folder_id					FROM TB_RDFOLDER A					WHERE A.record_center_id = '1'					AND   A.org_cd = '1' AND  							(A.creat_yyyy BETWEEN '1' AND '1')						  					AND   A.folder_keep_state_cd IN ('01','04')	                ORDER BY A.record_center_id, A.title	            ) B	            WHERE ROWNUM <= '1'	        ) C	        WHERE C.rnum >= '1'		AND C.record_center_id = D.record_center_id		AND C.folder_id = D.folder_id	    )	    ORDER BY D.record_center_id, D.title	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfOrgRecordPagedList

		SELECT COUNT(1)		FROM (			SELECT A.record_center_id, A.folder_id			FROM TB_RDRECORD A			WHERE A.record_center_id = '1'			AND   A.folder_id = '1'		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfOrgRecordPagedList

		SELECT D.record_center_id			, D.record_id			, D.title record_title			, D.pdf_a1_trans_state record_state			,CASE WHEN  d.pdf_a1_trans_state IN (1,2,3)	         THEN (SELECT z.com_cd_nm FROM tb_zzcomcd z WHERE z.com_type_cd = 'NE02' AND z.com_cd = ( SELECT REQUEST_STATUS FROM TB_STREQTRANS WHERE RECORD_ID = d.record_id AND  JOB_ID = (SELECT MAX(JOB_ID) FROM TB_STREQTRANS WHERE RECORD_ID = d.record_id AND NEO_GUBUN = '0')))	         ELSE (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='ST02' AND Z.com_cd=D.pdf_a1_trans_state)	         END    record_state_nm			, (SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1')) file_tot_cnt			, (SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('0')) file_def_cnt			, (SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('1','2','3')) file_ing_cnt			, (SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('5')) file_fail_cnt			, (SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('4')) file_end_cnt			, (SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('6')) file_not_cnt		FROM TB_RDRECORD D				WHERE 		EXISTS (			SELECT 1			FROM (				SELECT ROWNUM AS rnum, B.*				FROM (					SELECT A.record_center_id, A.record_id					FROM TB_RDRECORD A					WHERE A.record_center_id = '1'					AND   A.folder_id = '1'	                ORDER BY A.record_center_id, A.creat_reg_dtime, A.creat_reg_no	            ) B	            WHERE ROWNUM <= '1'	        ) C	        WHERE C.rnum >= '1'	        				    AND C.record_center_id = D.record_center_id		    AND C.record_id = D.record_id	    )	    ORDER BY D.record_center_id, D.creat_reg_dtime, D.creat_reg_no;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfFolderPagedList

		SELECT COUNT(1)		FROM (			SELECT A.record_center_id, A.folder_id			FROM TB_RDFOLDER A			WHERE A.record_center_id = '1'			 AND 				A.creat_sys_cd = '1'			  AND 				A.org_cd = '1'			  AND 			    A.clss_id = '1'			  AND  					(A.creat_yyyy BETWEEN '1' AND '1')				   AND 				A.folder_type_div_cd = '1'			  AND 				A.pdf_A1_trans_state = '1'			  AND 				A.title LIKE '1'			 			AND   A.folder_keep_state_cd IN ('01','04')		);


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfFolderPagedList

		SELECT D.record_center_id			, D.folder_id			, D.title folder_title			, D.pdf_a1_trans_state folder_state			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='ST02' AND Z.com_cd=D.pdf_a1_trans_state) folder_state_nm			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id) record_tot_cnt			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('0')) record_def_cnt			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('1','2','3')) record_ing_cnt			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('5')) record_fail_cnt			, (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=D.record_center_id AND R.folder_id=D.folder_id AND R.pdf_a1_trans_state IN ('4','6')) record_end_cnt		FROM TB_RDFOLDER D				WHERE		EXISTS (			SELECT 1			FROM (				SELECT ROWNUM AS rnum, B.*				FROM (					SELECT A.record_center_id, A.folder_id					FROM TB_RDFOLDER A					WHERE A.record_center_id = '1'					 AND 						A.creat_sys_cd = '1'					  AND 						A.org_cd = '1'					  AND 					    A.clss_id = '1'					  AND  							(A.creat_yyyy BETWEEN '1' AND '1')						   AND 						A.folder_type_div_cd = '1'					  AND 						A.pdf_A1_trans_state = '1'					  AND 						A.title LIKE '1'					 					AND   A.folder_keep_state_cd IN ('01','04')	                ORDER BY A.record_center_id, A.title, A.folder_id	            ) B	            WHERE ROWNUM <= '1'	        ) C	        WHERE C.rnum >= '1'		AND C.record_center_id = D.record_center_id		AND C.folder_id = D.folder_id	    )	    ORDER BY D.record_center_id, D.title	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfFolderRecordPagedList

		SELECT COUNT(1)		FROM (			SELECT A.record_center_id, A.folder_id			FROM TB_RDRECORD A			WHERE A.record_center_id = '1'			AND   A.folder_id = '1'		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfFolderRecordPagedList

	 	SELECT D.record_center_id			, D.record_id			, D.title record_title			, D.pdf_a1_trans_state record_state	        , (CASE WHEN D.pdf_a1_trans_state IN (1,2,3) THEN (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='NE02' AND Z.com_cd=(SELECT Y.request_status FROM TB_STREQTRANS Y WHERE Y.record_id=D.record_id AND Y.job_id=(SELECT MAX(X.job_id) FROM TB_STREQTRANS X WHERE X.record_id=D.record_id AND X.neo_gubun='0')))					ELSE (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='ST02' AND Z.com_cd=D.pdf_a1_trans_state)				END) AS record_state_nm			, decode(d.erecord_flag,'1',(SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1')), 0) file_tot_cnt			, decode(d.erecord_flag,'1',(SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('0')), 0) file_def_cnt			, decode(d.erecord_flag,'1',(SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('1','2','3')), 0) file_ing_cnt			, decode(d.erecord_flag,'1',(SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('5')), 0) file_fail_cnt			, decode(d.erecord_flag,'1',(SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('4')), 0) file_end_cnt			, decode(d.erecord_flag,'1',(SELECT COUNT(1) FROM TB_STORIGNFILE F WHERE F.record_center_id=D.record_center_id AND F.orign_id=D.orign_id AND F.doc_type_cd NOT IN ('10','S1') AND F.pdf_a1_trans_state IN ('6')), 0) file_not_cnt		FROM TB_RDRECORD D			, ( SELECT C.record_center_id, C.record_id				FROM (					SELECT ROWNUM AS rnum, B.*					FROM (						SELECT A.record_center_id, A.record_id						FROM TB_RDRECORD A						WHERE A.record_center_id = '1'						AND   A.folder_id = '1'		                ORDER BY A.record_center_id, A.creat_reg_dtime, A.creat_reg_no		            ) B		            WHERE ROWNUM <= '1'		        ) C		        WHERE C.rnum >= '1'		    ) E		WHERE D.record_center_id = E.record_center_id		AND   D.record_id = E.record_id	    ORDER BY D.record_center_id, D.creat_reg_dtime, D.creat_reg_no	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfCurStateList

		SELECT D.creat_yyyy			, D.presv_term_cd		    , (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD07' AND Z.com_cd=D.presv_term_cd) presv_term_nm 		    , NVL(C.folder_tot_cnt,0) AS folder_tot_cnt		    , NVL(C.folder_def_cnt,0) AS folder_def_cnt		    , NVL(C.folder_ing_cnt,0) AS folder_ing_cnt		    , NVL(C.folder_fail_cnt,0) AS folder_fail_cnt		    , NVL(C.folder_end_cnt,0) AS folder_end_cnt		    , NVL(C.record_tot_cnt,0) AS record_tot_cnt		    , NVL(C.record_def_cnt,0) AS record_def_cnt		    , NVL(C.record_ing_cnt,0) AS record_ing_cnt		    , NVL(C.record_fail_cnt,0) AS record_fail_cnt		    , NVL(C.record_end_cnt,0) AS record_end_cnt		FROM 		(   SELECT B.record_center_id, B.creat_yyyy, B.presv_term_cd		        , SUM(folder_tot_cnt) folder_tot_cnt		        , SUM(folder_def_cnt) folder_def_cnt		        , SUM(folder_ing_cnt) folder_ing_cnt		        , SUM(folder_fail_cnt) folder_fail_cnt		        , SUM(folder_end_cnt) folder_end_cnt		        , SUM(record_tot_cnt) record_tot_cnt		        , SUM(record_def_cnt) record_def_cnt		        , SUM(record_ing_cnt) record_ing_cnt		        , SUM(record_fail_cnt) record_fail_cnt		        , SUM(record_end_cnt) record_end_cnt		    FROM 		    (   SELECT A.record_center_id, A.folder_id, A.creat_yyyy, DECODE(A.presv_term_cd, '20', '25', A.presv_term_cd) presv_term_cd, A.pdf_a1_trans_state		            , 1 folder_tot_cnt		            , (CASE WHEN A.pdf_a1_trans_state IN ('0') THEN 1 ELSE 0 END) folder_def_cnt		            , (CASE WHEN A.pdf_a1_trans_state IN ('1','2','3') THEN 1 ELSE 0 END) folder_ing_cnt		            , (CASE WHEN A.pdf_a1_trans_state IN ('5') THEN 1 ELSE 0 END) folder_fail_cnt		            , (CASE WHEN A.pdf_a1_trans_state IN ('4','6') THEN 1 ELSE 0 END) folder_end_cnt		            , (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=A.record_center_id AND R.folder_id=A.folder_id) record_tot_cnt		            , (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=A.record_center_id AND R.folder_id=A.folder_id AND R.pdf_a1_trans_state IN ('0')) record_def_cnt		            , (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=A.record_center_id AND R.folder_id=A.folder_id AND R.pdf_a1_trans_state IN ('1','2','3')) record_ing_cnt		            , (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=A.record_center_id AND R.folder_id=A.folder_id AND R.pdf_a1_trans_state IN ('5')) record_fail_cnt		            , (SELECT COUNT(1) FROM TB_RDRECORD R WHERE R.record_center_id=A.record_center_id AND R.folder_id=A.folder_id AND R.pdf_a1_trans_state IN ('4','6')) record_end_cnt		        FROM  TB_RDFOLDER A		        WHERE A.record_center_id = '1' AND  						(A.creat_yyyy BETWEEN '1' AND '1')					   AND  						TO_DATE(SUBSTR(A.creat_dtime,1,8),'YYYYMMDD') BETWEEN  TO_DATE('1','YYYYMMDD')  AND  TO_DATE('1','YYYYMMDD') 					  				AND   A.folder_keep_state_cd IN ('01','04')		    ) B		    GROUP BY B.record_center_id, B.creat_yyyy, B.presv_term_cd		    ORDER BY B.record_center_id, B.creat_yyyy, B.presv_term_cd		) C, (		    SELECT Y.yyyy AS creat_yyyy, Z.com_cd AS presv_term_cd		    FROM (SELECT com_cd FROM TB_ZZCOMCD WHERE com_type_cd='RD07') Z,			 		     (SELECT yyyy FROM (SELECT LEVEL AS yyyy FROM DUAL CONNECT BY LEVEL <= '1') WHERE yyyy >= '1') Y             		) D		WHERE D.creat_yyyy = C.creat_yyyy(+)		AND   D.presv_term_cd = C.presv_term_cd(+)		ORDER BY D.creat_yyyy DESC, D.presv_term_cd DESC;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfFailedMsgPagedList

		SELECT COUNT(1)		FROM  TB_STWORKHIST B		WHERE           EXISTS (               SELECT 1               FROM TB_RDFOLDER A               WHERE A.record_center_id = '1'			 AND 				A.folder_id = '1'			  AND 				A.org_cd = '1'			 			AND   A.folder_keep_state_cd IN ('01','04')			AND   A.record_center_id = B.record_center_id			AND   A.folder_id = B.folder_id           ) AND 			B.record_id = '1'		 		AND (B.format_div_cd = '0' OR B.format_div_cd IS NULL) 		AND (B.followup_fin_flag IS NULL OR B.followup_fin_flag='0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfFailedMsgPagedList

		SELECT E.rnum			, E.record_center_id			, E.work_hist_id			, E.folder_id			, (SELECT Z.title FROM TB_RDFOLDER Z WHERE Z.record_center_id=E.record_center_id AND Z.folder_id=E.folder_id) AS folder_title			, E.record_id			, (SELECT Z.title FROM TB_RDRECORD Z WHERE Z.record_center_id=E.record_center_id AND Z.record_id=E.record_id) AS record_title			, E.orign_file_id			, (SELECT Z.file_nm FROM TB_STORIGNFILE Z WHERE Z.orign_file_id=E.orign_file_id) AS orign_file_nm			, E.work_start_dtime			, E.work_close_dtime			, E.error_cd			, E.error_cont			, E.followup_div_cd			, (CASE WHEN E.followup_div_cd='1' THEN '재변환' WHEN E.followup_div_cd='2' THEN '변환불가' ELSE '미조치' END) AS followup_div_nm			, E.followup_cause		FROM (			SELECT D.*			FROM (				SELECT ROWNUM AS rnum, C.*				FROM (					SELECT B.record_center_id, B.work_hist_id, B.folder_id, B.record_id, B.orign_file_id						, B.work_start_dtime, B.work_close_dtime, B.error_cd, B.error_cont						, B.followup_div_cd, B.followup_cause					FROM  TB_STWORKHIST B										WHERE					EXISTS (		                SELECT 1		                FROM TB_RDFOLDER A		                WHERE A.record_center_id = '1'		                					          AND A.record_center_id = B.record_center_id					          AND A.folder_id = B.folder_id AND 							A.folder_id = '1'						  AND 							A.org_cd = '1'						 						AND   A.folder_keep_state_cd IN ('01','04')					) AND 						B.record_id = '1'					 					AND (B.format_div_cd = '0' OR B.format_div_cd IS NULL) 					AND (B.followup_fin_flag IS NULL OR B.followup_fin_flag='0')										ORDER BY record_center_id, work_hist_id DESC				) C				WHERE ROWNUM <= '1'			) D			WHERE D.rnum >= '1'		) E;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfFailedMsgFolder

		SELECT COUNT(1)		FROM (			SELECT B.record_center_id, B.folder_id			FROM  TB_STWORKHIST B			WHERE 	           EXISTS (	               SELECT 1	               FROM TB_RDFOLDER A	               WHERE A.record_center_id = '1'				 AND 					A.folder_id = '1'				  AND 					A.org_cd = '1'				 				AND   A.folder_keep_state_cd IN ('01','04')				AND   A.record_center_id = B.record_center_id				AND   A.folder_id = B.folder_id	           ) AND 				B.record_id = '1'			 			AND (B.format_div_cd = '0' OR B.format_div_cd IS NULL) 			AND (B.followup_fin_flag IS NULL OR B.followup_fin_flag='0')			GROUP BY B.record_center_id, B.folder_id		) C;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfFailedMsgRecord

		SELECT COUNT(1)		FROM (			SELECT B.record_center_id, B.record_id			FROM  TB_STWORKHIST B			WHERE	           EXISTS (	               SELECT 1	               FROM TB_RDFOLDER A	               WHERE A.record_center_id = '1'				 AND 					A.folder_id = '1'				  AND 					A.org_cd = '1'				 				AND   A.folder_keep_state_cd IN ('01','04')				AND   A.record_center_id = B.record_center_id				AND   A.folder_id = B.folder_id	           ) AND 				B.record_id = '1'			 			AND (B.format_div_cd = '0' OR B.format_div_cd IS NULL) 			AND (B.followup_fin_flag IS NULL OR B.followup_fin_flag='0')			GROUP BY B.record_center_id, B.record_id		) C;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : insert
-- Query Id : createPresvFormatPdfOrgReqTrans

		INSERT INTO TB_STREQTRANS (			record_center_id, job_id, neo_gubun, folder_id, record_id, dest_storage_type, dest_storage_vendor, request_status, erecord_flag			, request_corp_cd, request_corp_nm, request_org_cd, request_org_nm, request_user_id, request_user_nm, request_user_pos_rank_nm		)		(			SELECT B.record_center_id				, TO_CHAR(SYSDATE,'YYYY')||LPAD(TB_STFORMAT_SQ01.NEXTVAL,13,'0') AS job_id				, '0' AS neo_gubun				, B.folder_id				, B.record_id				, D.medium_cd AS dest_storage_type				, NVL(D.medium_detail_cd, '01') AS dest_storage_vendor				, '-' AS request_status				, B.erecord_flag				, (SELECT Z.hupper_org_cd FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') AS request_corp_cd				, (SELECT Y.org_nm FROM TB_STORG Y, (SELECT Z.record_center_id, Z.hupper_org_cd FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') X WHERE Y.record_center_id=X.record_center_id AND Y.org_cd=X.hupper_org_cd) AS request_corp_nm				, '1'				, (SELECT Z.full_org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') AS request_org_nm				, '1'				, '1'				, (SELECT (CASE WHEN pos IS NULL AND rank IS NULL THEN ''								WHEN pos IS NULL AND rank IS NOT NULL THEN rank								WHEN pos IS NOT NULL AND rank IS NULL THEN pos								ELSE pos||'/'||rank							END)					FROM  TB_STUSER					WHERE user_id = '1') AS user_pos_rank	          FROM  TB_RDRECORD B				, ( SELECT medium_cd, medium_detail_cd					FROM (					    SELECT medium_cd, medium_detail_cd					    FROM  TB_STMEDIUM					    WHERE record_center_id = '1'					    AND   volm_id IN (SELECT volm_id FROM TB_STVOLM WHERE del_flag='0' AND volm_div_cd='2')					    AND   del_flag = '0'					    AND   (tot_size - use_size) > 0					    ORDER BY record_center_id, medium_id					) C					WHERE ROWNUM = 1) D	          WHERE	          EXISTS ( 			SELECT 1	                FROM  TB_RDFOLDER A	                WHERE A.record_center_id = '1'	                AND   A.org_cd = '1'	                AND   A.folder_keep_state_cd IN ('01','04')			AND   A.record_center_id = B.record_center_id			AND   A.folder_id = B.folder_id					 AND  							(A.creat_yyyy BETWEEN '1' AND '1')						  	              )	          AND   B.erecord_flag = '1'	          AND   (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state='0')         );


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfOrgNonErecordRecordOrign

        UPDATE TB_STRECORDORIGN	SET   pdf_a1_trans_state = '6'        WHERE        EXISTS ( SELECT 1			FROM  TB_RDFOLDER A				, TB_RDRECORD B				, TB_STRECORDORIGN C            WHERE A.record_center_id = B.record_center_id			AND   A.folder_id = B.folder_id			AND   B.record_center_id = C.record_center_id			AND   B.record_id = C.record_id			AND   A.record_center_id = '1'			AND   A.org_cd = '1'			 AND  					(A.creat_yyyy BETWEEN '1' AND '1')				              AND   A.folder_keep_state_cd IN ('01','04')	        AND   B.erecord_flag = '2'            )	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfOrgNonErecordRecord

        UPDATE TB_RDRECORD B        SET   B.pdf_a1_trans_state = '6'        WHERE        EXISTS(            SELECT 1            FROM  TB_RDFOLDER A            WHERE A.record_center_id = '1'			AND   A.org_cd = '1'			AND   A.record_center_id = B.record_center_id			AND   A.folder_id = B.folder_id AND  					(A.creat_yyyy BETWEEN '1' AND '1')				              AND   A.folder_keep_state_cd IN ('01','04')        )        AND   B.erecord_flag = '2'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : insert
-- Query Id : updatePresvFormatPdfOrgWaitOrignFile

		UPDATE TB_STORIGNFILE Z		SET   Z.pdf_a1_trans_state = '1'                WHERE 		 EXISTS(			SELECT 1			FROM  TB_STORIGNFILE A				, TB_RDRECORD B				, TB_STREQTRANS T				, TB_RDFOLDER F			WHERE F.record_center_id = '1'			AND   F.org_cd = '1'			AND   F.folder_keep_state_cd IN ('01','04')    			AND   B.record_center_id = F.record_center_id			AND   B.folder_id  = F.folder_id			AND   B.erecord_flag = '1'			AND   (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state='0')			AND   T.record_center_id = B.record_center_id 			AND   T.RECORD_ID = B.RECORD_ID			AND   T.REQUEST_STATUS = '-'			AND   A.record_center_id = B.record_center_id			AND   A.orign_id = B.orign_id                                                AND   A.record_center_id = Z.record_center_id                        AND   A.orign_id = Z.orign_id        )	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : insert
-- Query Id : updatePresvFormatPdfOrgWaitRecordOrign

		UPDATE TB_STRECORDORIGN Z		SET   Z.pdf_a1_trans_state = '1'		WHERE		EXISTS (			SELECT 1			FROM  TB_STORIGNFILE A				, TB_RDRECORD B				, TB_STREQTRANS T				, TB_RDFOLDER F			WHERE F.record_center_id = '1'			AND   F.org_cd = '1'			AND   F.folder_keep_state_cd IN ('01','04')    			AND   B.record_center_id = F.record_center_id			AND   B.folder_id  = F.folder_id			AND   B.erecord_flag = '1'			AND   (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state='0')			AND   T.record_center_id = B.record_center_id 			AND   T.RECORD_ID = B.RECORD_ID			AND   T.REQUEST_STATUS = '-'			AND   A.record_center_id = B.record_center_id			AND   A.orign_id = B.orign_id						AND   A.record_center_id = Z.record_center_id			AND   A.orign_id=Z.orign_id          )	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : insert
-- Query Id : updatePresvFormatPdfOrgWaitRecord

		UPDATE TB_RDRECORD Z		SET   pdf_a1_trans_state = '1'		WHERE  		EXISTS (			SELECT 1			FROM  TB_RDFOLDER F				, TB_STREQTRANS T			WHERE F.record_center_id = '1'			AND   F.org_cd = '1'			AND   F.folder_keep_state_cd IN ('01','04')			AND   T.record_center_id = F.record_center_id			AND   T.folder_id  = F.folder_id			AND   T.request_status = '-'						AND   F.record_center_id = Z.record_center_id			AND   F.folder_id = Z.folder_id		)		AND   erecord_flag = '1'		AND   (pdf_a1_trans_state IS NULL OR pdf_a1_trans_state='0')	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : insert
-- Query Id : updatePresvFormatPdfOrgWaitFolder

		UPDATE TB_RDFOLDER A		SET   A.pdf_a1_trans_state = ( CASE WHEN A.erecord_flag='2' THEN '6'                                            WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3','5'))) THEN '4'                                            WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3'))) THEN '5'                                            WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2','3')) THEN '0'                                            WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2')) THEN '3'                                            ELSE '1'                                        END )		WHERE  		EXISTS (			SELECT 1			FROM  TB_RDFOLDER F				, TB_STREQTRANS T			WHERE F.record_center_id = '1'			AND   F.org_cd = '1'			AND   F.folder_keep_state_cd IN ('01','04')			AND   T.record_center_id = F.record_center_id			AND   T.folder_id  = F.folder_id			AND   T.request_status = '-'						AND   F.record_center_id=A.record_center_id			AND   F.folder_id=A.folder_id		)           ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfOrgClearReqTrans

		UPDATE TB_STREQTRANS		SET   request_status = 'E'			, request_start_time = SYSDATE				WHERE 		EXISTS (			SELECT 1			FROM  TB_RDRECORD B			WHERE			EXISTS (                SELECT 1                FROM  TB_RDFOLDER A                WHERE A.record_center_id = '1'                AND   A.org_cd = '1'                AND   A.folder_keep_state_cd IN ('01','04')				AND   record_center_id = B.record_center_id		AND   FOLDER_ID = B.folder_id AND  						(A.creat_yyyy BETWEEN '1' AND '1')					  				AND   A.folder_keep_state_cd IN ('01','04')			  )		)		AND neo_gubun = '0';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : delete
-- Query Id : updatePresvFormatPdfOrgClearWorkHist

		DELETE FROM TB_STWORKHIST Z				WHERE		EXISTS (			SELECT 1			FROM  TB_RDRECORD B			WHERE			EXISTS (				SELECT 1				FROM  TB_RDFOLDER A				WHERE A.record_center_id = '1'				AND   A.org_cd = '1'				AND   A.record_center_id = B.record_center_id				AND   A.folder_id = B.folder_id AND  						(A.creat_yyyy BETWEEN '1' AND '1')					  				AND   A.folder_keep_state_cd IN ('01','04')			)					AND   B.record_center_id = Z.record_center_id		AND   B.folder_id = Z.folder_id		AND   B.record_id = Z.record_id		)		AND   format_div_cd = '0'		AND   (followup_div_cd IS NULL OR followup_div_cd IN ('0','1'));


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfOrgClearOrignFile

		UPDATE TB_STORIGNFILE Z		SET   pdf_a1_trans_state = '0'		WHERE 		EXISTS (			SELECT B.record_center_id, B.orign_id			FROM  TB_RDRECORD B			WHERE			EXISTS (				SELECT 1				FROM  TB_RDFOLDER A				WHERE A.record_center_id = '1'				AND   A.org_cd = '1'				AND   A.record_center_id = B.record_center_id				AND   A.folder_id = B.folder_id AND  						(A.creat_yyyy BETWEEN '1' AND '1')					  				AND   A.folder_keep_state_cd IN ('01','04')			)		AND B.record_center_id = Z.record_center_id		AND B.orign_id = Z.orign_id		)		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfOrgClearRecordOrign

		UPDATE TB_STRECORDORIGN Z		SET   pdf_a1_trans_state = '0'		WHERE		EXISTS (			SELECT 1			FROM  TB_RDRECORD B			WHERE 			EXISTS (				SELECT 1				FROM  TB_RDFOLDER A				WHERE A.record_center_id = '1'				AND   A.org_cd = '1'				AND   A.record_center_id=B.record_center_id				AND   A.folder_id=B.folder_id AND  						(A.creat_yyyy BETWEEN '1' AND '1')					  				AND   A.folder_keep_state_cd IN ('01','04')			)		AND B.record_center_id = Z.record_center_id		AND B.record_id = Z.record_id		)		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfOrgClearRecord

		UPDATE TB_RDRECORD Z		SET   pdf_a1_trans_state = '0'		WHERE		EXISTS (			SELECT 1			FROM  TB_RDFOLDER A			WHERE A.record_center_id = '1'			AND   A.org_cd = '1'			AND   A.record_center_id = Z.record_center_id			AND   A.folder_id = Z.folder_id AND  					(A.creat_yyyy BETWEEN '1' AND '1')  			AND   A.folder_keep_state_cd IN ('01','04')		);


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfOrgClearFolder

		UPDATE TB_RDFOLDER A		SET   A.pdf_a1_trans_state = ( CASE WHEN A.erecord_flag='2' THEN '6'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3','5'))) THEN '4'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3'))) THEN '5'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2','3')) THEN '0'											ELSE '1' END )		WHERE A.record_center_id = '1'		AND   A.org_cd = '1' AND  				(A.creat_yyyy BETWEEN '1' AND '1')			  		AND   A.folder_keep_state_cd IN ('01','04')	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : insert
-- Query Id : createPresvFormatPdfFolderReqTrans

		INSERT INTO TB_STREQTRANS (			record_center_id, job_id, neo_gubun, folder_id, record_id, dest_storage_type, dest_storage_vendor, request_status, erecord_flag			, request_corp_cd, request_corp_nm, request_org_cd, request_org_nm, request_user_id, request_user_nm, request_user_pos_rank_nm		)		(			SELECT B.record_center_id				, TO_CHAR(SYSDATE,'YYYY')||LPAD(TB_STFORMAT_SQ01.NEXTVAL,13,'0')				, '0'				, B.folder_id				, B.record_id				, D.medium_cd AS dest_storage_type				, NVL(D.medium_detail_cd, '01') AS dest_storage_vendor				, '-'				, '1'				, (SELECT Z.hupper_org_cd FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') AS request_corp_cd				, (SELECT Y.org_nm FROM TB_STORG Y, (SELECT Z.record_center_id, Z.hupper_org_cd FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') X WHERE Y.record_center_id=X.record_center_id AND Y.org_cd=X.hupper_org_cd) AS request_corp_nm				, '1'				, (SELECT Z.full_org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') AS request_org_nm				, '1'				, '1'				, (SELECT (CASE WHEN pos IS NULL AND rank IS NULL THEN ''								WHEN pos IS NULL AND rank IS NOT NULL THEN rank								WHEN pos IS NOT NULL AND rank IS NULL THEN pos								ELSE pos||'/'||rank							END)					FROM  TB_STUSER					WHERE user_id = '1') AS user_pos_rank			FROM  TB_RDRECORD B				, ( SELECT medium_cd, medium_detail_cd					FROM (					    SELECT medium_cd, medium_detail_cd					    FROM  TB_STMEDIUM					    WHERE record_center_id = '1'					    AND   volm_id IN (SELECT volm_id FROM TB_STVOLM WHERE del_flag='0' AND volm_div_cd='2')					    AND   del_flag = '0'					    AND   (tot_size - use_size) > 0					    ORDER BY record_center_id, medium_id					) C					WHERE ROWNUM = 1) D			WHERE B.record_center_id = '1'			AND   B.folder_id = '1'			AND   B.erecord_flag = '1'			AND   (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state='0')         );


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderNonErecordRecordOrign

		UPDATE TB_STRECORDORIGN Z		SET   pdf_a1_trans_state = '6'		WHERE		EXISTS (			SELECT 1			FROM  TB_RDRECORD B			WHERE B.record_center_id = '1'			AND   B.folder_id = '1'			AND   B.erecord_flag = '2'						AND   B.record_center_id = Z.record_center_id			AND   B.record_id = Z.record_id		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderNonErecordRecord

		UPDATE TB_RDRECORD B		SET   B.pdf_a1_trans_state = '6'		WHERE B.record_center_id = '1'		AND   B.folder_id = '1'		AND   B.erecord_flag = '2'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderWaitOrignFile

        UPDATE TB_STORIGNFILE A        SET   A.pdf_a1_trans_state = '1'        WHERE        EXISTS (            SELECT 1            FROM  TB_RDRECORD B			WHERE B.record_center_id = '1'			AND   B.folder_id = '1'			AND   B.erecord_flag = '1'			AND   (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state='0')			AND   record_center_id = A.record_center_id			AND   orign_id = A.orign_id        )        AND (A.pdf_a1_trans_state IS NULL OR A.pdf_a1_trans_state='0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderWaitRecordOrign

        UPDATE TB_STRECORDORIGN A        SET   A.pdf_a1_trans_state = '1'        WHERE         EXISTS (            SELECT 1            FROM  TB_RDRECORD B			WHERE B.record_center_id = '1'			AND   B.folder_id = '1'			AND   B.erecord_flag = '1'			AND   (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state='0')			AND   record_center_id = A.record_center_id			AND   orign_id = A.orign_id        )        AND (A.pdf_a1_trans_state IS NULL OR A.pdf_a1_trans_state='0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderWaitRecord

		UPDATE TB_RDRECORD		SET   pdf_a1_trans_state = '1'		WHERE record_center_id = '1'		AND   folder_id = '1'		AND   erecord_flag = '1'		AND ( pdf_a1_trans_state IS NULL OR pdf_a1_trans_state='0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderWaitFolder

		UPDATE TB_RDFOLDER A		SET   A.pdf_a1_trans_state = ( CASE WHEN A.erecord_flag='2' THEN '6'                                            WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3','5'))) THEN '4'                                            WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3'))) THEN '5'                                            WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2','3')) THEN '0'                                            WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2')) THEN '3'                                            ELSE '1'                                        END )		WHERE A.record_center_id = '1'		AND   A.folder_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderClearReqTrans

		UPDATE TB_STREQTRANS Z		SET   request_status = 'E'			, request_start_time = SYSDATE				WHERE 		EXISTS (			SELECT 1			FROM  TB_RDRECORD B	        WHERE B.record_center_id = '1'	        AND   B.folder_id = '1'		AND   B.record_center_id = Z.record_center_id		AND   B.folder_id = Z.folder_id		AND   B.record_id = Z.record_id					)		AND neo_gubun = '0'		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : delete
-- Query Id : updatePresvFormatPdfFolderClearWorkHist

		DELETE FROM TB_STWORKHIST Z				WHERE 		EXISTS (			SELECT 1			FROM  TB_RDRECORD B	        WHERE B.record_center_id = '1'	        AND   B.folder_id = '1'		AND   B.record_center_id = Z.record_center_id		AND   B.folder_id = Z.folder_id		AND   B.record_id = Z.record_id					)		AND   format_div_cd = '0'		AND   (followup_div_cd IS NULL OR followup_div_cd IN ('0','1'))	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderClearOrignFile

		UPDATE TB_STORIGNFILE Z		SET   pdf_a1_trans_state = '0'		WHERE 		EXISTS (			SELECT 1			FROM  TB_RDRECORD B	        WHERE B.record_center_id = '1'	        AND   B.folder_id = '1'		AND   B.record_center_id = Z.record_center_id		AND   B.orign_id = Z.orign_id		)		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderClearRecordOrign

		UPDATE TB_STRECORDORIGN Z		SET   pdf_a1_trans_state = '0'		WHERE		EXISTS (			SELECT 1			FROM  TB_RDRECORD B	        WHERE B.record_center_id = '1'	        AND   B.folder_id = '1'		AND   B.record_center_id=Z.record_center_id		AND   B.record_id=Z.record_id		)		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderClearRecord

		UPDATE TB_RDRECORD		SET   pdf_a1_trans_state = '0'        WHERE record_center_id = '1'        AND   folder_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFolderClearFolder

		UPDATE TB_RDFOLDER A		SET   A.pdf_a1_trans_state = ( CASE WHEN A.erecord_flag='2' THEN '6'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3','5'))) THEN '4'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3'))) THEN '5'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2','3')) THEN '0'											ELSE '1' END )		WHERE A.record_center_id = '1'        AND   A.folder_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : insert
-- Query Id : createPresvFormatPdfRecordReqTrans

		INSERT INTO TB_STREQTRANS (			record_center_id, job_id, neo_gubun, folder_id, record_id, dest_storage_type, dest_storage_vendor, request_status, erecord_flag			, request_corp_cd, request_corp_nm, request_org_cd, request_org_nm, request_user_id, request_user_nm, request_user_pos_rank_nm		)		(			SELECT B.record_center_id				, TO_CHAR(SYSDATE,'YYYY')||LPAD(TB_STFORMAT_SQ01.NEXTVAL,13,'0')				, '0'				, B.folder_id				, B.record_id				, D.medium_cd AS dest_storage_type				, NVL(D.medium_detail_cd,  '01') AS dest_storage_vendor				, '-'				, '1'				, (SELECT Z.hupper_org_cd FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') AS request_corp_cd				, (SELECT Y.org_nm FROM TB_STORG Y, (SELECT Z.record_center_id, Z.hupper_org_cd FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') X WHERE Y.record_center_id=X.record_center_id AND Y.org_cd=X.hupper_org_cd) AS request_corp_nm				, '1'				, (SELECT Z.full_org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = '1') AS request_org_nm				, '1'				, '1'				, (SELECT (CASE WHEN pos IS NULL AND rank IS NULL THEN ''								WHEN pos IS NULL AND rank IS NOT NULL THEN rank								WHEN pos IS NOT NULL AND rank IS NULL THEN pos								ELSE pos||'/'||rank							END)					FROM  TB_STUSER					WHERE user_id = '1') AS user_pos_rank			FROM  TB_RDRECORD B				, ( SELECT medium_cd, medium_detail_cd					FROM (					    SELECT medium_cd, medium_detail_cd					    FROM  TB_STMEDIUM					    WHERE record_center_id = '1'					    AND   volm_id IN (SELECT volm_id FROM TB_STVOLM WHERE del_flag='0' AND volm_div_cd='2')					    AND   del_flag = '0'					    AND   (tot_size - use_size) > 0					    ORDER BY record_center_id, medium_id					) C					WHERE ROWNUM = 1) D			WHERE B.record_center_id = '1'			AND   B.record_id = '1'			AND   B.erecord_flag = '1'			AND   (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state='0')         );


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordNonErecordRecordOrign

        UPDATE TB_STRECORDORIGN Z		SET   pdf_a1_trans_state = '6'		WHERE 		EXISTS (			SELECT 1			FROM  TB_RDRECORD B			WHERE B.record_center_id = '1'			AND   B.record_id = '1'	        AND   B.erecord_flag = '2'						AND   B.record_center_id = Z.record_center_id			AND   B.record_id = Z.record_id	    )	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordNonErecordRecord

        UPDATE TB_RDRECORD B        SET   B.pdf_a1_trans_state = '6'		WHERE B.record_center_id = '1'		AND   B.record_id = '1'        AND   B.erecord_flag = '2'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordWaitOrignFile

		UPDATE TB_STORIGNFILE A		SET   A.pdf_a1_trans_state = '1'		WHERE		EXISTS (		    SELECT 1		    FROM  TB_RDRECORD			WHERE record_center_id = '1'			AND   record_id = '1'			AND   record_center_id = A.record_center_id			AND   orign_id = A.orign_id		)		AND (A.pdf_a1_trans_state IS NULL OR A.pdf_a1_trans_state='0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordWaitRecordOrign

		UPDATE TB_STRECORDORIGN A		SET   A.pdf_a1_trans_state = '1'		WHERE A.record_center_id = '1'		AND   A.record_id = '1'        AND   A.erecord_flag = '1'		AND  (A.pdf_a1_trans_state IS NULL OR A.pdf_a1_trans_state='0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordWaitRecord

		UPDATE TB_RDRECORD A		SET   A.pdf_a1_trans_state = '1'		WHERE A.record_center_id = '1'		AND   A.record_id = '1'        AND   A.erecord_flag = '1'		AND  (A.pdf_a1_trans_state IS NULL OR A.pdf_a1_trans_state='0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordWaitFolder

		UPDATE TB_RDFOLDER A		SET   A.pdf_a1_trans_state = ( CASE WHEN A.erecord_flag='2' THEN '6'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3','5'))) THEN '4'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3'))) THEN '5'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2','3')) THEN '0'											ELSE '1'										END )		WHERE 		EXISTS (            SELECT 1            FROM  TB_RDRECORD			WHERE record_center_id = '1'			AND   record_id = '1'			AND   record_center_id=A.record_center_id			AND   folder_id = A.folder_id		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordClearReqTrans

		UPDATE TB_STREQTRANS Z		SET   request_status = 'E'			, request_start_time = SYSDATE				WHERE		EXISTS (			SELECT 1			FROM  TB_RDRECORD B	        WHERE B.record_center_id = '1'	        AND   B.record_id = '1'		AND   B.record_center_id = Z.record_center_id		AND   B.folder_id = Z.folder_id		AND   B.record_id = Z.record_id					)		AND neo_gubun = '0'		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : delete
-- Query Id : updatePresvFormatPdfRecordClearWorkHist

		DELETE FROM TB_STWORKHIST Z				WHERE		EXISTS (			SELECT 1			FROM  TB_RDRECORD B	        WHERE B.record_center_id = '1'	        AND   B.record_id = '1'		AND   B.record_center_id = Z.record_center_id		AND   B.folder_id = Z.folder_id		AND   B.record_id = Z.record_id		)		AND   format_div_cd = '0'		AND   (followup_div_cd IS NULL OR followup_div_cd IN ('0','1'));


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordClearOrignFile

		UPDATE TB_STORIGNFILE Z		SET   pdf_a1_trans_state = '0'		WHERE		EXISTS (			SELECT 1			FROM  TB_RDRECORD B	        WHERE B.record_center_id = '1'	        AND   B.record_id = '1'		AND   B.record_center_id = Z.record_center_id		AND   B.orign_id = Z.orign_id		)		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordClearRecordOrign

		UPDATE TB_STRECORDORIGN Z		SET   pdf_a1_trans_state = '0'		WHERE		EXISTS (			SELECT 1			FROM  TB_RDRECORD B	        WHERE B.record_center_id = '1'	        AND   B.record_id = '1'		AND   B.record_center_id = Z.record_center_id    		AND   B.record_id = Z.record_id		)		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordClearRecord

		UPDATE TB_RDRECORD		SET   pdf_a1_trans_state = '0'        WHERE record_center_id = '1'        AND   record_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordClearFolder

		UPDATE TB_RDFOLDER A		SET   A.pdf_a1_trans_state = ( CASE WHEN A.erecord_flag='2' THEN '6'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3','5'))) THEN '4'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3'))) THEN '5'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2','3')) THEN '0'											ELSE '1' END )		WHERE 		EXISTS (			SELECT 1			FROM  TB_RDRECORD	        WHERE record_center_id = '1'	        AND   record_id = '1'		AND   record_center_id = A.record_center_id		AND   folder_id = A.folder_id		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFollowup

		UPDATE TB_STWORKHIST		SET   followup_div_cd = '1'			, followup_cause = '1'			, followup_fin_flag = '1'		WHERE record_center_id = '1'		AND   work_hist_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfFollowup

		SELECT COUNT(1)		FROM  TB_STWORKHIST Z		WHERE		EXISTS (		    SELECT 1		    FROM  TB_STWORKHIST		    WHERE record_center_id = '1'		    AND   work_hist_id = '1'		    AND    record_center_id = Z.record_center_id	 	    AND    folder_id = Z.folder_id		    AND    record_id = Z.record_id		)		AND   format_div_cd = '0'		AND   (followup_div_cd IS NULL OR followup_div_cd = '0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFollowupWorkHist

		UPDATE TB_STWORKHIST		SET   followup_fin_flag = '1'	    WHERE record_center_id = '1'	    AND   work_hist_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFollowupOrignFile

		UPDATE TB_STORIGNFILE Z		SET  pdf_a1_trans_state			 = (SELECT (CASE WHEN followup_div_cd='1' THEN '0' WHEN followup_div_cd='2' THEN '6' ELSE '5' END)			    FROM TB_STWORKHIST			    WHERE record_center_id = '1'			    AND   work_hist_id = '1')		WHERE		EXISTS (		    SELECT 1		    FROM  TB_STWORKHIST		    WHERE record_center_id = '1'		    AND   work_hist_id = '1'		AND  record_center_id = Z.record_center_id		AND  orign_file_id = Z.orign_file_id		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFollowupRecordOrign

		UPDATE TB_STRECORDORIGN A		SET   A.pdf_a1_trans_state				= (CASE WHEN (SELECT COUNT(1) FROM TB_STORIGNFILE B WHERE B.record_center_id=A.record_center_id AND B.orign_id=A.orign_id AND B.pdf_a1_trans_state='1')>0 THEN '1'		                WHEN (SELECT COUNT(1) FROM TB_STORIGNFILE B WHERE B.record_center_id=A.record_center_id AND B.orign_id=A.orign_id AND B.pdf_a1_trans_state='2')>0 THEN '2'		                WHEN (SELECT COUNT(1) FROM TB_STORIGNFILE B WHERE B.record_center_id=A.record_center_id AND B.orign_id=A.orign_id AND B.pdf_a1_trans_state='3')>0 THEN '3'		                WHEN (SELECT COUNT(1) FROM TB_STORIGNFILE B WHERE B.record_center_id=A.record_center_id AND B.orign_id=A.orign_id AND B.pdf_a1_trans_state='0')>0 THEN '0'		                WHEN (SELECT COUNT(1) FROM TB_STORIGNFILE B WHERE B.record_center_id=A.record_center_id AND B.orign_id=A.orign_id AND B.pdf_a1_trans_state='4')>0 THEN '4'		                WHEN (SELECT COUNT(1) FROM TB_STORIGNFILE B WHERE B.record_center_id=A.record_center_id AND B.orign_id=A.orign_id AND B.pdf_a1_trans_state='6')>0 THEN '6'		                ELSE '5'		        	END)		WHERE 		EXISTS (		    SELECT 1		    FROM  TB_STWORKHIST		    WHERE record_center_id = '1'		    AND   work_hist_id = '1'		AND record_center_id = A.record_center_id		AND record_id = A.record_id		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFollowupRecord

		UPDATE TB_RDRECORD A		SET   A.pdf_a1_trans_state = (SELECT B.pdf_a1_trans_state FROM TB_STRECORDORIGN B WHERE B.record_center_id=A.record_center_id AND B.orign_id=A.orign_id)		WHERE		EXISTS (		    SELECT 1		    FROM  TB_STWORKHIST		    WHERE record_center_id = '1'		    AND   work_hist_id = '1'		AND record_center_id = A.record_center_id		AND record_id = A.record_id		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfFollowupFolder

		UPDATE TB_RDFOLDER A		SET   A.pdf_a1_trans_state = ( CASE WHEN A.erecord_flag='2' THEN '6'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3','5'))) THEN '4'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3'))) THEN '5'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2','3')) THEN '0'											ELSE '1' END )		WHERE		EXISTS (			SELECT 1		    FROM  TB_STWORKHIST		    WHERE record_center_id = '1'		    AND   work_hist_id = '1'		AND record_center_id = A.record_center_id		AND folder_id = A.folder_id		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : countPresvFormatPdfFollowupRetry

		SELECT COUNT(1)		FROM TB_STWORKHIST a		WHERE		EXISTS (		    SELECT 1		    FROM TB_STWORKHIST		    WHERE record_center_id = '1'		    AND   work_hist_id = '1'		AND record_center_id = A.record_center_id		AND folder_id = A.folder_id		AND record_id = A.record_id			)		AND   format_div_cd = '0'		AND   followup_div_cd = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : select
-- Query Id : findPresvFormatPdfFollowupFialJobid

		SELECT MAX(job_id) AS job_id		FROM  TB_STREQTRANS		WHERE record_center_id = '1'		AND   record_id = '1'		AND   request_status = 'D'	     	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfRecordQueue

		UPDATE TB_STREQTRANS		SET   request_status = '-'			, wflb_server_ip = ''			, reflection_flag = ''		WHERE job_id = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfWaitOrignFile

		UPDATE TB_STORIGNFILE A		SET   A.pdf_a1_trans_state = '1'		WHERE	 	EXISTS (		    SELECT 1		    FROM  TB_RDRECORD Z		    WHERE		    EXISTS (	            	SELECT 1	           	 FROM  TB_STREQTRANS 	            	WHERE job_id = '1'						AND record_center_id = Z.record_center_id			AND record_id = Z.record_id		    	)		)		AND (A.pdf_a1_trans_state IS NULL OR A.pdf_a1_trans_state='0')				AND record_center_id = A.record_center_id		AND orign_id = A.orign_id;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfWaitRecordOrign

		UPDATE TB_STRECORDORIGN A		SET   A.pdf_a1_trans_state = (CASE WHEN A.erecord_flag='2' THEN '6' ELSE '1' END)		WHERE (A.record_center_id, A.record_id)		= (            SELECT record_center_id, record_id            FROM  TB_STREQTRANS            WHERE job_id = '1'		)		AND (A.pdf_a1_trans_state IS NULL OR A.pdf_a1_trans_state='0')	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfWaitRecord

		UPDATE TB_RDRECORD A		SET   A.pdf_a1_trans_state = (CASE WHEN A.erecord_flag='2' THEN '6' ELSE '1' END)			, A.pdf_job_id = '1'		WHERE (A.record_center_id, A.record_id)		= (            SELECT record_center_id, record_id            FROM  TB_STREQTRANS            WHERE job_id = '1'		)		AND (A.pdf_a1_trans_state IS NULL OR A.pdf_a1_trans_state='0');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : update
-- Query Id : updatePresvFormatPdfWaitFolder

		UPDATE TB_RDFOLDER A		SET   A.pdf_a1_trans_state = ( CASE WHEN A.erecord_flag='2' THEN '6'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3','5'))) THEN '4'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND (B.pdf_a1_trans_state IS NULL OR B.pdf_a1_trans_state IN ('0','1','2','3'))) THEN '5'											WHEN NOT EXISTS (SELECT 1 FROM TB_RDRECORD B WHERE B.record_center_id=A.record_center_id AND B.folder_id=A.folder_id AND B.erecord_flag='1' AND B.pdf_a1_trans_state IN ('1','2','3')) THEN '0'											ELSE '1'										END )				WHERE 		EXISTS (            SELECT 1            FROM  TB_STREQTRANS            WHERE job_id = '1'		    AND record_center_id = A.record_center_id	    AND FOLDER_id = A.folder_id		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : delete
-- Query Id : deletePresvFormatPdfOtherFile

		DELETE FROM TB_STREQFILE		WHERE record_center_id = '1'		AND   job_id = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : delete
-- Query Id : deletePresvFormatPdfOtherResult

		DELETE FROM TB_STREQRESULT		WHERE record_center_id = '1'		AND   job_id = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
-- Query    : delete
-- Query Id : deletePresvFormatPdfOtherWorkHist

		DELETE FROM TB_STWORKHIST		WHERE record_center_id = '1'		AND   record_id = '1'		AND FORMAT_DIV_CD    = '0'		AND (FOLLOWUP_DIV_CD IS NULL OR FOLLOWUP_DIV_CD  IN ('0','1'))	;


-- File Close : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\format\PresvFormatPdf.xml
