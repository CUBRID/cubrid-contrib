-- File Open : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : findDisuseHandlDeptOpinRegDetailPagedList

		SELECT D.*		FROM (			SELECT ROWNUM AS rnum				, C.*			FROM (				SELECT A.FOLDER_ID				    , A.EXCEL_DWN_FLAG					, (CASE WHEN B.CLSS_DIV_CD = '1' THEN (SELECT MAX(A.BIS_CLSS_NM) FROM TB_ZZBISCLSS A WHERE A.BIS_CLSS_ID = B.CLSS_ID)						    WHEN B.CLSS_DIV_CD = '2' THEN (SELECT MAX(A.UNIT_NM) FROM TB_ZZUNIT A WHERE A.UNIT_CD = B.CLSS_ID)					   END) AS BIS_CLSS_NM				    , B.TITLE				    , B.CREAT_YYYY				    , A.CUR_PRESV_TERM_CD				    , A.HANDL_ORG_DISU_DIV_CD				    , A.DISCU_PROG_STATE_CD				    , A.HANDL_ORG_DEFER_CD				    , A.HANDL_ORG_TERM_CD				    , CASE WHEN A.CUR_PRESV_TERM_CD = '01' THEN '01'				           WHEN A.CUR_PRESV_TERM_CD = '03' THEN '01,03'				           WHEN A.CUR_PRESV_TERM_CD = '05' THEN '01,03,05'				           WHEN A.CUR_PRESV_TERM_CD = '10' THEN '01,03,05,10'				           WHEN A.CUR_PRESV_TERM_CD = '25' THEN '01,03,05,10,25'				           WHEN A.CUR_PRESV_TERM_CD = '30' THEN '01,03,05,10,25,30'				           WHEN A.CUR_PRESV_TERM_CD = '40' THEN '01,03,05,10,25,30,40'				       END AS HANDL_ORG_TERM_CD_SKIP				    , A.DISCU_REQ_FLAG				    , (SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD) AS ORG_NM				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM     				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM				    , B.HO_NO				    , (SELECT COUNT(1) FROM TB_DFDISUSEOPINHIST WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND FOLDER_ID = B.FOLDER_ID) AS HIST_QTY				    , B.folder_keep_state_cd				FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B				WHERE A.RECORD_CENTER_ID = '1'				AND A.DISCU_YYYY = '1'				AND ( A.DISCU_PROG_STATE_CD IN ('03','04','05','06','07','08','09') OR A.EXCEL_DWN_FLAG = '1' ) AND 				 	A.DISCU_REQ_FLAG = '1'				  AND 					A.ORG_CD = '1'				  AND 					A.HANDL_ORG_DISU_DIV_CD = '1'				 				AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID				AND B.FOLDER_ID = A.FOLDER_ID AND 					B.ORG_CD = '1'				  AND  						B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')					   AND 					B.PRESV_TERM_CD = '1'				  AND 					B.TITLE LIKE '1'				 				ORDER BY A.ORG_CD, A.FOLDER_ID			) C			WHERE ROWNUM <= '1'		) D		WHERE D.rnum >= '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : countDisuseHandlDeptOpinRegDetailPagedList

		SELECT COUNT(1)		FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1'		AND ( A.DISCU_PROG_STATE_CD IN ('03','04','05','06','07','08','09') OR A.EXCEL_DWN_FLAG = '1' )		 AND 		 	A.DISCU_REQ_FLAG = '1'		  AND 			A.ORG_CD = '1'		  AND 			A.HANDL_ORG_DISU_DIV_CD = '1'		 		AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID		AND B.FOLDER_ID = A.FOLDER_ID AND 			B.ORG_CD = '1'		  AND  				B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			   AND 			B.PRESV_TERM_CD = '1'		  AND 			B.TITLE LIKE '1'		 ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : findDisuseExpertOpinRegPagedList

		SELECT D.*		FROM (			SELECT ROWNUM AS rnum				, C.*			FROM (				SELECT A.ORG_CD				    , MAX(( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = A.ORG_CD )) AS ORG_NM  				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD >= '03' THEN 1 ELSE 0 END) AS TOT_CNT1				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD = '03' THEN 1 ELSE 0 END) AS OPIN1_CNT1				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD >= '04' AND A.HANDL_ORG_DISU_DIV_CD = '1' THEN 1 ELSE 0 END) AS OPIN2_CNT1				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD >= '04' AND A.HANDL_ORG_DISU_DIV_CD = '2' THEN 1 ELSE 0 END) AS OPIN3_CNT1				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD >= '04' AND A.HANDL_ORG_DISU_DIV_CD = '3' THEN 1 ELSE 0 END) AS OPIN4_CNT1				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD >= '04' THEN 1 ELSE 0 END) AS TOT_CNT2				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD = '04' THEN 1 ELSE 0 END) AS OPIN1_CNT2				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD >= '05' AND A.EXPERT_DISU_DIV_CD = '1' THEN 1 ELSE 0 END) AS OPIN2_CNT2				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD >= '05' AND A.EXPERT_DISU_DIV_CD = '2' THEN 1 ELSE 0 END) AS OPIN3_CNT2				    , SUM(CASE WHEN A.DISCU_PROG_STATE_CD >= '05' AND A.EXPERT_DISU_DIV_CD = '3' THEN 1 ELSE 0 END) AS OPIN4_CNT2				FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B				WHERE A.RECORD_CENTER_ID = '1'				AND A.DISCU_YYYY = '1' AND  						B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')					  				AND ( A.DISCU_PROG_STATE_CD IN ('03','04','05','06','07','08','09') OR A.EXCEL_DWN_FLAG = '1' )   				AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID				AND B.FOLDER_ID = A.FOLDER_ID				 AND 					A.ORG_CD = '1'				    				GROUP BY A.ORG_CD			) C			WHERE ROWNUM <= '1'		) D		WHERE D.rnum >= '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : countDisuseExpertOpinRegPagedList

		SELECT COUNT(1)		FROM (			SELECT A.ORG_CD			FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B			WHERE A.RECORD_CENTER_ID = '1'			AND A.DISCU_YYYY = '1' AND  					B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')				  			AND ( A.DISCU_PROG_STATE_CD IN ('03','04','05','06','07','08','09') OR A.EXCEL_DWN_FLAG = '1' )   			AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID			AND B.FOLDER_ID = A.FOLDER_ID			 AND 				A.ORG_CD = '1'			    			GROUP BY A.ORG_CD		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : findDisuseExpertOpinRegDetailPagedList

		SELECT D.*		FROM (			SELECT ROWNUM AS rnum				, C.*			FROM (				SELECT A.FOLDER_ID				    , A.EXCEL_DWN_FLAG					, (CASE WHEN B.CLSS_DIV_CD = '1' THEN (SELECT MAX(A.BIS_CLSS_NM) FROM TB_ZZBISCLSS A WHERE A.BIS_CLSS_ID = B.CLSS_ID)						    WHEN B.CLSS_DIV_CD = '2' THEN (SELECT MAX(A.UNIT_NM) FROM TB_ZZUNIT A WHERE A.UNIT_CD = B.CLSS_ID)					   END) AS BIS_CLSS_NM				    , B.TITLE				    , B.CREAT_YYYY				    , A.CUR_PRESV_TERM_CD				    , A.DISCU_PROG_STATE_CD				    , CASE WHEN A.CUR_PRESV_TERM_CD = '01' THEN '01'				           WHEN A.CUR_PRESV_TERM_CD = '03' THEN '01,03'				           WHEN A.CUR_PRESV_TERM_CD = '05' THEN '01,03,05'				           WHEN A.CUR_PRESV_TERM_CD = '10' THEN '01,03,05,10'				           WHEN A.CUR_PRESV_TERM_CD = '25' THEN '01,03,05,10,25'				           WHEN A.CUR_PRESV_TERM_CD = '30' THEN '01,03,05,10,25,30'				           WHEN A.CUR_PRESV_TERM_CD = '40' THEN '01,03,05,10,25,30,40'				      END AS HANDL_ORG_TERM_CD_SKIP				    , A.HANDL_ORG_DISU_DIV_CD				    , A.HANDL_ORG_DEFER_CD				    , A.HANDL_ORG_TERM_CD				    , A.HANDL_ORG_RSN				    , A.EXPERT_DISU_DIV_CD				    , A.EXPERT_DISU_DEFER_CD				    , A.EXPERT_DISU_TERM_CD				    , A.EXPERT_DISU_RSN				    , A.DISCU_REQ_FLAG     				    , ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD ) AS ORG_NM				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM     				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM				    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM				    , B.HO_NO				    , (SELECT COUNT(1) FROM TB_DFDISUSEOPINHIST WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND FOLDER_ID = B.FOLDER_ID) AS HIST_QTY				    , B.folder_keep_state_cd				FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B				WHERE A.RECORD_CENTER_ID = '1'				AND A.DISCU_YYYY = '1'				AND ( A.DISCU_PROG_STATE_CD IN ('04','05','06','07','08','09') OR A.EXCEL_DWN_FLAG = '1' ) AND 					A.DISCU_REQ_FLAG = '1'				  AND 					A.ORG_CD = '1'				  AND 					A.HANDL_ORG_DISU_DIV_CD = '1'				  AND 					A.EXPERT_DISU_DIV_CD = '1'				 					AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID				AND B.FOLDER_ID = A.FOLDER_ID				 AND 					A.ORG_CD = '1'				  AND  						B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')					   AND 					B.PRESV_TERM_CD = '1'				  AND 					B.TITLE LIKE '1'				 				ORDER BY A.ORG_CD, A.FOLDER_ID			) C			WHERE ROWNUM <= '1'		) D		WHERE D.rnum >= '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : countDisuseExpertOpinRegDetailPagedList

		SELECT COUNT(*)  		FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1'		AND ( A.DISCU_PROG_STATE_CD IN ('04','05','06','07','08','09') OR A.EXCEL_DWN_FLAG = '1' )		 AND 			A.DISCU_REQ_FLAG = '1'		  AND 			A.ORG_CD = '1'		  AND 			A.HANDL_ORG_DISU_DIV_CD = '1'		  AND 			A.EXPERT_DISU_DIV_CD = '1'		 			AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID		AND B.FOLDER_ID = A.FOLDER_ID		 AND 			A.ORG_CD = '1'		  AND  				B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			   AND 			B.PRESV_TERM_CD = '1'		  AND 			B.TITLE LIKE '1'		 ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : findDisuseHandlDeptOpinRegEach

		SELECT A.FOLDER_ID			, B.TITLE		    , B.CREAT_YYYY		    , A.DISCU_PROG_STATE_CD		    , A.HANDL_ORG_DISU_DIV_CD		    , A.HANDL_ORG_DEFER_CD		    , A.HANDL_ORG_TERM_CD		    , A.CUR_DELAY_CD		    , A.CUR_PRESV_TERM_CD		    , A.HANDL_ORG_RSN		    , A.HANDL_ORG_YMD		    , A.HANDL_ORG_USER_ID		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.CUR_DELAY_CD) AS CUR_DELAY_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM		    , CASE WHEN A.CUR_PRESV_TERM_CD = '01' THEN '01'		           WHEN A.CUR_PRESV_TERM_CD = '03' THEN '01,03'		           WHEN A.CUR_PRESV_TERM_CD = '05' THEN '01,03,05'		           WHEN A.CUR_PRESV_TERM_CD = '10' THEN '01,03,05,10'		           WHEN A.CUR_PRESV_TERM_CD = '25' THEN '01,03,05,10,25'		           WHEN A.CUR_PRESV_TERM_CD = '30' THEN '01,03,05,10,25,30'		           WHEN A.CUR_PRESV_TERM_CD = '40' THEN '01,03,05,10,25,30,40'		      END AS HANDL_ORG_TERM_CD_SKIP		    , A.DISCU_REQ_FLAG		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF13' AND COM_CD = A.DISCU_ORIGN_TYPE_CD) AS DISCU_ORIGN_TYPE_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD85' AND COM_CD = B.PRESV_TYPE_CD) AS PRESV_TYPE_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD37' AND COM_CD = B.MF_PIC_STATE_CD) AS MF_PIC_STATE_NM     		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD50' AND COM_CD = B.SCAN_PROG_STATE_CD) AS SCAN_PROG_STATE_NM     		FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1'		AND A.FOLDER_ID = '1'		AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID		AND B.FOLDER_ID = A.FOLDER_ID;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : findDisuseExpertOpinRegEach

		SELECT A.FOLDER_ID			, B.TITLE		    , B.CREAT_YYYY		    , A.DISCU_PROG_STATE_CD		    , A.CUR_DELAY_CD		    , A.CUR_PRESV_TERM_CD		    , A.EXPERT_DISU_DIV_CD		    , A.EXPERT_DISU_DEFER_CD		    , A.EXPERT_DISU_TERM_CD		    , A.EXPERT_DISU_RSN		    , A.EXPERT_DISU_YMD		    , A.EXPERT_DISU_USER_ID		    , A.HANDL_ORG_DISU_DIV_CD		    , A.HANDL_ORG_DEFER_CD		    , A.HANDL_ORG_TERM_CD		    , A.HANDL_ORG_RSN		    , A.HANDL_ORG_YMD		    , A.HANDL_ORG_USER_ID		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.CUR_DELAY_CD) AS CUR_DELAY_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.EXPERT_DISU_DIV_CD) AS EXPERT_DISU_DIV_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM		    , CASE WHEN A.CUR_PRESV_TERM_CD = '01' THEN '01'		           WHEN A.CUR_PRESV_TERM_CD = '03' THEN '01,03'		           WHEN A.CUR_PRESV_TERM_CD = '05' THEN '01,03,05'		           WHEN A.CUR_PRESV_TERM_CD = '10' THEN '01,03,05,10'		           WHEN A.CUR_PRESV_TERM_CD = '25' THEN '01,03,05,10,25'		           WHEN A.CUR_PRESV_TERM_CD = '30' THEN '01,03,05,10,25,30'		           WHEN A.CUR_PRESV_TERM_CD = '40' THEN '01,03,05,10,25,30,40'		      END AS EXPERT_TERM_CD_SKIP		    , A.DISCU_REQ_FLAG		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF13' AND COM_CD = A.DISCU_ORIGN_TYPE_CD) AS DISCU_ORIGN_TYPE_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD85' AND COM_CD = B.PRESV_TYPE_CD) AS PRESV_TYPE_NM		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD37' AND COM_CD = B.MF_PIC_STATE_CD) AS MF_PIC_STATE_NM     		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD50' AND COM_CD = B.SCAN_PROG_STATE_CD) AS SCAN_PROG_STATE_NM       		FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1'		AND A.FOLDER_ID = '1'		AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID		AND B.FOLDER_ID = A.FOLDER_ID;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : findExcelDocDisuseFullRsltReg

		SELECT A.RECORD_CENTER_ID		    , A.DISCU_YYYY		    , A.FOLDER_ID		    , A.DISCU_PROG_STATE_CD		    , A.EXCEL_DWN_FLAG		    , A.DISCU_YYYY_SEQ		    , A.ORG_CD AS HANDL_ORG_CD		    , B.TITLE			, (CASE WHEN B.CLSS_DIV_CD = '1' THEN (SELECT MAX(A.BIS_CLSS_NM) FROM TB_ZZBISCLSS A WHERE A.BIS_CLSS_ID = B.CLSS_ID)				    WHEN B.CLSS_DIV_CD = '2' THEN (SELECT MAX(A.UNIT_NM) FROM TB_ZZUNIT A WHERE A.UNIT_CD = B.CLSS_ID)			   END) AS BIS_CLSS_NM		    , ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD ) AS ORG_NM		    , ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = A.RECORD_CENTER_ID AND ORG_CD = A.ORG_CD ) AS HANDL_ORG_NM		    , B.CREAT_SYS_CD		    , B.ORG_CD		    , B.CLSS_ID		    , B.CREAT_YYYY		    , B.FOLDER_REG_SEQ		    , B.HO_NO		    , B.CREAT_DTIME		    , B.PRESV_TERM_CD		    , A.DISCU_REQ_FLAG		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = B.PRESV_TERM_CD) AS PRESV_TERM_NM     		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM		    , CASE WHEN A.HANDL_ORG_DISU_DIV_CD = '0' THEN NULL ELSE A.HANDL_ORG_DISU_DIV_CD END AS HANDL_ORG_DISU_DIV_CD 		    , TO_CHAR(TO_NUMBER(TRIM(A.HANDL_ORG_DEFER_CD))) AS HANDL_ORG_DEFER_CD 		    , TO_CHAR(TO_NUMBER(TRIM(A.HANDL_ORG_TERM_CD))) AS HANDL_ORG_TERM_CD 		    , A.HANDL_ORG_RSN		    , A.HANDL_ORG_YMD		    , CASE WHEN A.EXPERT_DISU_DIV_CD = '0' THEN NULL ELSE A.EXPERT_DISU_DIV_CD END AS EXPERT_DISU_DIV_CD 		    , TO_CHAR(TO_NUMBER(TRIM(A.EXPERT_DISU_DEFER_CD))) AS EXPERT_DISU_DEFER_CD 		    , TO_CHAR(TO_NUMBER(TRIM(A.EXPERT_DISU_TERM_CD))) AS EXPERT_DISU_TERM_CD 		    , A.EXPERT_DISU_RSN		    , A.EXPERT_DISU_YMD		    , CASE WHEN A.REVIEW_DIV_CD = '0' THEN NULL ELSE A.REVIEW_DIV_CD END AS REVIEW_DIV_CD 		    , TO_CHAR(TO_NUMBER(TRIM(A.REVIEW_DEFER_CD))) AS REVIEW_DEFER_CD 		    , TO_CHAR(TO_NUMBER(TRIM(A.REVIEW_REFIX_AFT_PRESV_TERM))) AS REVIEW_TERM_CD 		    , A.REVIEW_REFIX_AFT_RSN AS REVIEW_RSN		    , A.REVIEW_YMD		    , CASE WHEN A.NAT_CMT_DIV_CD = '0' THEN NULL ELSE A.NAT_CMT_DIV_CD END AS NAT_CMT_DIV_CD		    , TO_CHAR(TO_NUMBER(TRIM(A.NAT_CMT_DEFER_CD))) AS NAT_CMT_DEFER_CD 		    , TO_CHAR(TO_NUMBER(TRIM(A.NAT_CMT_REFIX_AFT_PRESV_TERM))) AS NAT_CMT_TERM_CD 		    , A.NAT_CMT_REFIX_AFT_RSN AS NAT_CMT_RSN		    , A.NAT_CMT_YMD		    , B.STAKRM_MNG_NO		    , (SELECT BATCH_NO FROM (		    	SELECT ROW_NUMBER() OVER (PARTITION BY B.RECORD_CENTER_ID, B.FOLDER_ID ORDER BY A.ARNG_YMD DESC, SNO DESC) AS SORT_NUM		    		, A.RECORD_CENTER_ID		    		, B.FOLDER_ID		    		, B.STAKRM_ID||'-'|| B.BOOKSF_ID||'-'|| B.BOOKSF_SHELF_CNO||'-'|| B.BOOKSF_SHELF_RNO AS BATCH_NO                 FROM TB_SRBOOKSFARNG A, TB_SRBOOKSFARNGDETL B                	WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID                 AND A.BOOKSF_ARNG_ID = B.BOOKSF_ARNG_ID                 AND A.FIN_FLAG = '1'               	)E         	WHERE SORT_NUM = '1'             AND E.RECORD_CENTER_ID = B.RECORD_CENTER_ID             AND E.FOLDER_ID = B.FOLDER_ID        		) AS BATCH_NO		FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1'		AND ( A.DISCU_PROG_STATE_CD IN ('03','04','05','06','07','08','09') OR A.EXCEL_DWN_FLAG = '1' )				AND A.REVIEW_COFIRM_CD = '0' AND 			A.DISCU_REQ_FLAG = '1'		  AND 			A.DISCU_PROG_STATE_CD IN ('03') 		  AND 			A.ORG_CD = '1'		  AND 			A.REVIEW_DIV_CD = '1'		  AND 			A.NAT_CMT_DIV_CD = '1'		  AND 			A.HANDL_ORG_DISU_DIV_CD = '1'		  AND 			A.EXPERT_DISU_DIV_CD = '1'		 		AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID		AND B.FOLDER_ID        = A.FOLDER_ID AND 			B.ORG_CD = '1'		  AND  				B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			   AND 			B.PRESV_TERM_CD = '1'		  AND 			B.TITLE LIKE '1'		 		ORDER BY B.ORG_CD, B.FOLDER_ID	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : update
-- Query Id : updateDisuseHandlDeptOpinRegEach

		UPDATE TB_DFDISUSEOPIN A		SET A.DISCU_PROG_STATE_CD = '04'		    , A.HANDL_ORG_DISU_DIV_CD = '1'		    , A.HANDL_ORG_DEFER_CD = CASE WHEN '1' = '2' THEN LPAD('1',2,'0') ELSE NULL END		    , A.HANDL_ORG_TERM_CD = CASE WHEN A.DISCU_REQ_FLAG IN ('0','1') AND '1' = '3' THEN LPAD('1',2,'0') ELSE NULL END		    , A.HANDL_ORG_RSN = '1'		    , A.HANDL_ORG_YMD = TO_CHAR(SYSDATE,'YYYYMMDD')		    , A.HANDL_ORG_USER_ID = '1'		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1'		AND A.FOLDER_ID  = '1'		AND A.DISCU_PROG_STATE_CD IN ('03','04')		AND A.REVIEW_COFIRM_CD = '0'		AND A.EXCEL_DWN_FLAG = '0';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : update
-- Query Id : updateDisuseHandlDeptRjct

		UPDATE TB_DFDISUSEOPIN A   		SET A.DISCU_PROG_STATE_CD = '02'     		, A.ORG_CD = NULL     		, A.RJCT_FLAG = '1' 		WHERE A.RECORD_CENTER_ID = '1'   		AND A.DISCU_YYYY = '1'		AND A.FOLDER_ID = '1'      		AND A.DISCU_PROG_STATE_CD IN ('03')   		AND A.REVIEW_COFIRM_CD = '0'   		AND A.EXCEL_DWN_FLAG = '0'   ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : update
-- Query Id : updateDisuseExcelDwnFlag

		UPDATE TB_DFDISUSEOPIN A   		SET A.EXCEL_DWN_FLAG = '1' 		WHERE A.RECORD_CENTER_ID = '1' 		AND A.FOLDER_ID = '1'   		AND A.DISCU_YYYY = '1'   		AND A.DISCU_PROG_STATE_CD IN ('03','04','05','06','07')   		AND A.ORG_CD = '1'   		AND A.REVIEW_COFIRM_CD = '0' AND  			A.DISCU_REQ_FLAG = '1'		 ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : update
-- Query Id : updateDisuseExpertOpinRegEach

		UPDATE TB_DFDISUSEOPIN A   		SET A.DISCU_PROG_STATE_CD = '05'     		, A.EXPERT_DISU_DIV_CD = '1'     		, A.EXPERT_DISU_DEFER_CD = CASE WHEN '1' = '2' THEN LPAD('1',2,'0') ELSE NULL END     		, A.EXPERT_DISU_TERM_CD = CASE WHEN A.DISCU_REQ_FLAG IN ('0','1') AND '1' = '3' THEN LPAD('1',2,'0') ELSE NULL END     		, A.EXPERT_DISU_RSN = '1'     		, A.EXPERT_DISU_YMD = TO_CHAR(SYSDATE,'YYYYMMDD')     		, A.EXPERT_DISU_USER_ID = '1' 		WHERE A.RECORD_CENTER_ID = '1' 		AND A.DISCU_YYYY = '1'   		AND A.FOLDER_ID  = '1'    		AND A.DISCU_PROG_STATE_CD IN ('04','05')   		AND A.REVIEW_COFIRM_CD = '0'   		AND A.EXCEL_DWN_FLAG = '0';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : update
-- Query Id : updateDisuseFullRsltRegExcel

		UPDATE TB_DFDISUSEOPIN A		SET A.DISCU_PROG_STATE_CD = '07'		    , A.DISCU_YYYY_SEQ = '1'		    , A.HANDL_ORG_DISU_DIV_CD = '1' 		    	, A.HANDL_ORG_DEFER_CD = CASE WHEN '1' = '2' THEN LPAD('1',2,'0') ELSE NULL END				  		    	, A.HANDL_ORG_TERM_CD = CASE WHEN A.DISCU_REQ_FLAG = '0' AND '1' = '3' THEN LPAD('1',2,'0') ELSE NULL END		     		    , A.HANDL_ORG_RSN = '1'		    , A.HANDL_ORG_YMD = TO_CHAR(SYSDATE,'YYYYMMDD')		    , A.HANDL_ORG_USER_ID = '1'		    , A.EXPERT_DISU_DIV_CD = '1' 		    	, A.EXPERT_DISU_DEFER_CD = CASE WHEN '1' = '2' THEN LPAD('1',2,'0') ELSE NULL END     		      		    	, A.EXPERT_DISU_TERM_CD = CASE WHEN A.DISCU_REQ_FLAG = '0' AND '1' = '3' THEN LPAD('1',2,'0') ELSE NULL END     		     		    , A.EXPERT_DISU_RSN = '1'		    , A.EXPERT_DISU_YMD = TO_CHAR(SYSDATE,'YYYYMMDD')		    , A.EXPERT_DISU_USER_ID = '1'		    , A.REVIEW_DIV_CD = '1' 		    	, A.REVIEW_DEFER_CD = CASE WHEN '1' = '2' THEN LPAD('1',2,'0') ELSE NULL END		      		    	, A.REVIEW_REFIX_AFT_PRESV_TERM = CASE WHEN A.DISCU_REQ_FLAG = '0' AND '1' = '3' THEN LPAD('1',2,'0') ELSE NULL END		     		    , A.REVIEW_REFIX_AFT_RSN = '1'		    , A.REVIEW_YMD = TO_CHAR(SYSDATE,'YYYYMMDD')		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1'		AND A.FOLDER_ID  = '1' 		AND A.DISCU_PROG_STATE_CD IN ('03','04','05','06','07')		AND A.REVIEW_COFIRM_CD = '0'		AND A.EXCEL_DWN_FLAG = '1' AND 			A.DISCU_REQ_FLAG = '1'		 ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : findDisuseRegOpinBatchErrorXls

		SELECT file_nm			, file_key		FROM TB_ZZREQEXCELLIST		WHERE REQ_USER_ID = '1'		AND REQ_MENU_ID = '1'		AND REQ_INDEX = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
-- Query    : select
-- Query Id : countAlreadyRsltDisuse

		SELECT COUNT(*) AS CNT  		FROM TB_DFDISUSEOPIN A 		WHERE A.RECORD_CENTER_ID = '1'   		AND A.DISCU_YYYY = '1'   		AND A.ORG_CD = '1'   		AND A.DISCU_PROG_STATE_CD = '09'   ;


-- File Close : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseRegOpin.xml
