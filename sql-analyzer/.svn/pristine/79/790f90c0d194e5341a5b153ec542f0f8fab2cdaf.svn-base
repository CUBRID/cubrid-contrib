-- File Open : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : countOptidiskMstTrgtStatPagedList

		SELECT COUNT(1)        FROM (            select  t.creat_yyyy,                     (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('1', '3')) as ele_trgt_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('1', '3') and opti_disk_store_state_cd in ('1', '2', '3', '4', '5')) as ele_choice_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('1', '3') and opti_disk_store_state_cd in ('4', '5')) as ele_yes_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('1', '3') and opti_disk_store_state_cd in ('1', '2', '3')) as ele_no_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and neo_trans_state = '4' and record_neo_trans_state = '4') as neo_trgt_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and neo_trans_state = '4' and record_neo_trans_state = '4' and opti_disk_neo_store_state_cd in ('1', '2', '3', '4', '5')) as neo_choice_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and neo_trans_state = '4' and record_neo_trans_state = '4' and opti_disk_neo_store_state_cd in ('4', '5')) as neo_yes_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and neo_trans_state = '4' and record_neo_trans_state = '4' and opti_disk_neo_store_state_cd in ('1', '2', '3')) as neo_no_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('2', '3') and scan_prog_state_cd = '5') as scan_trgt_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('2', '3') and scan_prog_state_cd = '5' and opti_disk_scn_store_state_cd in ('1', '2', '3', '4', '5')) as scan_choice_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('2', '3') and scan_prog_state_cd = '5' and opti_disk_scn_store_state_cd in ('4', '5')) as scan_yes_cnt,                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('2', '3') and scan_prog_state_cd = '5' and opti_disk_scn_store_state_cd in ('1', '2', '3')) as scan_no_cnt            from    (                      select  distinct creat_yyyy, '1' as record_center_id                      from    tb_rdfolder                      where   record_center_id = '1'                      and     creat_yyyy between '1' and '1'                      and 	  folder_keep_state_cd in ('01', '04')                      order by creat_yyyy desc            ) t        ) C;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstTrgtStatPagedList

		SELECT E.*		FROM (		    SELECT D.*		    FROM (		        SELECT ROWNUM AS rnum		                   ,C.*		        FROM (		            select  t.creat_yyyy, 		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('1', '3')) as ele_trgt_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('1', '3') and opti_disk_store_state_cd in ('1', '2', '3', '4', '5')) as ele_choice_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('1', '3') and opti_disk_store_state_cd in ('4', '5')) as ele_yes_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('1', '3') and opti_disk_store_state_cd in ('1', '2', '3')) as ele_no_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and neo_trans_state = '4' and record_neo_trans_state = '4') as neo_trgt_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and neo_trans_state = '4' and record_neo_trans_state = '4' and opti_disk_neo_store_state_cd in ('1', '2', '3', '4', '5')) as neo_choice_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and neo_trans_state = '4' and record_neo_trans_state = '4' and opti_disk_neo_store_state_cd in ('4', '5')) as neo_yes_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and neo_trans_state = '4' and record_neo_trans_state = '4' and opti_disk_neo_store_state_cd in ('1', '2', '3')) as neo_no_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('2', '3') and scan_prog_state_cd = '5') as scan_trgt_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('2', '3') and scan_prog_state_cd = '5' and opti_disk_scn_store_state_cd in ('1', '2', '3', '4', '5')) as scan_choice_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('2', '3') and scan_prog_state_cd = '5' and opti_disk_scn_store_state_cd in ('4', '5')) as scan_yes_cnt,		                    (select count(*) from tb_rdfolder where record_center_id = t.record_center_id and creat_yyyy = t.creat_yyyy and erecord_flag in ('2', '3') and scan_prog_state_cd = '5' and opti_disk_scn_store_state_cd in ('1', '2', '3')) as scan_no_cnt		            from    (		                      select  distinct creat_yyyy, '1' as record_center_id		                      from    tb_rdfolder		                      where   record_center_id = '1'		                      and     creat_yyyy between '1' and '1'		                      and 	  folder_keep_state_cd in ('01', '04')		                      order by creat_yyyy desc		            ) t		        ) C		        WHERE ROWNUM <= '1'		    ) D		    WHERE D.rnum >= '1'		) E		ORDER BY E.rnum	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : countOptidiskMstPagedList

		SELECT COUNT(1)          FROM    tb_sroptidisk_mst A        WHERE   A.record_center_id = '1'         AND             A.optidisk_yyyy = '1'          AND             A.optidisk_state_cd = '1'          AND             A.optidisk_type_cd = '1'          AND             A.creat_yyyy = '1'         ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstPagedList

		SELECT D.org_cd		      ,D.seq		      ,D.store_size		      ,D.optidisk_size		      ,D.split_tot		      ,D.optidisk_state_cd		      ,D.optidisk_type_cd		      ,D.optidisk_yyyy		      ,D.creat_yyyy		      ,D.presv_term_cd		      ,D.store_plan_ymd		      ,D.optidisk_id		      ,D.schedule_seq, LPAD(D.seq, 6, '0') seq_nm		      ,(CASE WHEN ((select count(*) from tb_sroptidisk_fld where record_center_id = D.record_center_id and org_cd = D.org_cd and seq = D.seq)=0) 		             THEN (select count(*) from tb_sroptihist_fld where record_center_id = D.record_center_id and optidisk_id = D.optidisk_id)		             ELSE (select count(*) from tb_sroptidisk_fld where record_center_id = D.record_center_id and org_cd = D.org_cd and seq = D.seq)		        END) as split_cnt		FROM (		    SELECT C.*		    FROM (		        SELECT ROWNUM AS rnum		                ,B.*		        FROM (		            SELECT A.*  		            FROM    tb_sroptidisk_mst A		            WHERE   A.record_center_id = '1' AND 		                A.optidisk_yyyy = '1'		              AND 		                A.optidisk_state_cd = '1'		              AND 		                A.optidisk_type_cd = '1'		              AND 		                A.creat_yyyy = '1'		             		            ORDER BY A.store_plan_ymd DESC		        ) B		        WHERE ROWNUM <= '1'		    ) C		    WHERE C.rnum >= '1'		) D		ORDER BY D.rnum	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskFldList

 			SELECT record_center_id				  ,optidisk_type_cd				  ,folder_id				  ,store_size				  ,org_cd				  ,seq				  ,creat_yyyy				  ,presv_term_cd				  ,record_cnt			FROM tb_sroptidisk_fld			WHERE record_center_id = '1'			AND org_cd = '1'			AND seq = '1'			 AND 				presv_term_cd = '1'			  AND 				creat_yyyy = '1'			 			ORDER BY to_number(store_size) ASC		 ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskRcdList

 			SELECT	record_center_id				   ,optidisk_type_cd				   ,folder_id				   ,record_id				   ,record_discern				   ,store_size				   ,org_cd				   ,split_seq				   ,seq				   ,file_cnt				   ,'1' as media_div			FROM tb_sroptidisk_rcd			WHERE record_center_id = '1'			AND folder_id = '1'			AND optidisk_type_cd = '1' ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : getOptidiskMstMaxSeq

		SELECT	nvl(MAX(seq), 0)+1 as seq		FROM	tb_sroptidisk_mst		WHERE	record_center_id = '1'		AND		org_cd = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : insert
-- Query Id : createOptidiskMstInfo

		INSERT	INTO	tb_sroptidisk_mst (record_center_id, org_cd, seq, split_tot, optidisk_yyyy, optidisk_type_cd, creat_yyyy, presv_term_cd, booksf_arng_flag, optidisk_state_cd, optidisk_size, store_plan_ymd, split_cnt)		VALUES	('1', '1', '1', '1', '1', '1', '1', '1', '0', '1', '1', to_char(sysdate, 'yyyyMMdd')		     		,(SELECT COUNT(FOLDER_ID)        			FROM TB_SROPTIDISK_FLD        			WHERE RECORD_CENTER_ID = '1'        			AND ORG_CD                   = '1'        			AND CREAT_YYYY              = '1'          			AND PRESV_TERM_CD         = '1'          			AND OPTIDISK_TYPE_CD      = '1'          			AND SEQ                        = 0));


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateOptidiskFldInfo

		UPDATE	tb_sroptidisk_fld		SET		seq = '1'		WHERE	record_center_id = '1'		AND		folder_id = '1'		AND		org_cd = '1'		AND		optidisk_type_cd = '1'		AND		creat_yyyy = '1'		AND		presv_term_cd = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateRdFolderInfo

		UPDATE	tb_rdfolder			 SET   						opti_disk_store_state_cd = '1'						   		WHERE	record_center_id = '1'		AND		folder_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateOptidiskRcdInfo

		UPDATE	tb_sroptidisk_rcd		SET		seq = '1',				split_seq = '1'		WHERE	record_center_id = '1'		AND		folder_id = '1'		AND		record_id = '1'		AND		org_cd = '1'		AND		optidisk_type_cd = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateOptidiskMstStoreSize

		UPDATE	tb_sroptidisk_mst		SET		store_size = (SELECT SUM(store_size) FROM tb_sroptidisk_rcd WHERE record_center_id = '1' AND org_cd = '1' AND seq = '1')		WHERE	record_center_id = '1'		AND		org_cd = '1'		AND		seq = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : countOptidiskMstTrgtPagedList

		SELECT COUNT(1)        FROM    (             SELECT o.record_center_id, o.org_cd, o.presv_term_cd, o.creat_yyyy, count(*) as total, sum(o.store_size) as store_size, o.optidisk_type_cd             FROM tb_sroptidisk_fld o             WHERE o.record_center_id = '1'              AND              	 o.presv_term_cd = '1'               AND                  o.org_cd = '1'                                 	AND    creat_yyyy BETWEEN '1' AND '1'                    AND                  o.optidisk_type_cd = '1'                           GROUP BY o.record_center_id, o.org_cd, o.presv_term_cd, o.creat_yyyy, o.optidisk_type_cd        );


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstTrgtPagedList

		SELECT E.record_center_id		      ,E.org_cd		      ,E.presv_term_cd		      ,E.creat_yyyy		      ,E.total		      ,E.store_size		      ,E.optidisk_type_cd		      ,(select count(*) from tb_sroptidisk_fld where record_center_id = E.record_center_id and org_cd = E.org_cd and presv_term_cd = E.presv_term_cd and creat_yyyy = E.creat_yyyy and optidisk_type_cd = E.optidisk_type_cd and seq > 0) as choice_cnt		      ,(SELECT dept_nm FROM tb_stdept WHERE org_cd = E.org_cd) as org_nm		      ,(SELECT dept_abbr_nm FROM tb_stdept WHERE org_cd = E.org_cd) as org_abbr_nm		      ,(SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD07' AND Z.com_cd = DECODE(E.presv_term_cd, '20', '25', E.presv_term_cd)) presv_term_nm		FROM (		    SELECT D.*		    FROM (		        SELECT ROWNUM AS rnum		              ,C.*		        FROM    (		             SELECT o.record_center_id, o.org_cd, o.presv_term_cd, o.creat_yyyy, count(*) as total, sum(o.store_size) as store_size, o.optidisk_type_cd		             FROM tb_sroptidisk_fld o		             WHERE o.record_center_id = '1'		              AND 		             	 o.presv_term_cd = '1'		               AND 		                 o.org_cd = '1'		                		                 	AND    creat_yyyy BETWEEN '1' AND '1'		                    AND 		                 o.optidisk_type_cd = '1'		              		             GROUP BY o.record_center_id, o.org_cd, o.presv_term_cd, o.creat_yyyy, o.optidisk_type_cd		        ) C		        WHERE ROWNUM <= '1'		    ) D		    WHERE D.rnum >= '1'		) E		ORDER BY E.rnum	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstSplitList

		SELECT	t.org_cd, t.seq, t.split_seq, t.store_size		FROM	(					SELECT 	org_cd, seq, split_seq, sum(to_number(store_size)) as store_size					FROM  	tb_sroptidisk_rcd					WHERE   record_center_id = '1'					AND		org_cd = '1'					AND     seq = '1'					GROUP BY org_cd, seq, split_seq				) t		ORDER by t.split_seq ASC;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateRealOptidiskId

		UPDATE	tb_sroptidisk_mst		SET		optidisk_id = '1'		WHERE	record_center_id = '1'		AND		org_cd = '1'		AND		seq = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateOptidiskMstScheduleSeq

		UPDATE	tb_sroptidisk_mst		SET		schedule_seq = '1',				optidisk_state_cd = '1'				  , 					work_user_id = '1'				   , 					work_req_dtime = '1'				 		WHERE	record_center_id = '1'		AND		org_cd = '1'		AND		seq = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : insert
-- Query Id : createOptidiskFldHist

		INSERT 	INTO tb_sroptihist_fld (			record_center_id, folder_id, optidisk_id, store_size, record_cnt		) VALUES (			'1', '1', '1', '1', '1'		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : delete
-- Query Id : deleteOptidiskFld

		DELETE		FROM	tb_sroptidisk_fld		WHERE	record_center_id = '1'		AND		folder_id = '1'		AND		org_cd = '1'		AND		seq = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : insert
-- Query Id : createOptidiskRcdHist

 		INSERT	INTO tb_sroptihist_rcd (			record_center_id, folder_id, record_id, optidisk_id, record_discern, store_size, split_seq, file_cnt		) VALUES (			'1', '1', '1', '1', '1', '1', '1', '1'		);


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : delete
-- Query Id : deleteOptidiskRcd

		DELETE 		FROM 	tb_sroptidisk_rcd		WHERE 	record_center_id = '1'		AND		record_id = '1'		AND		org_cd = '1'		AND		seq = '1'		AND		split_seq = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstInfo

		SELECT  o.org_cd, o.seq, o.store_size, o.optidisk_size, o.split_tot, o.optidisk_state_cd, o.optidisk_type_cd, o.optidisk_yyyy, o.creat_yyyy, o.presv_term_cd, o.store_plan_ymd,				o.work_req_dtime, o.work_user_id, o.work_end_dtime, o.schedule_seq, o.optidisk_id,				o.disuse_flag, o.disuse_user_id, o.disuse_ymd, o.disuse_yyyy, o.disuse_rsn, 		        (		          CASE		                WHEN (length(o.seq)=1) THEN concat('00000',o.seq)		                WHEN (length(o.seq)=2) THEN concat('0000',o.seq)		                WHEN (length(o.seq)=3) THEN concat('000',o.seq)		                WHEN (length(o.seq)=4) THEN concat('00',o.seq)		                WHEN (length(o.seq)=5) THEN concat('0',o.seq)		                ELSE concat('', o.seq)		          END		        ) as seq_nm,		        (				  CASE				        WHEN ((select count(*) from tb_sroptidisk_fld where record_center_id = o.record_center_id and org_cd = o.org_cd and seq = o.seq)=0) 				          THEN (select count(*) from tb_sroptihist_fld where record_center_id = o.record_center_id and optidisk_id = o.optidisk_id)				        ELSE (select count(*) from tb_sroptidisk_fld where record_center_id = o.record_center_id and org_cd = o.org_cd and seq = o.seq)				  END				) as split_cnt, 		        (SELECT dept_nm FROM tb_stdept WHERE org_cd = o.org_cd) as org_nm,		        (SELECT dept_abbr_nm FROM tb_stdept WHERE org_cd = o.org_cd) as org_abbr_nm,		        (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD07' AND Z.com_cd = o.presv_term_cd) presv_term_nm		FROM    tb_sroptidisk_mst o		WHERE   o.record_center_id = '1' 			AND		o.optidisk_id = '1'		 ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : delete
-- Query Id : deleteOptidiskMstInfo

 			DELETE	FROM  tb_sroptidisk_mst			WHERE	record_center_id = '1'			AND		org_cd = '1'			AND		seq = '1' ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : resetOptidiskFldInfo

		UPDATE	tb_sroptidisk_fld		SET		seq = 0		WHERE	record_center_id = '1'		AND		org_cd = '1'		AND		seq = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskRcdResetList

		SELECT	record_center_id, optidisk_type_cd, folder_id, record_id, record_discern, store_size, org_cd, split_seq, seq, file_cnt		FROM	tb_sroptidisk_rcd		WHERE	record_center_id = '1'		AND		seq = '1'		AND		org_cd = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : resetOptidiskRcdInfo

		UPDATE	tb_sroptidisk_rcd		SET		seq = 0, split_seq = 0		WHERE	record_center_id = '1'		AND		org_cd = '1'		AND		seq = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : countOptidiskMstChkPagedList

		SELECT COUNT(1)        FROM    tb_sroptidisk_mst A        WHERE   A.record_center_id = '1'         AND             A.optidisk_yyyy = '1'          AND             A.optidisk_state_cd = '1'          AND             A.optidisk_type_cd = '1'          AND             A.creat_yyyy = '1'         ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstChkPagedList

		SELECT D.org_cd		      ,D.seq		      ,D.store_size		      ,D.optidisk_size		      ,D.split_tot		      ,D.optidisk_state_cd		      ,D.optidisk_type_cd		      ,D.optidisk_yyyy		      ,D.creat_yyyy		      ,D.presv_term_cd		      ,D.store_plan_ymd		      ,D.optidisk_id		      ,D.schedule_seq		      ,LPAD(D.seq, 6, '0') seq_nm		      ,(CASE WHEN ((select count(*) from tb_sroptidisk_fld where record_center_id = D.record_center_id and org_cd = D.org_cd and seq = D.seq)=0) 		             THEN (select count(*) from tb_sroptihist_fld where record_center_id = D.record_center_id and optidisk_id = D.optidisk_id)		             ELSE (select count(*) from tb_sroptidisk_fld where record_center_id = D.record_center_id and org_cd = D.org_cd and seq = D.seq)		        END) as split_cnt		FROM (		    SELECT C.*		    FROM (		        SELECT ROWNUM AS rnum		              ,B.*		        FROM (		            SELECT * 		            FROM    tb_sroptidisk_mst A		            WHERE   A.record_center_id = '1'		             AND 		                A.optidisk_yyyy = '1'		              AND 		                A.optidisk_state_cd = '1'		              AND 		                A.optidisk_type_cd = '1'		              AND 		                A.creat_yyyy = '1'		             		            ORDER BY A.store_plan_ymd DESC		        ) B		        WHERE ROWNUM <= '1'		    ) C		    WHERE C.rnum >= '1'		) D		ORDER BY D.rnum	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : countOptidiskChkFldPagedList

		 SELECT  COUNT(1)         FROM   tb_sroptihist_fld o, tb_rdfolder f         WHERE  o.record_center_id = '1'         AND     o.optidisk_id = '1'         AND     o.record_center_id = f.record_center_id         AND     o.folder_id = f.folder_id;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskChkFldPagedList

		SELECT C.*		FROM (		    SELECT B.*		    FROM (		        SELECT ROWNUM AS rnum		                ,A.*		        FROM (		            SELECT  o.folder_id, f.title, f.record_center_id, f.creat_sys_cd, f.org_cd, f.clss_id, f.creat_yyyy, f.folder_reg_seq, f.ho_no, o.store_size		                    , (select count(*) 		                      from tb_rdfolder		                      where creat_sys_cd = f.creat_sys_cd		                      and org_cd = f.org_cd		                      and clss_id = f.clss_id		                      and creat_yyyy = f.creat_yyyy		                      and folder_reg_seq = f.folder_reg_seq) as ho_no_cnt                		            FROM   tb_sroptihist_fld o, tb_rdfolder f		            WHERE  o.record_center_id = '1'		            AND     o.optidisk_id = '1'		            AND     o.record_center_id = f.record_center_id		            AND     o.folder_id = f.folder_id		        ) A		        WHERE ROWNUM <= '1'		    ) B		    WHERE B.rnum >= '1'		) C;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskchkFldList

        SELECT  o.folder_id, f.title, f.record_center_id, f.creat_sys_cd, f.org_cd, f.clss_id, f.creat_yyyy, f.folder_reg_seq, f.ho_no, o.store_size                , (select count(*)                   from tb_rdfolder                  where creat_sys_cd = f.creat_sys_cd                  and org_cd = f.org_cd                  and clss_id = f.clss_id                  and creat_yyyy = f.creat_yyyy                  and folder_reg_seq = f.folder_reg_seq) as ho_no_cnt                        FROM   tb_sroptihist_fld o, tb_rdfolder f        WHERE  o.record_center_id = '1'        AND     o.optidisk_id = '1'        AND     o.record_center_id = f.record_center_id        AND     o.folder_id = f.folder_id	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateOptidiskMstChkInfo

		UPDATE TB_SROPTIDISK_MST		SET	CHK_USER_ID = '1',				CHK_YMD = '1',				OPTIDISK_STATE_CD = '1'		WHERE 1 = 1		AND    RECORD_CENTER_ID = '1'		AND    ORG_CD = '1'		AND    SEQ = '1'		AND    OPTIDISK_STATE_CD = '3'  	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : countOptidiskBooksfArangePagedList

		SELECT COUNT(1)        FROM TB_SROPTIDISK_MST A, (SELECT B.record_center_id, B.optidisk_id                                   FROM TB_SROPTIHIST_FLD B, TB_RDFOLDER C                                   WHERE B.record_center_id = C.record_center_id                                   AND B.folder_id = C.folder_id                                    AND                                    		C.DISU_DIV_CD = '1'					     AND                                    		C.LAST_EVAL_YYYY = '1'                                                                       GROUP BY B.record_center_id, B.optidisk_id                                   ) B        WHERE 1 = 1        AND A.record_center_id = B.record_center_id        AND A.optidisk_id = B.optidisk_id        AND A.optidisk_state_cd = '4'        AND A.RECORD_CENTER_ID = '1'        AND A.OPTIDISK_YYYY = '1' AND                  A.OPTIDISK_TYPE_CD = '1'              AND                 A.OPTIDISK_TYPE_CD = '1'              AND                 A.ORG_CD = '1'                                   AND A.CREAT_YYYY BETWEEN '1' AND '1'                   AND                 A.BOOKSF_ARNG_FLAG = '1'              AND                 A.PRESV_TERM_CD = '1'                      ORDER BY A.org_cd, A.seq	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskBooksfArangePagedList

		SELECT E.optidisk_id		      ,E.split_tot		      ,E.creat_yyyy		      ,E.optidisk_yyyy		      ,E.optidisk_type_cd		      ,(SELECT com_cd_nm FROM TB_ZZCOMCD WHERE com_type_cd = 'RD86' AND com_cd = E.optidisk_type_cd) AS optidisk_type_nm		      ,E.org_cd		      ,(SELECT org_nm FROM TB_STORG WHERE record_center_id = E.record_center_id AND org_cd = E.org_cd) AS org_nm		      ,(SELECT org_abbr_nm FROM TB_STORG WHERE record_center_id = E.record_center_id AND org_cd = E.org_cd) AS org_abbr_nm		      ,E.presv_term_cd		      ,(SELECT com_cd_nm FROM TB_ZZCOMCD WHERE com_type_cd = 'RD07' AND com_cd = DECODE(E.presv_term_cd, '20', '25', E.presv_term_cd)) AS presv_term_nm		      ,(SELECT count(folder_id) FROM TB_SROPTIHIST_FLD WHERE record_center_id = E.record_center_id AND optidisk_id = E.optidisk_id) AS split_cnt		      ,E.optidisk_stakrm_id || '-' || E.optidisk_booksf_id || '-' || LPAD(E.floor_no, 3, '0') || '-' || LPAD(E.col_no, 3, '0') AS booksf_location		      ,E.booksf_arng_flag		      ,(SELECT com_cd_nm FROM TB_ZZCOMCD WHERE com_type_cd = 'RD45' AND com_cd = E.booksf_arng_flag) AS booksf_arng_flag_nm		      ,(CASE WHEN (SELECT count(f.disu_div_cd) 		                   FROM TB_SROPTIHIST_FLD E, TB_RDFOLDER f 		                   WHERE E.record_center_id = f.record_center_id 		                   AND E.folder_id = f.folder_id 		                   AND E.record_center_id = E.record_center_id 		                   AND E.optidisk_id = E.optidisk_id) > 0 		             THEN '¿Á√•¡§' 		             ELSE ''		        END) AS disu_div_cd_nm		FROM (		    SELECT D.*		    FROM (		        SELECT ROWNUM AS rnum		              ,C.*		        FROM (		            SELECT A.*		            FROM TB_SROPTIDISK_MST A, (SELECT B.record_center_id, B.optidisk_id		                                       FROM TB_SROPTIHIST_FLD B, TB_RDFOLDER C		                                       WHERE B.record_center_id = C.record_center_id		                                       AND B.folder_id = C.folder_id		                                        AND 		                                       		C.DISU_DIV_CD = '1'											     AND 		                                       		C.LAST_EVAL_YYYY = '1'		                                        		                                       GROUP BY B.record_center_id, B.optidisk_id		                                       ) B		            WHERE 1 = 1		            AND A.record_center_id = B.record_center_id		            AND A.optidisk_id = B.optidisk_id		            AND A.optidisk_state_cd = '4'		            AND A.RECORD_CENTER_ID = '1'		            AND A.OPTIDISK_YYYY = '1' AND  		                    A.OPTIDISK_TYPE_CD = '1'		                  AND 		                    A.OPTIDISK_TYPE_CD = '1'		                  AND 		                    A.ORG_CD = '1'		                   		                        AND A.CREAT_YYYY BETWEEN '1' AND '1'		                       AND 		                    A.BOOKSF_ARNG_FLAG = '1'		                  AND 		                    A.PRESV_TERM_CD = '1'		                  		            ORDER BY A.org_cd, A.seq		        ) C		        WHERE ROWNUM <= '1'		    ) D		    WHERE D.rnum >= '1'		) E		ORDER BY E.rnum	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskBooksfIdList

		SELECT OPTIDISK_STAKRM_ID, OPTIDISK_BOOKSF_ID, OPTIDISK_BOOKSF_NM, SHELF_C_CNT, SHELF_R_CNT 		FROM TB_SROPTIDISK_BOOKSF		WHERE RECORD_CENTER_ID = '1'		AND OPTIDISK_STAKRM_ID = '1' AND 			OPTIDISK_BOOKSF_ID = '1'		 		ORDER BY OPTIDISK_STAKRM_ID, OPTIDISK_BOOKSF_ID	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateOptidiskBooksfArng

		UPDATE TB_SROPTIDISK_MST A	    SET  A.OPTIDISK_STAKRM_ID = '1'	     	,A.OPTIDISK_BOOKSF_ID = '1'	     	,A.FLOOR_NO = '1'	     	,A.COL_NO = '1'	     	,A.BOOKSF_ARNG_FLAG = '1'	 	WHERE A.RECORD_CENTER_ID = '1'	   	AND A.OPTIDISK_ID = '1'	   	AND A.OPTIDISK_STATE_CD = '4'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : countOptidiskMstBooksf

	    SELECT COUNT(1)	    FROM     TB_SROPTIDISK_STAKRM A, TB_SROPTIDISK_BOOKSF B	    WHERE A.RECORD_CENTER_ID = '1'	    AND A.RECORD_CENTER_ID = B.RECORD_CENTER_ID 	    AND A.OPTIDISK_STAKRM_ID = B.OPTIDISK_STAKRM_ID 	    ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstBooksf

		SELECT E.optidisk_stakrm_id		      ,E.optidisk_stakrm_nm		      ,E.optidisk_booksf_id		      ,E.optidisk_booksf_nm		      ,E.shelf_c_cnt		      ,E.shelf_r_cnt		      ,E.max_arng_disk_cnt		      ,( SELECT SUM(split_tot) FROM TB_SROPTIDISK_MST WHERE record_center_id = E.record_center_id AND optidisk_stakrm_id = E.optidisk_stakrm_id AND optidisk_booksf_id = E.optidisk_booksf_id) AS cur_arng_disk_cnt		      ,E.remk AS optidisk_booksf_remk		FROM (		    SELECT D.*		    FROM (		        SELECT ROWNUM AS rnum		              ,C.*		        FROM (		            SELECT A.record_center_id, A.optidisk_stakrm_id,A.optidisk_stakrm_nm,B.optidisk_booksf_id,B.optidisk_booksf_nm		                  ,B.shelf_c_cnt,B.shelf_r_cnt,B.max_arng_disk_cnt, B.remk		            FROM     TB_SROPTIDISK_STAKRM A, TB_SROPTIDISK_BOOKSF B		            WHERE A.RECORD_CENTER_ID = '1'		            AND A.RECORD_CENTER_ID = B.RECORD_CENTER_ID(+) 		            AND A.OPTIDISK_STAKRM_ID = B.OPTIDISK_STAKRM_ID(+) 		            		            ORDER BY A.record_center_id, A.optidisk_stakrm_id, B.optidisk_booksf_id		        ) C		        WHERE ROWNUM <= '1'		    ) D		    WHERE D.rnum >= '1'		) E		ORDER BY E.rnum	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : countOptidiskMstStakrm

		SELECT COUNT(1)        FROM TB_SROPTIDISK_STAKRM          WHERE RECORD_CENTER_ID = '1'         ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstStakrm

		SELECT D.optidisk_stakrm_id		      ,D.optidisk_stakrm_nm		      ,D.booksf_cnt		      ,D.remk AS stakrm_remk		FROM (		    SELECT C.*		    FROM (		        SELECT ROWNUM AS rnum		              ,B.*		        FROM (		            SELECT *		            FROM TB_SROPTIDISK_STAKRM  		            WHERE RECORD_CENTER_ID = '1' 		            		            ORDER BY OPTIDISK_STAKRM_ID DESC		        ) B		        WHERE ROWNUM <= '1'		    ) C		    WHERE C.rnum >= '1'		) D		ORDER BY D.rnum	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findMaxOptidiskStakrmId

		SELECT MAX(OPTIDISK_STAKRM_ID) AS OPTIDISK_STAKRM_ID		FROM TB_SROPTIDISK_STAKRM		WHERE RECORD_CENTER_ID = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : insert
-- Query Id : createOptidiskStakrm

		INSERT INTO TB_SROPTIDISK_STAKRM (		    RECORD_CENTER_ID, OPTIDISK_STAKRM_ID, OPTIDISK_STAKRM_NM, BOOKSF_CNT, REMK		) VALUES (		    '1', '1', '1', '1', '1'		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateOptidiskStakrm

		UPDATE TB_SROPTIDISK_STAKRM		SET  OPTIDISK_STAKRM_NM = '1'			,REMK = '1'		WHERE RECORD_CENTER_ID = '1'		AND OPTIDISK_STAKRM_ID = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : delete
-- Query Id : deleteOptidiskStakrm

		DELETE FROM TB_SROPTIDISK_STAKRM		WHERE RECORD_CENTER_ID = '1'		AND OPTIDISK_STAKRM_ID = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskStakrmIdList

		SELECT 	OPTIDISK_STAKRM_ID AS OPTIDISK_STAKRM_ID, 	   		   	OPTIDISK_STAKRM_NM AS OPTIDISK_STAKRM_NM, 	   			NVL(BOOKSF_CNT,'0') AS OPTIDISK_BOOKSF_CNT,	   			REMK AS OPTIDISK_STAKRM_REMK 	   	  FROM  TB_SROPTIDISK_STAKRM  	   	 WHERE  RECORD_CENTER_ID = '1' 		ORDER BY OPTIDISK_STAKRM_ID ASC 	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findMaxOptidiskStakrmBooksfId

		SELECT MAX(OPTIDISK_BOOKSF_ID)		FROM TB_SROPTIDISK_BOOKSF		WHERE RECORD_CENTER_ID = '1'		AND OPTIDISK_STAKRM_ID = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : insert
-- Query Id : createOptidiskBooksf

		INSERT INTO TB_SROPTIDISK_BOOKSF (			RECORD_CENTER_ID, OPTIDISK_BOOKSF_ID, OPTIDISK_BOOKSF_NM, OPTIDISK_STAKRM_ID, OPTIDISK_STAKRM_SNO, 	  		   	SHELF_C_CNT, SHELF_R_CNT, MAX_ARNG_DISK_CNT, CUR_ARNG_DISK_CNT, REMK		) VALUES (			'1', '1', '1', '1'		   ,(SELECT (COUNT(OPTIDISK_BOOKSF_ID)+1) AS STAKRMSEQ FROM TB_SROPTIDISK_BOOKSF WHERE OPTIDISK_STAKRM_ID='1')	  	   ,'1', '1', '1', '1', '1')	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : addOptidiskMstBooksfCnt

	  	UPDATE TB_SROPTIDISK_STAKRM 	  	SET BOOKSF_CNT=(SELECT COUNT(OPTIDISK_STAKRM_ID) FROM TB_SROPTIDISK_BOOKSF WHERE OPTIDISK_STAKRM_ID='1')	  	     		WHERE RECORD_CENTER_ID = '1'		AND   OPTIDISK_STAKRM_ID = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : updateOptidiskBooksf

		UPDATE TB_SROPTIDISK_BOOKSF 		SET OPTIDISK_BOOKSF_NM = '1' 	  	   	 , REMK	= '1' 	  	   	 , SHELF_C_CNT = '1' 	  	   	 , SHELF_R_CNT = '1' 	  	   	 , MAX_ARNG_DISK_CNT = '1'  	 	WHERE RECORD_CENTER_ID = '1' 	   	AND OPTIDISK_STAKRM_ID = '1'	 	   	AND OPTIDISK_BOOKSF_ID = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : delete
-- Query Id : deleteOptidiskMstStakrmBooksf

		DELETE FROM TB_SROPTIDISK_BOOKSF		WHERE RECORD_CENTER_ID = '1'		AND OPTIDISK_STAKRM_ID = '1'		AND OPTIDISK_BOOKSF_ID = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : update
-- Query Id : minOptidiskMstBooksfCnt

	  	UPDATE TB_SROPTIDISK_STAKRM 	  	SET BOOKSF_CNT=(SELECT NVL(COUNT(OPTIDISK_STAKRM_ID), 0) FROM TB_SROPTIDISK_BOOKSF WHERE OPTIDISK_STAKRM_ID='1')	  	     		WHERE RECORD_CENTER_ID = '1'		AND   OPTIDISK_STAKRM_ID = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptidiskMstStakrmCount

		SELECT 	COUNT(OPTIDISK_STAKRM_ID) 		FROM TB_SROPTIDISK_STAKRM  			WHERE RECORD_CENTER_ID = '1' 		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptiDiskStoreList

		SELECT OPTIDISK_YYYY			  ,NVL(SUM(A_CNT), 0) A_CNT			  ,NVL(SUM(A_SCNT), 0) A_SCNT			  ,NVL(SUM(A_FCNT), 0) A_FCNT			  ,NVL(SUM(A_STSIZE), 0) A_STSIZE			  ,NVL(SUM(B_CNT), 0) B_CNT			  ,NVL(SUM(B_SCNT), 0) B_SCNT			  ,NVL(SUM(B_FCNT), 0) B_FCNT			  ,NVL(SUM(B_STSIZE), 0) B_STSIZE			  ,NVL(SUM(C_CNT), 0) C_CNT			  ,NVL(SUM(C_SCNT), 0) C_SCNT			  ,NVL(SUM(C_FCNT), 0) C_FCNT			  ,NVL(SUM(C_STSIZE), 0) C_STSIZE        FROM (                SELECT T.OPTIDISK_YYYY                	  ,(SELECT COUNT(1) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '1') A_CNT                	  ,(SELECT SUM(SPLIT_TOT) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '1') A_SCNT                	  ,(SELECT COUNT(FOLDER_ID) FROM TB_SROPTIHIST_FLD WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND OPTIDISK_ID = T.OPTIDISK_ID AND T.OPTIDISK_TYPE_CD = '1') AS A_FCNT	                    	  ,(SELECT SUM(STORE_SIZE) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '1') A_STSIZE                	  ,(SELECT COUNT(1) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '2') B_CNT                	  ,(SELECT SUM(SPLIT_TOT) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '2') B_SCNT                	  ,(SELECT COUNT(FOLDER_ID) FROM TB_SROPTIHIST_FLD WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND OPTIDISK_ID = T.OPTIDISK_ID AND T.OPTIDISK_TYPE_CD = '2') AS B_FCNT	                    	  ,(SELECT SUM(STORE_SIZE) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '2') B_STSIZE                	  ,(SELECT COUNT(1) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '3') C_CNT                	  ,(SELECT SUM(SPLIT_TOT) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '3') C_SCNT                	  ,(SELECT COUNT(FOLDER_ID) FROM TB_SROPTIHIST_FLD WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND OPTIDISK_ID = T.OPTIDISK_ID AND T.OPTIDISK_TYPE_CD = '3') AS C_FCNT	                    	  ,(SELECT SUM(STORE_SIZE) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '3') C_STSIZE                      FROM (                    SELECT RECORD_CENTER_ID, ORG_CD, SEQ,  SPLIT_TOT, OPTIDISK_YYYY, OPTIDISK_TYPE_CD, STORE_SIZE, OPTIDISK_ID                             FROM TB_SROPTIDISK_MST                                                 WHERE OPTIDISK_STATE_CD = '4'                    AND RECORD_CENTER_ID = '1'                                        AND OPTIDISK_YYYY BETWEEN '1' AND '1'                                        ) T                )        GROUP BY OPTIDISK_YYYY	 	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
-- Query    : select
-- Query Id : findOptiDiskStoreCheckList

		SELECT CHECK_YMD			  ,NVL(SUM(A_CHK_CNT), 0) A_CHK_CNT			  ,NVL(SUM(A_NRMLT_CNT), 0) A_NRMLT_CNT			  ,NVL(SUM(A_LOS_CNT), 0) A_LOS_CNT			  ,NVL(SUM(A_DAMAGE_CNT), 0) A_DAMAGE_CNT			  ,NVL(SUM(A_ETC_CNT), 0) A_ETC_CNT			  ,NVL(SUM(B_CHK_CNT), 0) B_CHK_CNT			  ,NVL(SUM(B_NRMLT_CNT), 0) B_NRMLT_CNT			  ,NVL(SUM(B_LOS_CNT), 0) B_LOS_CNT			  ,NVL(SUM(B_DAMAGE_CNT), 0) B_DAMAGE_CNT			  ,NVL(SUM(B_ETC_CNT), 0) B_ETC_CNT			  ,NVL(SUM(C_CHK_CNT), 0) C_CHK_CNT			  ,NVL(SUM(C_NRMLT_CNT), 0) C_NRMLT_CNT			  ,NVL(SUM(C_LOS_CNT), 0) C_LOS_CNT			  ,NVL(SUM(C_DAMAGE_CNT), 0) C_DAMAGE_CNT			  ,NVL(SUM(C_ETC_CNT), 0) C_ETC_CNT		FROM (        		        SELECT CHECK_YMD		        	  ,(SELECT COUNT(1) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '1') A_CHK_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '1' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '1') A_NRMLT_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '2' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '1') A_LOS_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '3' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '1') A_DAMAGE_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '4' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '1') A_ETC_CNT		        	  ,(SELECT COUNT(1) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '2') B_CHK_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '1' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '2') B_NRMLT_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '2' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '2') B_LOS_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '3' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '2') B_DAMAGE_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '4' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '2') B_ETC_CNT		        	  ,(SELECT COUNT(1) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '3') C_CHK_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '1' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '3') C_NRMLT_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '2' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '3') C_LOS_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '3' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '3') C_DAMAGE_CNT		        	  ,(SELECT SUM(CASE WHEN CNTCHK_RSLT_CD = '4' THEN 1 ELSE 0 END) FROM TB_SROPTIDISK_MST WHERE RECORD_CENTER_ID = T.RECORD_CENTER_ID AND ORG_CD = T.ORG_CD AND SEQ = T.SEQ AND OPTIDISK_TYPE_CD = '3') C_ETC_CNT		        FROM (		                SELECT A.RECORD_CENTER_ID, A.ORG_CD, A.SEQ, SUBSTR(B.CHECK_YMD, 0, 4) CHECK_YMD, B.CNTCHK_RSLT_CD         		                FROM TB_SROPTIDISK_MST A,		                        TB_SROPTIDISK_CNTCHKDETL B		                WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID		                AND A.ORG_CD = B.ORG_CD		                AND A.SEQ = B.SEQ		                AND A.RECORD_CENTER_ID = '1'		                AND A.OPTIDISK_STATE_CD = '4'		                AND SUBSTR(B.CHECK_YMD, 0, 4) BETWEEN '1' AND '1'		                ) T    		    )	    GROUP BY CHECK_YMD  		 	;


-- File Close : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\presv\optidiskmst\OptidiskMst.xml
