-- File Open : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
-- Query    : select
-- Query Id : findDisuseTrgtPagedList

		SELECT D.*		FROM (			SELECT ROWNUM AS rnum				, C.*			FROM (				SELECT B.CREAT_YYYY					, COUNT(A.FOLDER_ID) AS TOT_CNT				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '01' THEN 1 ELSE 0 END) AS PRESV_A_01				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '01' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_01				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '03' THEN 1 ELSE 0 END) AS PRESV_A_03				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '03' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_03				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '05' THEN 1 ELSE 0 END) AS PRESV_A_05				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '05' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_05				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '10' THEN 1 ELSE 0 END) AS PRESV_A_10				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '10' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_10				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '25' THEN 1 ELSE 0 END) AS PRESV_A_30				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '25' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_30				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD NOT IN ('01','03','05','10','25') THEN 1 ELSE 0 END) AS PRESV_ETC				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '1' THEN 1 ELSE 0 END) AS REQ_A				    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '1' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS REQ_B				FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B  				WHERE A.RECORD_CENTER_ID = '1'				AND A.DISCU_YYYY = '1' AND  				   		B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')				   	  				AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID				AND B.FOLDER_ID = A.FOLDER_ID				GROUP BY B.CREAT_YYYY				ORDER BY B.CREAT_YYYY			) C			WHERE ROWNUM <= '1'		) D		WHERE D.rnum >= '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
-- Query    : select
-- Query Id : countDisuseTrgtPagedList

		SELECT COUNT(*)		FROM (			SELECT B.CREAT_YYYY			FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B  			WHERE A.RECORD_CENTER_ID = '1'			AND A.DISCU_YYYY = '1' AND  					B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')				  			AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID			AND B.FOLDER_ID = A.FOLDER_ID			GROUP BY B.CREAT_YYYY		) C;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
-- Query    : select
-- Query Id : findDisuseTrgtListExcel

		SELECT B.CREAT_YYYY     		, B.FOLDER_ID		    , B.TITLE		    , ( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD ) AS ORG_NM		    , A.CUR_PRESV_TERM_CD		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM		    , A.DISCU_REQ_FLAG		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM		    , A.DISCU_ORIGN_TYPE_CD		    , (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF13' AND COM_CD = A.DISCU_ORIGN_TYPE_CD) AS DISCU_ORIGN_TYPE_NM		FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B   		WHERE A.RECORD_CENTER_ID = '1'   		AND A.DISCU_YYYY = '1'   		AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID   		AND B.FOLDER_ID = A.FOLDER_ID 		ORDER BY B.CREAT_YYYY, B.FOLDER_ID;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
-- Query    : select
-- Query Id : findDisuseTrgtDetailList

		SELECT MAX(( SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD )) AS ORG_NM		    , COUNT(A.FOLDER_ID) AS TOT_CNT		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '01' THEN 1 ELSE 0 END) AS PRESV_A_01		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '01' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_01		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '03' THEN 1 ELSE 0 END) AS PRESV_A_03		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '03' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_03		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '05' THEN 1 ELSE 0 END) AS PRESV_A_05		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '05' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_05		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '10' THEN 1 ELSE 0 END) AS PRESV_A_10		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '10' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_10		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '25' THEN 1 ELSE 0 END) AS PRESV_A_30		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD = '25' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS PRESV_B_30		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '0' AND B.PRESV_TERM_CD NOT IN ('01','03','05','10') THEN 1 ELSE 0 END) AS PRESV_ETC		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '1' THEN 1 ELSE 0 END) AS REQ_A		    , SUM(CASE WHEN A.DISCU_REQ_FLAG = '1' AND A.DISCU_PROG_STATE_CD > '01' THEN 1 ELSE 0 END) AS REQ_B     		FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B  		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1' AND  		   		B.PRESV_TERM_CD in ('01', '03', '05', '10', '25')		   	  		AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID		AND B.FOLDER_ID = A.FOLDER_ID		AND B.CREAT_YYYY = '1'		GROUP BY B.CREAT_YYYY, B.ORG_CD		ORDER BY B.CREAT_YYYY, B.ORG_CD 	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
-- Query    : select
-- Query Id : countDisuseTrgtDetailFolder

		SELECT COUNT(*)		FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B   		WHERE A.RECORD_CENTER_ID = '1' 		AND A.DISCU_YYYY = '1'   		AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID   		AND B.FOLDER_ID = A.FOLDER_ID   		AND B.CREAT_YYYY = '1' 	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
-- Query    : select
-- Query Id : countDisuseTrgtChoiseScheduleFlag

		SELECT COUNT(*)  		FROM TB_DFDISUSEOPIN A 		WHERE A.RECORD_CENTER_ID = '1'   		AND A.DISCU_YYYY = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
-- Query    : select
-- Query Id : countDisuseProcessCount

		SELECT COUNT(*)		FROM TB_DFDISUSEOPIN A		WHERE A.RECORD_CENTER_ID = '1'		AND A.DISCU_YYYY = '1'		AND A.DISCU_PROG_STATE_CD != '01'		AND A.SCHEDULE_SEQ = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
-- Query    : delete
-- Query Id : deleteDisuseData

		DELETE FROM TB_DFDISUSEOPIN		WHERE record_center_id = '1'		AND	DISCU_YYYY = '1'		AND DISCU_PROG_STATE_CD = '01'		AND	SCHEDULE_SEQ = '1'	;


-- File Close : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseTrgtState.xml
