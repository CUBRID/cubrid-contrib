-- File Open : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\srch\srch\OrgTakeTrgtSrch.xml


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\srch\srch\OrgTakeTrgtSrch.xml
-- Query    : select
-- Query Id : countDetailsTakeFolderPagedList

		SELECT COUNT(1)		FROM   TB_RDFOLDER A		WHERE  A.RECORD_CENTER_ID = '1'		AND    (A.FOLDER_KEEP_STATE_CD ='04' OR A.VRMS_FLAG='1');


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\srch\srch\OrgTakeTrgtSrch.xml
-- Query    : select
-- Query Id : findDetailsTakeFolderPagedList

		SELECT E.ORG_CD			, E.FOLDER_ID			, E.TITLE			, E.CREAT_YYYY			, (SELECT O.ORG_NM FROM TB_STORG O WHERE O.RECORD_CENTER_ID=E.RECORD_CENTER_ID AND O.ORG_CD=E.ORG_CD) ORG_NM			, (SELECT O.ORG_ABBR_NM FROM TB_STORG O WHERE O.RECORD_CENTER_ID=E.RECORD_CENTER_ID AND O.ORG_CD=E.ORG_CD) ORG_ABBR_NM			, (SELECT Z.COM_CD_NM FROM TB_ZZCOMCD Z WHERE Z.COM_TYPE_CD='RD07' AND Z.COM_CD=E.PRESV_TERM_CD) PRESV_TERM_NM			, (SELECT Z.COM_CD_NM FROM TB_ZZCOMCD Z WHERE Z.COM_TYPE_CD='RD17' AND Z.COM_CD=E.CREAT_SYS_CD) CREAT_SYS_NM			, (SELECT Z.COM_CD_NM FROM TB_ZZCOMCD Z WHERE Z.COM_TYPE_CD='RD23' AND Z.COM_CD=E.ERECORD_FLAG) ERECORD_FLAG_NM			, (SELECT B.AGENT_NM				FROM TB_RDFOLDERCREAT B				WHERE B.RECORD_CENTER_ID=E.RECORD_CENTER_ID AND B.AGENT_TYPE_CD='19' 		  		AND   B.FOLDER_ID = E.FOLDER_ID 		  		AND   B.AGENT_SNO = (SELECT MAX(Z.AGENT_SNO) FROM TB_RDFOLDERCREAT Z WHERE Z.FOLDER_ID=E.FOLDER_ID)) AGENT_NM			, (SELECT Z.COM_CD_NM FROM TB_ZZCOMCD Z WHERE Z.COM_TYPE_CD = 'RD32' AND Z.COM_CD = E.FOLDER_KEEP_STATE_CD) FOLDER_KEEP_STATE_NM			, E.CREAT_SYS_CD			, E.OPER_READ_RANGE_CD			, (CASE WHEN '3'='1' AND E.record_center_id = (SELECT Z.record_center_id FROM TB_STUSER Z WHERE Z.USER_ID = '1') THEN 1					WHEN E.oper_read_range_cd='01' THEN 1					 					WHEN (E.oper_read_range_cd='02' AND E.cur_keep_org_cd='1') THEN 1					 					WHEN (SELECT COUNT(1) FROM TB_RDFOLDERACCS Z WHERE Z.record_center_id=E.record_center_id AND Z.folder_id=E.folder_id AND Z.accs_type_cd='2' AND Z.accs_dept_cd='1') > 0 THEN 1 					WHEN (SELECT COUNT(1) FROM TB_RDFOLDERACCS Z WHERE Z.record_center_id=E.record_center_id AND Z.folder_id=E.folder_id AND Z.accs_type_cd='1' AND Z.accs_user_id='1') > 0 THEN 1					ELSE 0				END) accs_flag		FROM (			SELECT D.*			FROM (				SELECT ROWNUM AS rnum					, C.*				FROM (					SELECT A.RECORD_CENTER_ID						, A.FOLDER_ID						, A.ORG_CD						, A.CLSS_DIV_CD						, A.CLSS_ID						, A.CLSS_NM						, A.NEW_CLSS_ID						, A.NEW_CLSS_NM						, A.TITLE						, A.CREAT_YYYY						, A.PRESV_TERM_CD						, A.CREAT_SYS_CD						, A.ERECORD_FLAG						, A.FOLDER_KEEP_STATE_CD						, A.OPER_READ_RANGE_CD						, A.CUR_KEEP_ORG_CD					FROM   TB_RDFOLDER A					WHERE  A.RECORD_CENTER_ID = '1'					AND    (A.FOLDER_KEEP_STATE_CD ='04' OR A.VRMS_FLAG='1')					ORDER BY A.RECORD_CENTER_ID, A.TITLE				) C				WHERE ROWNUM <= '1'			) D			WHERE D.rnum >= '1'		) E		ORDER BY E.rnum	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\srch\srch\OrgTakeTrgtSrch.xml
-- Query    : select
-- Query Id : countDetailsTakeRecordPagedList

		SELECT COUNT(1)		FROM   TB_RDRECORD A,			   TB_STORG B,			   TB_RDFOLDER D		WHERE  A.RECORD_CENTER_ID = '1' 		AND    A.RECORD_CENTER_ID = B.RECORD_CENTER_ID(+)		AND    A.ORG_CD = B.ORG_CD(+)				AND    A.RECORD_CENTER_ID = D.RECORD_CENTER_ID				AND    A.FOLDER_ID = D.FOLDER_ID		AND   (D.FOLDER_KEEP_STATE_CD ='04' OR D.VRMS_FLAG ='1') 		;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\srch\srch\OrgTakeTrgtSrch.xml
-- Query    : select
-- Query Id : findDetailsTakeRecordPagedList

		SELECT E.*		FROM (			SELECT ROWNUM AS rnum				, C.*			FROM (				SELECT A.ORG_CD FOLDER_ORG_CD					, B.ORG_CD RECORD_ORG_CD					, A.FOLDER_ID					, A.RECORD_ID					, D.TITLE FOLDER_TITLE					, A.TITLE					, B.ORG_NM					, B.ORG_ABBR_NM					, SUBSTR(CREAT_REG_DTIME,0,8) CREAT_REG_DTIME					, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD03' AND	TB_ZZCOMCD.COM_CD = A.RECORD_DETL_TYPE_CD) RECORD_DETL_TYPE_NM					, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD05' AND	TB_ZZCOMCD.COM_CD = A.OPEN_DIV_CD) OPEN_DIV_NM					, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD23' AND	TB_ZZCOMCD.COM_CD = A.ERECORD_FLAG) ERECORD_FLAG_NM					, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD17' AND	TB_ZZCOMCD.COM_CD = A.CREAT_SYS_CD) CREAT_SYS_NM					, (DECODE(SUBSTR(SPCL_RECORD_TYPE,1,1),'N','','Y',(SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD18' AND COM_CD='1'))			   		  ||DECODE(SUBSTR(SPCL_RECORD_TYPE,2,1),'N','','Y',(SELECT ','||COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD18' AND COM_CD='2'))			   		  ||DECODE(SUBSTR(SPCL_RECORD_TYPE,3,1),'N','','Y',(SELECT ','||COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD18' AND COM_CD='3'))					  ||DECODE(SUBSTR(SPCL_RECORD_TYPE,4,1),'N','','Y',(SELECT ','||COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD18' AND COM_CD='4'))					  ||DECODE(SUBSTR(SPCL_RECORD_TYPE,5,1),'N','','Y',(SELECT ','||COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD18' AND COM_CD='5'))) SPCL_RECORD_TYPE_NM					, A.SCAN_FIN_FLAG					, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD32' AND	TB_ZZCOMCD.COM_CD = D.FOLDER_KEEP_STATE_CD) FOLDER_KEEP_STATE_NM					, A.CREAT_SYS_CD					, D.SCAN_PROG_STATE_CD					, A.OPER_READ_RANGE_CD					, D.OPER_READ_RANGE_CD FOLDER_READ_RANGE_CD				    , (CASE WHEN '3'='1' AND D.record_center_id = (SELECT Z.record_center_id FROM TB_STUSER Z WHERE Z.USER_ID = '1') THEN 1							WHEN D.oper_read_range_cd='01' THEN 1							 								WHEN (D.oper_read_range_cd='02' AND D.cur_keep_org_cd='1') THEN 1							 				            WHEN (SELECT COUNT(1) FROM TB_RDFOLDERACCS Z WHERE Z.record_center_id=D.record_center_id AND Z.folder_id=D.folder_id AND Z.accs_type_cd='2' AND Z.accs_dept_cd='1') > 0 THEN 1 				            WHEN (SELECT COUNT(1) FROM TB_RDFOLDERACCS Z WHERE Z.record_center_id=D.record_center_id AND Z.folder_id=D.folder_id AND Z.accs_type_cd='1' AND Z.accs_user_id='1') > 0 THEN 1				            ELSE 0				       END) folder_accs_flag					, (CASE WHEN '3'='1' AND A.record_center_id = (SELECT Z.record_center_id FROM TB_STUSER Z WHERE Z.USER_ID = '1') THEN 1							WHEN A.oper_read_range_cd='01' THEN 1 								WHEN (A.oper_read_range_cd='02' AND '1' = (SELECT B.CUR_KEEP_ORG_CD FROM TB_RDFOLDER B WHERE B.folder_id=A.folder_id)) THEN 1							 				            WHEN (SELECT COUNT(1) FROM TB_RDRECORDACCS Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.accs_type_cd='2' AND Z.accs_dept_cd='1') > 0 THEN 1 				            WHEN (SELECT COUNT(1) FROM TB_RDRECORDACCS Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.accs_type_cd='1' AND Z.accs_user_id='1') > 0 THEN 1				            ELSE 0				       END) accs_flag				FROM TB_RDRECORD A, TB_STORG B, TB_RDFOLDER D				WHERE  A.RECORD_CENTER_ID = '1'		 		AND    A.RECORD_CENTER_ID = B.RECORD_CENTER_ID(+)				AND    A.ORG_CD = B.ORG_CD(+)						AND    A.RECORD_CENTER_ID = D.RECORD_CENTER_ID						AND    A.FOLDER_ID = D.FOLDER_ID				AND   (D.FOLDER_KEEP_STATE_CD ='04' OR D.VRMS_FLAG ='1') 										ORDER BY RECORD_ID DESC			) C			WHERE ROWNUM <= '1'		) E		WHERE E.rnum >= '1'	;


-- File Close : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\srch\srch\OrgTakeTrgtSrch.xml
