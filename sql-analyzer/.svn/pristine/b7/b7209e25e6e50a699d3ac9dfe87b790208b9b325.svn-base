<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="transf.offer">
    
    <resultMap id="creatStateApprList-result" class="rms.transf.offer.domain.StateAppr" >
		<result property="recordCenterId" 		column="record_center_id"/>						
		<result property="crReportOrgCd" 		column="cr_report_org_cd"/>
		<result property="orgNm" 						column="org_nm"/>
		<result property="orgAbbrNm" 				column="org_abbr_nm"/>	
		<result property="stateDivCd" 				column="state_div_cd"/>		
		<result property="sysInfrmState01" 		column="sys_infrm_state01"/>
		<result property="sysFolderCnt01" 		column="sys_folderCnt01"/>
		<result property="sysRecordCnt01" 		column="sys_recordCnt01"/>
		<result property="sysInfrmState02" 		column="sys_infrm_state02"/>
		<result property="sysFolderCnt02" 		column="sys_folderCnt02"/>
		<result property="sysRecordCnt02" 		column="sys_recordCnt02"/>
		<result property="sysInfrmState03" 		column="sys_infrm_state03"/>
		<result property="sysFolderCnt03" 		column="sys_folderCnt03"/>
		<result property="sysRecordCnt03" 		column="sys_recordCnt03"/>
		<result property="sysInfrmState04" 		column="sys_infrm_state04"/>
		<result property="sysFolderCnt04" 		column="sys_folderCnt04"/>
		<result property="sysRecordCnt04" 		column="sys_recordCnt04"/>
		<result property="totFolderCnt" 				column="tot_folderCnt"/>
		<result property="totRecordCnt" 			column="tot_recordCnt"/>
		<result property="recordCenterNm" 		column="record_center_nm"/>
	</resultMap>
	
       
    <resultMap id="findCreatStateApprRecvInfo-result" class="rms.transf.offer.domain.StateApprInfo" >
		<result property="recordCenterId" 				column="record_center_id"/>						
		<result property="crReportOrgCd" 				column="cr_report_org_cd"/>
		<result property="crReportSno" 					column="cr_report_sno"/>
		<result property="crReportYyyy" 					column="cr_report_yyyy"/>
		<result property="stateDivCd" 						column="state_div_cd"/>	
		<result property="recvYmd" 							column="recv_ymd"/>
		<result property="stateDivCdNm" 					column="state_div_cd_nm"/>
		<result property="recvFolderCnt" 					column="recv_folder_cnt"/>
		<result property="recvRecordCnt" 				column="recv_record_cnt"/>
		<result property="errorRecvFolderCnt" 			column="error_recv_folder_cnt"/>
		<result property="errorRecvRecordCnt" 		column="error_recv_record_cnt"/>
		<result property="sucessRecvFolderCnt" 		column="sucess_recv_folder_cnt"/>
		<result property="sucessRecvRecordCnt" 	column="sucess_recv_record_cnt"/>
		<result property="rjctFolderCnt" 					column="rjct_folder_cnt"/>
		<result property="rjctRecordCnt" 					column="rjct_record_cnt"/>
		<result property="finFolderCnt" 						column="fin_folder_cnt"/>
		<result property="finRecordCnt" 					column="fin_record_cnt"/>
	</resultMap>


	<resultMap id="creatStateApprFolderList-result" class="rms.transf.offer.domain.StateAppr" >
		<result property="recordCenterId"				column="record_center_id"/>
		<result property="recordCenterNm"			column="record_center_nm"/>
		<result property="folderRecvSeq"				column="folder_recv_seq"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="orgNm" 							column="org_nm"/>
		<result property="orgAbbrNm" 					column="org_abbr_nm"/>		
		<result property="creatYyyy" 					column="creat_yyyy"/>
		<result property="title"								column="title"/>
		<result property="presvTermCd"				column="presv_term_cd"/>
		<result property="presvTermNm"				column="presv_term_nm"/>
		<result property="erecordFlag"					column="erecord_flag"/>
		<result property="erecordFlagNm"			column="erecord_flag_nm"/>
		<result property="crReportInfrmFlag"			column="cr_report_infrm_flag"/>
		<result property="crReportInfrmFlagNm"	column="cr_report_infrm_flag_nm"/>
	</resultMap>


	<resultMap id="underDeptCreatStateApprFolderList-result" class="rms.transf.offer.domain.StateAppr" >
		<result property="recordCenterId"				column="record_center_id"/>
		<result property="recordCenterNm"			column="record_center_nm"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="orgNm" 							column="org_nm"/>
		<result property="orgAbbrNm" 					column="org_abbr_nm"/>		
		<result property="creatYyyy" 					column="creat_yyyy"/>
		<result property="title"								column="title"/>
		<result property="presvTermCd"				column="presv_term_cd"/>
		<result property="presvTermNm"				column="presv_term_nm"/>
		<result property="crReportInfrmFlag"			column="cr_report_infrm_flag"/>
		<result property="crReportInfrmFlagNm"	column="cr_report_infrm_flag_nm"/>
	</resultMap>
	

    <resultMap id="findStateApprFileList-result" class="rms.transf.offer.domain.StateApprInfrmFile" >
		<result property="recordCenterId" 					column="record_center_id"/>
		<result property="crReportInfrmCreatYyyy" 		column="cr_report_infrm_creat_yyyy"/>
		<result property="infrmMstFileFullNm" 				column="infrm_mst_file_full_nm"/>
		<result property="infrmMstFileNm" 					column="infrm_mst_file_nm"/>
		<result property="infrmTakeFileFullNm" 				column="infrm_take_file_full_nm"/>
		<result property="infrmTakeFileNm" 					column="infrm_take_file_nm"/>
		<result property="infrmDtlFileFullNm" 				column="infrm_dtl_file_full_nm"/>
		<result property="infrmDtlFileNm" 						column="infrm_dtl_file_nm"/>
		<result property="infrmDfileFileFullNm" 				column="infrm_dfile_file_full_nm"/>		
		<result property="infrmDfileFileNm" 					column="infrm_dfile_file_nm"/>
		<result property="infrmEndFileFullNm" 				column="infrm_end_file_full_nm"/>		
		<result property="infrmEndFileNm" 					column="infrm_end_file_nm"/>
		<result property="crReportInfrmFlagNm" 			column="cr_report_infrm_flag_nm"/>
		<result property="crReportInfrmDtime" 				column="cr_report_infrm_dtime"/>
		<result property="recordCenterType" 				column="record_center_type"/>
	</resultMap>


    <resultMap id="findStateApprFolderInfrmMstList-result" class="rms.transf.offer.domain.StateApprMst" >
		<result property="recordCenterId" 			column="record_center_id"/>
		<result property="folderRecvSeq" 			column="folder_recv_seq"/>
		<result property="creatSysCd" 				column="creat_sys_cd"/>
		<result property="orgCd" 					column="org_cd"/>
		<result property="clssId" 					column="clss_id"/>
		<result property="creatYyyy" 				column="creat_yyyy"/>	
		<result property="folderRegSeq" 			column="folder_reg_seq"/>
		<result property="hoNo" 					column="ho_no"/>
		<result property="title" 					column="title"/>
		<result property="folderTypeDivCd" 			column="folder_type_div_cd"/>
		<result property="folderCloseYyyy" 			column="folder_close_yyyy"/>
		<result property="presvTermCd" 				column="presv_term_cd"/>
		<result property="creatUserNm" 				column="creat_user_nm"/>
		<result property="creatPurps" 				column="creat_purps"/>
	</resultMap>
    
    
    <resultMap id="findStateApprFolderInfrmTakeList-result" class="rms.transf.offer.domain.StateApprTake" >
		<result property="recordCenterId" 			column="record_center_id"/>						
		<result property="creatSysCd" 					column="creat_sys_cd"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="clssId" 							column="clss_id"/>
		<result property="creatYyyy" 					column="creat_yyyy"/>	
		<result property="folderRegSeq" 				column="folder_reg_seq"/>
		<result property="hoNo" 							column="ho_no"/>
		<result property="takeTakovrSno" 			column="take_takovr_sno"/>
		<result property="takeTakovrDivCd" 			column="take_takovr_div_cd"/>
		<result property="takeTakovrOrgCd" 			column="take_takovr_org_cd"/>
		<result property="takeTakovrCreatDtime" 	column="take_takovr_creat_dtime"/>
	</resultMap>
   
   
    <resultMap id="findStateApprRecordInfrmDtlList-result" class="rms.transf.offer.domain.StateApprDtl" >
		<result property="recordCenterId" 			column="record_center_id"/>						
		<result property="creatSysCd" 					column="creat_sys_cd"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="recordRegDivCd" 			column="record_reg_div_cd"/>
		<result property="creatRegDtime" 			column="creat_reg_dtime"/>	
		<result property="creatRegNo" 					column="creat_reg_no"/>
		<result property="dtchRegNo" 					column="dtch_reg_no"/>
		<result property="title" 								column="title"/>
		<result property="aprovPosRankNm" 		column="aprov_pos_rank_nm"/>
		<result property="dutyChrgrNm" 				column="duty_chrgr_nm"/>
		<result property="enforcYmd" 					column="enforc_ymd"/>
		<result property="erecordFlag" 				column="erecord_flag"/>
		<result property="infrmFolderClssNo" 		column="infrm_folder_clss_no"/>
		<result property="spclRecordType" 			column="spcl_record_type"/>
		<result property="openDivCd" 					column="open_div_cd"/>
		<result property="openGrade" 					column="open_grade"/>
		<result property="operReadRangeCd" 		column="oper_read_range_cd"/>
	</resultMap>
	
	
	<resultMap id="findStateApprRecordInfrmDfileList-result" class="rms.transf.offer.domain.StateApprDfile" >
		<result property="recordCenterId" 			column="record_center_id"/>						
		<result property="creatSysCd" 					column="creat_sys_cd"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="recordRegDivCd" 			column="record_reg_div_cd"/>
		<result property="creatRegDtime" 			column="creat_reg_dtime"/>	
		<result property="creatRegNo" 					column="creat_reg_no"/>
		<result property="attachFileSeq" 				column="dtch_reg_no"/>
		<result property="docTypeCd" 					column="doc_type_cd"/>
		<result property="fileCnt" 							column="file_cnt"/>
		<result property="fileSize" 						column="file_size"/>
	</resultMap>

 
	<resultMap id="underDeptCreatStateList-result" class="rms.transf.offer.domain.StateAppr" >
		<result property="recordCenterCd"			column="record_center_cd"/>
		<result property="recordCenterId"				column="record_center_id"/>
		<result property="recordCenterNm"			column="record_center_nm"/>
		<result property="recvFlag" 						column="recvFlag"/>
		<result property="folderCnt" 						column="folderCnt"/>
		<result property="recordCnt" 					column="recordCnt"/>
	</resultMap> 
	    
    
    <resultMap id="underDeptCreatStateApprList-result" class="rms.transf.offer.domain.StateAppr" >
		<result property="recordCenterCd"		column="record_center_cd"/>
		<result property="recordCenterId"			column="record_center_id"/>
		<result property="recordCenterNm"		column="record_center_nm"/>
		<result property="orgCd" 						column="org_cd"/>
		<result property="orgNm" 						column="org_nm"/>
		<result property="orgAbbrNm" 				column="org_abbr_nm"/>		
		<result property="sysFolderCnt01" 		column="sys_folderCnt01"/>
		<result property="sysRecordCnt01" 		column="sys_recordCnt01"/>
		<result property="sysFolderCnt02" 		column="sys_folderCnt02"/>
		<result property="sysRecordCnt02" 		column="sys_recordCnt02"/>
		<result property="sysFolderCnt03" 		column="sys_folderCnt03"/>
		<result property="sysRecordCnt03" 		column="sys_recordCnt03"/>
		<result property="sysFolderCnt04" 		column="sys_folderCnt04"/>
		<result property="sysRecordCnt04" 		column="sys_recordCnt04"/>
		<result property="totFolderCnt" 				column="tot_folderCnt"/>
		<result property="totRecordCnt" 			column="tot_recordCnt"/>
	</resultMap>
    
    
    <resultMap id="findUnderDeptStateApprFolderInfrmMstList-result" class="rms.transf.offer.domain.CrInfrmFolder" >
		<result property="recordCenterId" 			column="record_center_id"/>						
		<result property="creatSysCd" 					column="creat_sys_cd"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="clssId" 							column="clss_id"/>
		<result property="creatYyyy" 					column="creat_yyyy"/>	
		<result property="folderRegSeq" 				column="folder_reg_seq"/>
		<result property="hoNo" 							column="ho_no"/>
		<result property="title" 								column="title"/>
		<result property="folderTypeDivCd" 			column="folder_type_div_cd"/>
		<result property="folderCloseYyyy" 			column="folder_close_yyyy"/>
		<result property="presvTermCd" 				column="presv_term_cd"/>
		<result property="creatUserNmAccum" 	column="creat_user_nm_accum"/>
		<result property="creatPurps" 					column="creat_purps"/>
	</resultMap>

    <resultMap id="findUnderDeptStateApprFolderInfrmTakeList-result" class="rms.transf.offer.domain.CrInfrmFolderTakeTakovr" >
		<result property="recordCenterId" 			column="record_center_id"/>						
		<result property="creatSysCd" 					column="creat_sys_cd"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="clssId" 							column="clss_id"/>
		<result property="creatYyyy" 					column="creat_yyyy"/>	
		<result property="folderRegSeq" 				column="folder_reg_seq"/>
		<result property="hoNo" 							column="ho_no"/>
		<result property="takeTakovrSno" 			column="take_takovr_sno"/>
		<result property="takeTakovrDivCd" 			column="take_takovr_div_cd"/>
		<result property="takeTakovrOrgCd" 			column="take_takovr_org_cd"/>
		<result property="takeTakovrCreatDtime" 	column="take_takovr_creat_dtime"/>
	</resultMap>
    
   <resultMap id="findUnderDeptStateApprRecordInfrmDtlList-result" class="rms.transf.offer.domain.CrInfrmRecord" >
		<result property="recordCenterId" 			column="record_center_id"/>						
		<result property="creatSysCd" 					column="creat_sys_cd"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="recordRegDivCd" 			column="record_reg_div_cd"/>
		<result property="creatRegDtime" 			column="creat_reg_dtime"/>	
		<result property="creatRegNo" 					column="creat_reg_no"/>
		<result property="dtchRegNo" 					column="dtch_reg_no"/>
		<result property="title" 								column="title"/>
		<result property="aprovPosRankNm" 		column="aprov_pos_rank_nm"/>
		<result property="dutyChrgrNmAccum" 	column="duty_chrgr_nm_accum"/>
		<result property="enforcYmd" 					column="enforc_ymd"/>
		<result property="erecordFlag" 				column="erecord_flag"/>
		<result property="infrmFolderClssNo" 		column="infrm_folder_clss_no"/>
		<result property="spclRecordType" 			column="spcl_record_type"/>
		<result property="openDivCd" 					column="open_div_cd"/>
		<result property="openGrade" 					column="open_grade"/>
		<result property="operReadRangeCd" 		column="oper_read_range_cd"/>
	</resultMap>

	<resultMap id="findUnderDeptStateApprRecordInfrmDfileList-result" class="rms.transf.offer.domain.CrInfrmDfile" >
		<result property="recordCenterId" 			column="record_center_id"/>						
		<result property="creatSysCd" 					column="creat_sys_cd"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="recordRegDivCd" 			column="record_reg_div_cd"/>
		<result property="creatRegDtime" 			column="creat_reg_dtime"/>	
		<result property="creatRegNo" 					column="creat_reg_no"/>
		<result property="attachFileSeq" 				column="attach_file_seq"/>
		<result property="docTypeCd" 					column="doc_type_cd"/>
		<result property="fileCnt" 							column="file_cnt"/>
		<result property="infrmFileSize" 				column="infrm_file_size"/>
	</resultMap>

	<resultMap id="findUnderDeptInfrmFileList-result" class="rms.transf.offer.domain.StateApprInfrmFile" >
		<result property="crReportInfrmFileNm" 	column="cr_report_infrm_file_nm"/>
	</resultMap>


	<resultMap id="creatStateApprStateList-result" class="rms.transf.offer.domain.StateAppr" >
		<result property="crReportInfrmYyyy" 			column="cr_report_infrm_yyyy"/>
		<result property="crReportOrgCdCnt" 			column="cr_report_org_cd_cnt"/>
		<result property="folderCnt" 							column="folder_Cnt"/>
		<result property="recordCnt" 						column="record_Cnt"/>
		<result property="crReportInfrmUserId" 		column="cr_report_infrm_user_id"/>
		<result property="crReportInfrmUserNm"		column="cr_report_infrm_user_nm"/>
		<result property="crReportInfrmDtime"			column="cr_report_infrm_dtime"/>
		<result property="crReportInfrmFlagNm"		column="cr_report_infrm_flag_nm"/>
		<result property="crReportInfrmStateFlagNm"		column="cr_report_infrm_state_flag_nm"/>
	</resultMap>


	<resultMap id="creatStateApprRecvResultList-result" class="rms.transf.offer.domain.CrInfrmRecvResult" >
		<result property="repOrgCd" 						column="rep_org_cd"/>
		<result property="crReportInfrmYyyy" 			column="cr_report_infrm_yyyy"/>
		<result property="sendFileDataDiv" 				column="send_file_data_div"/>
		<result property="sendFileDataDivNm" 			column="send_file_data_div_nm"/>
		<result property="listLineNo" 						column="list_line_no"/>
		<result property="infrmRecvErrorCont"			column="infrm_recv_error_cont"/>
		<result property="recvFileDtime"					column="recv_file_dtime"/>
	</resultMap>
	
	
	<resultMap id="creatStateApprTakeResultList-result" class="rms.transf.offer.domain.CrInfrmTakeResult" >
		<result property="repOrgCd" 					column="rep_org_cd"/>
		<result property="creatSysCd" 					column="creat_sys_cd"/>
		<result property="orgCd" 							column="org_cd"/>
		<result property="orgAbbrNm" 					column="org_abbr_nm"/>
		<result property="orgNm" 							column="org_nm"/>
		<result property="clssId" 							column="clss_id"/>
		<result property="creatYyyy" 					column="creat_yyyy"/>
		<result property="folderRegSeq"				column="folder_reg_seq"/>
		<result property="hoNo"							column="ho_no"/>
		<result property="title"								column="title"/>
		<result property="presvTermCd"				column="presv_term_cd"/>
		<result property="folderTypeDivCd"			column="folder_type_div_cd"/>
		<result property="infrmRjctFlag"				column="infrm_rjct_flag"/>
		<result property="infrmRjctFlagNm"			column="infrm_rjct_flag_nm"/>
		<result property="infrmTakeErrorCont"		column="infrm_take_error_cont"/>
		<result property="recordCenterCd"			column="record_center_cd"/>
		<result property="recordCenterNm"			column="record_center_nm"/>
	</resultMap>
	
	<resultMap id="undercreatStateApprStateList-result" class="rms.transf.offer.domain.StateAppr" >
		<result property="crReportInfrmYyyy" 		column="cr_report_infrm_yyyy"/>
		<result property="crReportOrgCdCnt" 		column="cr_report_org_cd_cnt"/>
		<result property="folderCnt" 				column="folder_Cnt"/>
		<result property="recordCnt" 				column="record_Cnt"/>
		<result property="crReportInfrmUserId" 		column="cr_report_infrm_user_id"/>
		<result property="crReportInfrmUserNm"		column="cr_report_infrm_user_nm"/>
		<result property="crReportInfrmDtime"		column="cr_report_infrm_dtime"/>
		<result property="crReportInfrmFlagNm"		column="cr_report_infrm_flag_nm"/>
	</resultMap>
	
	<!--
		기록물인수>연계인수>소속기록관생산현황접수 접수목록조회(COUNT)
	-->
	<select id="countfindUnderDeptCreatState" parameterClass="rms.transf.offer.domain.StateAppr" resultClass="long">
		SELECT COUNT(1)
		FROM
		(
		SELECT a.record_center_cd, a.record_center_nm, b.folderCnt, DECODE(b.folderCnt,'','N','Y') AS recvFlag
		FROM (
			SELECT record_center_cd, record_center_nm, record_center_id
			FROM TB_STRECORDCENTER
			<isNotEmpty prepend="WHERE" property="recordCenterId">
				record_center_id = #recordCenterId:VARCHAR#
			</isNotEmpty>
			) a, 
			 (
			SELECT a.record_center_id, count(a.record_center_id) as folderCnt
			FROM TB_CRINFRMFOLDER a
			<isNotEmpty prepend="WHERE" property="crReportInfrmCreatYyyy">
				a.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
			</isNotEmpty>
			GROUP BY a.record_center_id
			) b
		WHERE a.record_center_id = b.record_center_id(+)
		)
		<isNotEmpty prepend="WHERE" property="recvFlag">
	 			recvFlag = #recvFlag:VARCHAR#
	 	</isNotEmpty>
	</select>
	
	
	
	<!--
		기록물인수>연계인수>소속기록관생산현황접수 접수목록조회
	-->
	<select id="findUnderDeptCreatState" parameterClass="rms.transf.offer.domain.StateAppr"  resultMap="underDeptCreatStateList-result">
		SELECT F.*
		FROM (
		    SELECT ROWNUM AS rnum
		           , D.*
		    FROM (
		            SELECT    record_center_cd, record_center_id, record_center_nm, NVL(folderCnt,0) AS folderCnt, NVL(recordCnt,0) AS recordCnt, recvFlag
		            FROM
		                (
		                    SELECT    a.record_center_cd, a.record_center_id, a.record_center_nm, b.folderCnt, b.recordCnt, DECODE(b.folderCnt,'','N','Y') AS recvFlag
		                    FROM         (
		                                    SELECT    record_center_cd,record_center_id, record_center_nm
		                                    FROM         TB_STRECORDCENTER
		                                    <isNotEmpty prepend="WHERE" property="recordCenterId">
		                                                    record_center_id = #recordCenterId:VARCHAR#
		                                    </isNotEmpty>
		                                    ) a, 
		                                    (
		                                    SELECT    record_center_id, COUNT(recordCnt) AS folderCnt, SUM(recordCnt) AS recordCnt
		                                    FROM
		                                                    ( 
		                                                    SELECT    a.record_center_id, COUNT(b.org_cd) AS recordCnt
		                                                    FROM         TB_CRINFRMFOLDER a, TB_CRINFRMRECORD b
		                                                    WHERE     a.record_center_id = b.record_center_id
		                                                    <isNotEmpty prepend="AND" property="crReportInfrmCreatYyyy">
		                                                                    a.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		                                                    </isNotEmpty>
		                                                    AND            a.creat_sys_cd = b.infrm_creat_sys_cd
		                                                    AND            a.org_cd = b.infrm_org_cd
		                                                    AND            a.clss_id = b.infrm_clss_id
		                                                    AND            a.creat_yyyy = b.infrm_creat_yyyy
		                                                    AND            a.folder_reg_seq = b.infrm_folder_reg_seq
		                                                    AND            a.ho_no = b.infrm_ho_no
		                                                    GROUP BY a.record_center_id, a.creat_sys_cd, a.org_cd, a.clss_id, a.creat_yyyy, a.folder_reg_seq, a.ho_no
		                                                    )
		                                    GROUP BY    record_center_id
		                                    ) b
		                    WHERE a.record_center_id = b.record_center_id(+)
		                )
		            <isNotEmpty prepend="WHERE" property="recvFlag">
		                         recvFlag = #recvFlag:VARCHAR#
		             </isNotEmpty>
		            ORDER BY record_center_cd     
		      ) D
		    WHERE ROWNUM <![CDATA[<=]]> #pagedEnd:NUMBER#
		) F
		WHERE F.rnum <![CDATA[>=]]> #pagedStart:NUMBER#
	</select>
	
	<!-- 
		기록물인수>연계인수>소속기록관포함생산현황접수 접수내역삭제(문서데이타)
	 -->
	<delete id="deleteCrInfrmDfile" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		DELETE FROM TB_CRINFRMDFILE Z
		<!--cubrid WHERE (record_center_id, creat_sys_cd, org_cd, creat_reg_dtime, creat_reg_no)
		IN (
		    SELECT B.record_center_id, B.creat_sys_cd, B.org_cd, B.creat_reg_dtime, B.creat_reg_no-->
		WHERE 
		EXISTS (
		    SELECT 1
		    FROM  TB_CRINFRMFOLDER A
		        , TB_CRINFRMRECORD B
		    WHERE A.record_center_id = #recordCenterId:VARCHAR#
		    AND   A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		    AND   A.record_center_id = B.record_center_id
		    AND   A.creat_sys_cd = B.infrm_creat_sys_cd
		    AND   A.org_cd = B.infrm_org_cd
		    AND   A.clss_id = B.infrm_clss_id
		    AND   A.creat_yyyy = B.infrm_creat_yyyy
		    AND   A.folder_reg_seq = B.infrm_folder_reg_seq
		    AND   A.ho_no = B.infrm_ho_no
		    <!--cubrid -->
		    AND   B.record_center_id = Z.record_center_id
		    AND   B.creat_sys_cd = Z.creat_sys_cd
		    AND   B.org_cd= Z.org_cd
		    AND   B.creat_reg_dtime = Z.creat_reg_dtime
		    AND   B.creat_reg_no = Z.creat_reg_no
		)
	</delete>
	
	<!-- 
		기록물인수>연계인수>소속기록관포함생산현황접수 접수내역삭제(건목록)
	 -->
	<delete id="deleteCrInfrmDtl" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		DELETE FROM TB_CRINFRMRECORD Z
		<!--cubrid WHERE (record_center_id, infrm_creat_sys_cd, infrm_org_cd, infrm_clss_id, infrm_creat_yyyy, infrm_folder_reg_seq, infrm_ho_no)
		IN (
		    SELECT record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy, folder_reg_seq, ho_no-->
		WHERE 
		EXISTS (
		    SELECT 1
		    FROM  TB_CRINFRMFOLDER
		    WHERE record_center_id = #recordCenterId:VARCHAR#
		    AND   cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		    <!--cubrid-->
		    AND   record_center_id = Z.record_center_id
		    AND   creat_sys_cd = Z.infrm_creat_sys_cd
	 	    AND   org_cd = Z.infrm_org_cd
 		    AND   clss_id = Z.infrm_clss_id
		    AND   creat_yyyy = Z.infrm_creat_yyyy
		    AND   folder_reg_seq = Z.infrm_folder_reg_seq
		    AND   ho_no = Z.infrm_ho_no
		)
	</delete>
	
	<!-- 
		기록물인수>연계인수>소속기록관포함생산현황접수 접수내역삭제(인수인계목록)
	 -->
	<delete id="deleteCrInfrmTake" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		DELETE FROM TB_CRINFRMFOLDERTAKETAKOVR Z
		<!--cubrid WHERE  (record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy, folder_reg_seq, ho_no)
		IN (
		    SELECT record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy, folder_reg_seq, ho_no-->
		WHERE  
		EXISTS (
		    SELECT 1
		    FROM  TB_CRINFRMFOLDER
		    WHERE record_center_id = #recordCenterId:VARCHAR#
		    AND   cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		    <!--cubrid-->
		    AND   record_center_id = Z.record_center_id
                    AND   creat_sys_cd = Z.creat_sys_cd
                    AND   org_cd = Z.org_cd
                    AND   clss_id = Z.clss_id
                    AND   creat_yyyy = Z.creat_yyyy
                    AND   folder_reg_seq = Z.folder_reg_seq
                    AND   ho_no = Z.ho_no
		)
	</delete>
	
	<!-- 
		기록물인수>연계인수>소속기록관포함생산현황접수 접수내역삭제(철목록)
	 -->
	<delete id="deleteCrInfrmMst" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		DELETE FROM TB_CRINFRMFOLDER
		WHERE record_center_id = #recordCenterId:VARCHAR#
		AND   cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
	</delete>
	
	<!--
		기록물인수>연계인수>소속기록관포함생산현황통보 통보목록조회 (COUNT)
		통합 온나라 
	-->
	<select id="countfindUnderDeptCreatStateAppr" parameterClass="rms.transf.offer.domain.StateAppr" resultClass="long">
		SELECT	COUNT(a.org_cd)
		FROM
						(
						SELECT	record_center_cd, MAX(record_center_id) AS record_center_id, 
										MAX(record_center_nm) AS record_center_nm,  org_cd
						FROM
										(
										SELECT	a.record_center_id AS record_center_cd, a.creat_sys_cd, 
						   								MAX(c.record_center_id) AS record_center_id, 
						   								MAX(c.record_center_nm) AS record_center_nm, 
						   								a.org_cd
										FROM  	 	TB_CRINFRMFOLDER a, TB_CRINFRMRECORD b,
														(
														SELECT	record_center_cd, record_center_id, record_center_nm
														FROM 		TB_STRECORDCENTER 
														<isNotEmpty prepend="WHERE" property="recordCenterId">
																		record_center_id = #recordCenterId:VARCHAR#
														</isNotEmpty>
														) c
										WHERE 	a.record_center_id = c.record_center_id
										<isNotEmpty prepend="AND" property="crReportInfrmCreatYyyy">
						 								a.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
										</isNotEmpty>
										AND	 		a.record_center_id = b.record_center_id
										AND			a.creat_sys_cd = b.infrm_creat_sys_cd
										AND			a.org_cd = b.infrm_org_cd
										AND			a.clss_id = b.infrm_clss_id
										AND			a.creat_yyyy = b.infrm_creat_yyyy
										AND			a.folder_reg_seq = b.infrm_folder_reg_seq
										AND			a.ho_no = b.infrm_ho_no
										GROUP BY	 a.record_center_id, a.creat_sys_cd, a.org_cd, a.clss_id, a.creat_yyyy, a.folder_reg_seq, a.ho_no
										) 
						GROUP BY	 record_center_cd, creat_sys_cd, org_cd
						) a
	</select>
	
	<!--
		기록물인수>연계인수>소속기록관포함생산현황통보 통보목록조회
		통합 온-나라 작업 
	-->
	<select id="findUnderDeptCreatStateAppr" parameterClass="rms.transf.offer.domain.StateAppr"  resultMap="underDeptCreatStateApprList-result">
        SELECT F.*
        FROM (
            SELECT ROWNUM AS rnum
                   , D.*
            FROM (
                  SELECT    a.record_center_cd, a.record_center_id, a.record_center_nm, a.org_cd, b.org_abbr_nm, b.org_nm,
                                   a.sys_folderCnt01, a.sys_recordCnt01, a.sys_folderCnt02, a.sys_recordCnt02, a.sys_folderCnt03, a.sys_recordCnt03,a.sys_folderCnt04,a.sys_recordCnt04,
                                   a.tot_folderCnt, a.tot_recordCnt
                FROM
                                (
                                SELECT    record_center_cd, MAX(record_center_id) AS record_center_id, 
                                                MAX(record_center_nm) AS record_center_nm,  org_cd, 
                                                   DECODE(creat_sys_cd, '01', SUM(1)) AS sys_folderCnt01,
                                                  DECODE(creat_sys_cd, '01', SUM(tot_recordCnt)) AS sys_recordCnt01,
                                                  DECODE(creat_sys_cd, '02', SUM(1)) AS sys_folderCnt02,
                                                   DECODE(creat_sys_cd, '02', SUM(tot_recordCnt)) AS sys_recordCnt02,
                                                   DECODE(creat_sys_cd, '03', SUM(1)) AS sys_folderCnt03,
                                                   DECODE(creat_sys_cd, '03', SUM(tot_recordCnt)) AS sys_recordCnt03,
                                                   DECODE(creat_sys_cd, '04', SUM(1)) AS sys_folderCnt04,
                                                   DECODE(creat_sys_cd, '04', SUM(tot_recordCnt)) AS sys_recordCnt04,
                                                   COUNT(1) tot_folderCnt, SUM(tot_recordCnt) tot_recordCnt
                                FROM
                                                (
                                                SELECT    a.record_center_id AS record_center_cd, a.creat_sys_cd, 
                                                                   MAX(c.record_center_id) AS record_center_id, 
                                                                   MAX(c.record_center_nm) AS record_center_nm, 
                                                                   a.org_cd, COUNT(b.org_cd) AS tot_recordCnt
                                                FROM           TB_CRINFRMFOLDER a, TB_CRINFRMRECORD b,
                                                                (
                                                                SELECT    record_center_cd, record_center_id, record_center_nm
                                                                FROM         TB_STRECORDCENTER 
                                                                <isNotEmpty prepend="WHERE" property="recordCenterId">
                                                                                record_center_id = #recordCenterId:VARCHAR#
                                                                </isNotEmpty>
                                                                ) c
                                                WHERE     a.record_center_id = c.record_center_id
                                                <isNotEmpty prepend="AND" property="crReportInfrmCreatYyyy">
                                                                 a.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
                                                </isNotEmpty>
                                                AND             a.record_center_id = b.record_center_id
                                                AND            a.creat_sys_cd = b.infrm_creat_sys_cd
                                                AND            a.org_cd = b.infrm_org_cd
                                                AND            a.clss_id = b.infrm_clss_id
                                                AND            a.creat_yyyy = b.infrm_creat_yyyy
                                                AND            a.folder_reg_seq = b.infrm_folder_reg_seq
                                                AND            a.ho_no = b.infrm_ho_no
                                                GROUP BY     a.record_center_id, a.creat_sys_cd, a.org_cd, a.clss_id, a.creat_yyyy, a.folder_reg_seq, a.ho_no
                                                ) 
                                GROUP BY     record_center_cd, creat_sys_cd, org_cd
                                ) a,
                                (
                                SELECT    record_center_id, org_cd, org_abbr_nm, org_nm
                                FROM       TB_STORG
                                <isNotEmpty prepend="WHERE" property="recordCenterId">
                                                record_center_id = #recordCenterId:VARCHAR#
                                </isNotEmpty>
                                ) b
                WHERE     a.record_center_id = b.record_center_id
                AND              a.org_cd = b.org_cd 
              ) D
            WHERE ROWNUM <![CDATA[<=]]> #pagedEnd:NUMBER#
        ) F
        WHERE F.rnum <![CDATA[>=]]> #pagedStart:NUMBER#
	</select>
	
	<!--
		기록물인수>연계인수>생산현황통보>소속기록관포함생산현황통보 통보대상기록물철목록 조회(COUNT)
	-->
	<select id="countFindUnderDeptCreatStateApprFolder" parameterClass="rms.transf.offer.domain.StateAppr" resultClass="long">
		SELECT	COUNT(1) 
		FROM  		TB_CRINFRMFOLDER a, 
						(SELECT 	a.record_center_id, a.record_center_cd, a.record_center_nm, 
									b.org_cd, b.org_nm, b.org_abbr_nm 
						FROM 		TB_STRECORDCENTER a, TB_STORG b
						WHERE 	a.record_center_id = #recordCenterId:VARCHAR#
						AND	  		a.record_center_id = b.record_center_id
			  			) b
		WHERE 	a.record_center_id = b.record_center_id 
		AND   	a.org_cd = b.org_cd
		<isNotEmpty prepend="AND" property="crReportInfrmCreatYyyy">
				a.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="presvTermCd">
		 		a.presv_term_cd = #presvTermCd:VARCHAR#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="clssId">
				a.clss_id = #clssId:VARCHAR#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="crReportOrgCd">
		  	 	a.org_cd = #crReportOrgCd:VARCHAR#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="creatYyyy">	 			
		   		a.creat_yyyy = #creatYyyy:VARCHAR#
		</isNotEmpty> 
		<isNotEmpty prepend="AND" property="title">				
				a.title LIKE #title:VARCHAR#
		</isNotEmpty>
	</select>
	
	<!--
		기록물인수>연계인수>생산현황통보>소속기록관포함생산현황통보 통보대상기록물철목록 조회
	-->
	<select id="findUnderDeptCreatStateApprFolder" parameterClass="rms.transf.offer.domain.StateAppr"  resultMap="underDeptCreatStateApprFolderList-result">
        SELECT F.*
        FROM (
            SELECT ROWNUM AS rnum
                   , D.*
            FROM (
                    SELECT    a.record_center_id, a.org_cd, a.creat_yyyy, 
                                       a.title, b.org_nm, b.org_abbr_nm, b.record_center_nm, 
                                       a.presv_term_cd, c.com_cd_nm AS presv_term_nm, 
                                       a.cr_report_infrm_flag, 
                                       DECODE(a.cr_report_infrm_flag,'1','통보(온라인)','2','통보(오프라인)','미통보') AS cr_report_infrm_flag_nm
                    FROM          TB_CRINFRMFOLDER a, 
                                    (SELECT     a.record_center_id, a.record_center_cd, a.record_center_nm, 
                                                b.org_cd, b.org_nm, b.org_abbr_nm 
                                    FROM         TB_STRECORDCENTER a, TB_STORG b
                                    WHERE     a.record_center_id = #recordCenterId:VARCHAR#
                                    AND              a.record_center_id = b.record_center_id
                                      ) b,
                                      (SELECT     com_cd, com_cd_nm 
                                      FROM         TB_ZZCOMCD 
                                      WHERE     com_type_cd = 'RD07' 
                                      AND             use_flag = '1' ) c
                    WHERE     a.record_center_id = b.record_center_id 
                    AND       a.org_cd = b.org_cd
                    AND       a.presv_term_cd = c.com_cd
                    <isNotEmpty prepend="AND" property="crReportInfrmCreatYyyy">
                            a.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
                    </isNotEmpty>
                    <isNotEmpty prepend="AND" property="presvTermCd">
                             a.presv_term_cd = #presvTermCd:VARCHAR#
                    </isNotEmpty>
                    <isNotEmpty prepend="AND" property="clssId">
                             a.clss_id = #clssId:VARCHAR#
                    </isNotEmpty>
                    <isNotEmpty prepend="AND" property="crReportOrgCd">
                               a.org_cd = #crReportOrgCd:VARCHAR#
                    </isNotEmpty>
                    <isNotEmpty prepend="AND" property="creatYyyy">                 
                               a.creat_yyyy = #creatYyyy:VARCHAR#
                    </isNotEmpty> 
                    <isNotEmpty prepend="AND" property="title">                
                            a.title LIKE #title:VARCHAR#
                    </isNotEmpty>
                    ORDER BY a.record_center_id, a.org_cd, a.clss_id, a.creat_yyyy, a.folder_reg_seq, a.ho_no  
              ) D
            WHERE ROWNUM <![CDATA[<=]]> #pagedEnd:NUMBER#
        ) F
        WHERE F.rnum <![CDATA[>=]]> #pagedStart:NUMBER#
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관생산현황통보 통보파일정보 조회(통보팝업)
	 -->
	<select id="findUnderDeptCreatStateApprFileList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findStateApprFileList-result">
		SELECT	record_center_id, cr_report_infrm_creat_yyyy, 
						MAX(infrm_mst_file_nm) AS infrm_mst_file_full_nm, 
						<!--cubrid SUBSTR(MAX(infrm_mst_file_nm),(INSTR(MAX(infrm_mst_file_nm),'/',-1,1))+1) AS infrm_mst_file_nm,-->
						SUBSTR(MAX(infrm_mst_file_nm),(INSTR(MAX(infrm_mst_file_nm),'/',-1))+1) AS infrm_mst_file_nm,
						MAX(infrm_take_file_nm) AS infrm_take_file_full_nm,
						<!--cubrid SUBSTR(MAX(infrm_take_file_nm),(INSTR(MAX(infrm_take_file_nm),'/',-1,1))+1) AS infrm_take_file_nm, -->
						SUBSTR(MAX(infrm_take_file_nm),(INSTR(MAX(infrm_take_file_nm),'/',-1))+1) AS infrm_take_file_nm, 
						MAX(infrm_dtl_file_nm) AS infrm_dtl_file_full_nm,
						<!--cubrid SUBSTR(MAX(infrm_dtl_file_nm),(INSTR(MAX(infrm_dtl_file_nm),'/',-1,1))+1) AS infrm_dtl_file_nm, -->
						SUBSTR(MAX(infrm_dtl_file_nm),(INSTR(MAX(infrm_dtl_file_nm),'/',-1))+1) AS infrm_dtl_file_nm, 
						MAX(infrm_dfile_file_nm) AS infrm_dfile_file_full_nm,
						<!--cubrid SUBSTR(MAX(infrm_dfile_file_nm),(INSTR(MAX(infrm_dfile_file_nm),'/',-1,1))+1) AS infrm_dfile_file_nm,-->
						SUBSTR(MAX(infrm_dfile_file_nm),(INSTR(MAX(infrm_dfile_file_nm),'/',-1))+1) AS infrm_dfile_file_nm,
						MAX(infrm_end_file_nm) AS infrm_end_file_full_nm,
						<!--cubrid SUBSTR(MAX(infrm_end_file_nm),(INSTR(MAX(infrm_end_file_nm),'/',-1,1))+1) AS infrm_end_file_nm,-->
						SUBSTR(MAX(infrm_end_file_nm),(INSTR(MAX(infrm_end_file_nm),'/',-1))+1) AS infrm_end_file_nm,
						DECODE(MAX(cr_report_infrm_flag),'1','통보(온라인)','2','통보(오프라인)','0','미통보') AS cr_report_infrm_flag_nm,
						MAX(cr_report_infrm_dtime) AS cr_report_infrm_dtime,
						'0' AS record_center_type
		FROM
						(
						SELECT	record_center_id, cr_report_infrm_creat_yyyy,
										DECODE(cr_report_infrm_file_type,'MST', cr_report_infrm_file_nm) AS infrm_mst_file_nm,
										DECODE(cr_report_infrm_file_type,'TAKE', cr_report_infrm_file_nm) AS infrm_take_file_nm,
										DECODE(cr_report_infrm_file_type,'DTL', cr_report_infrm_file_nm) AS infrm_dtl_file_nm,
										DECODE(cr_report_infrm_file_type,'DFILE', cr_report_infrm_file_nm) AS infrm_dfile_file_nm,
										DECODE(cr_report_infrm_file_type,'END', cr_report_infrm_file_nm) AS infrm_end_file_nm,
										cr_report_infrm_flag, cr_report_infrm_dtime
						FROM 		TB_CRINFRMFILE
						WHERE  	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
						AND			hupper_record_center_flag = '1'
						) 
		GROUP BY record_center_id, cr_report_infrm_creat_yyyy
		ORDER BY record_center_id, cr_report_infrm_creat_yyyy
	</select>
	
	<!--
		기록물인수>연계인수>소속기록관포함생산현황통보현황  생산현황통보현황 목록조회
	-->
	<select id="countFindUnderDeptCreatStateApprState" parameterClass="rms.transf.offer.domain.StateAppr" resultClass="long">
		SELECT 	COUNT(1)
		FROM
						(SELECT	cr_report_infrm_yyyy
						FROM 
										(
										SELECT	SUBSTR(a.cr_report_infrm_dtime,1,4) AS cr_report_infrm_yyyy, a.org_cd
										FROM  		TB_CRINFRMFOLDER a,
														(
														SELECT	record_center_cd, record_center_id, record_center_nm
														FROM 		TB_STRECORDCENTER 
														<isNotEmpty prepend="WHERE" property="recordCenterId">
																		record_center_id = #recordCenterId:VARCHAR#
														</isNotEmpty>
														) b 
										WHERE		a.record_center_id = b.record_center_id
										<isNotEmpty prepend="AND" property="crReportInfrmYyyy">
							  							SUBSTR(a.cr_report_infrm_dtime,1,4) = #crReportInfrmYyyy:VARCHAR#
							  			</isNotEmpty>
							  			AND 			a.cr_report_infrm_flag IN ('1','2')
										GROUP BY SUBSTR(a.cr_report_infrm_dtime,1,4), a.org_cd
										)
						GROUP BY cr_report_infrm_yyyy
		)
	</select>
	
	<!--
		기록물인수>연계인수>소속기록관포함생산현황통보현황  생산현황통보현황 목록조회
		//통합 온-나라 
	-->
	<select id="findUnderDeptCreatStateApprState" parameterClass="rms.transf.offer.domain.StateAppr"  resultMap="undercreatStateApprStateList-result">
        SELECT F.*
        FROM (
            SELECT ROWNUM AS rnum
                   , D.*
            FROM (
   				SELECT 	cr_report_infrm_yyyy, COUNT(org_cd) AS cr_report_org_cd_cnt, 
								SUM(folder_cnt) AS folder_cnt, SUM(record_cnt) AS record_cnt,
								MAX(cr_report_infrm_user_id) AS cr_report_infrm_user_id, MAX(cr_report_infrm_user_nm) AS cr_report_infrm_user_nm, 
								SUBSTR(MAX(cr_report_infrm_dtime),1,8) AS cr_report_infrm_dtime,
								DECODE(MAX(cr_report_infrm_flag),'1','통보(온라인)','2','통보(오프라인)','미통보') AS cr_report_infrm_flag_nm
				FROM 
					(
					SELECT	cr_report_infrm_yyyy, MAX(record_center_id), org_cd, COUNT(org_cd) AS folder_cnt, 
									SUM(record_cnt) AS record_cnt, MAX(cr_report_infrm_user_id) AS cr_report_infrm_user_id, 
									MAX(cr_report_infrm_user_nm) AS cr_report_infrm_user_nm,
									MAX(cr_report_infrm_dtime) AS cr_report_infrm_dtime, MAX(cr_report_infrm_flag) AS cr_report_infrm_flag
					FROM  		
									(
									SELECT	SUBSTR(MAX(a.cr_report_infrm_dtime),1,4) AS cr_report_infrm_yyyy,
													MAX(a.cr_report_infrm_dtime) AS cr_report_infrm_dtime,
													a.record_center_id, MAX(c.record_center_cd) AS record_center_cd,  a.org_cd,
													COUNT(b.org_cd) AS record_cnt,
													MAX(a.cr_report_infrm_user_nm) AS cr_report_infrm_user_nm,
													MAX(a.cr_report_infrm_user_id) AS cr_report_infrm_user_id,
													MAX(a.cr_report_infrm_flag) AS cr_report_infrm_flag
									FROM 		TB_CRINFRMFOLDER a, TB_CRINFRMRECORD b,
													(
													SELECT	record_center_cd, record_center_id, record_center_nm
													FROM 		TB_STRECORDCENTER 
													<isNotEmpty prepend="WHERE" property="recordCenterId">
																	record_center_id = #recordCenterId:VARCHAR#
													</isNotEmpty>
													) c
									WHERE 	a.record_center_id = c.record_center_id
									<isNotEmpty prepend="AND" property="crReportInfrmYyyy">
													SUBSTR(a.cr_report_infrm_dtime,1,4) = #crReportInfrmYyyy:VARCHAR#
									</isNotEmpty>
									AND	  		a.record_center_id = b.record_center_id
									AND			a.creat_sys_cd = b.infrm_creat_sys_cd
									AND			a.org_cd = b.infrm_org_cd
									AND 			a.clss_id = b.infrm_clss_id
									AND			a.creat_yyyy = b.infrm_creat_yyyy
									AND			a.folder_reg_seq = b.infrm_folder_reg_seq
									AND			a.ho_no = b.infrm_ho_no
									AND 			a.cr_report_infrm_flag IN ('1','2')
									GROUP BY a.record_center_id, a.creat_sys_cd, a.org_cd, a.clss_id, a.creat_yyyy, a.folder_reg_seq, a.ho_no
									)
					GROUP BY cr_report_infrm_yyyy, org_cd
				)
				GROUP BY cr_report_infrm_yyyy
				ORDER BY cr_report_infrm_yyyy
              ) D
            WHERE ROWNUM <![CDATA[<=]]> #pagedEnd:NUMBER#
        ) F
        WHERE F.rnum <![CDATA[>=]]> #pagedStart:NUMBER#
	</select>
	
	<!--
		기록물이관 > 생산현황보고 >> 생산현황통보 (COUNT)
		통합 온-나라 추가분 
	-->
	<select id="countFindCreatStateAppr" parameterClass="rms.transf.offer.domain.StateAppr" resultClass="long">
		SELECT COUNT(1)
		FROM (
			SELECT D.record_center_id, D.cr_report_org_cd, D.creat_sys_cd
			FROM (
				(
					SELECT A.record_center_id, A.cr_report_org_cd, A.creat_sys_cd
					FROM  TB_CRREPORT A
					    , TB_CRFOLDER B
					WHERE B.record_center_id = #recordCenterId:VARCHAR#
					<isNotEmpty prepend="AND" property="crReportOrgCd">
						B.cr_report_org_cd = #crReportOrgCd:VARCHAR#
					</isNotEmpty>
					AND   B.creat_sys_cd IN ('01','02','04')
					<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="">
						( ( B.cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND B.cr_report_infrm_flag = '0' )
							OR ( B.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND B.cr_report_infrm_flag IN ('1','2') ) )
					</isEqual>
					<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="0">
						B.cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND B.cr_report_infrm_flag = '0'
					</isEqual>
					<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="1">
						B.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND B.cr_report_infrm_flag IN ('1','2')
					</isEqual>
					AND   A.record_center_id = B.record_center_id
					AND   A.cr_report_yyyy = B.cr_report_yyyy
					AND   A.cr_report_org_cd = B.cr_report_org_cd
					AND   A.creat_sys_cd = B.creat_sys_cd
					AND   A.cr_report_sno = B.cr_report_sno
				)
				UNION ALL
				(
					SELECT A.record_center_id, A.cr_report_org_cd, A.creat_sys_cd
					FROM  TB_CRFOLDER A
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					<isNotEmpty prepend="AND" property="crReportOrgCd">
						A.cr_report_org_cd = #crReportOrgCd:VARCHAR#
					</isNotEmpty>
					AND   A.creat_sys_cd = '03'
					<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="">
						( ( A.reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND A.cr_report_infrm_flag = '0' )
							OR ( A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2') ) )
					</isEqual>
					<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="0">
						A.reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND A.cr_report_infrm_flag = '0'
					</isEqual>
					<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="1">
						A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2')
					</isEqual>
				)
			) D
			GROUP BY D.record_center_id, D.cr_report_org_cd, D.creat_sys_cd
		) E
	</select>
	
	<!--
		기록물인수 > 생산현황통보 >> 생산현황통보 목록
		통합 온-나라 추가분 
	-->
	<select id="findCreatStateAppr" parameterClass="rms.transf.offer.domain.StateAppr"  resultMap="creatStateApprList-result">
        SELECT J.*
        FROM (
            SELECT ROWNUM AS rnum
                   , I.*
            FROM (
				SELECT F.record_center_id, F.cr_report_org_cd, F.creat_sys_cd
					, F.state_div_cd, F.cr_report_infrm_flag
					, tot_folderCnt
					, tot_recordCnt
					, sys_folderCnt01
					, sys_recordCnt01
					, sys_folderCnt02
					, sys_recordCnt02
					, sys_folderCnt03
					, sys_recordCnt03
					, sys_folderCnt04
					, sys_recordCnt04
					, DECODE(F.creat_sys_cd,'01',infrm_state,'') sys_infrm_state01
					, DECODE(F.creat_sys_cd,'02',infrm_state,'') sys_infrm_state02
					, DECODE(F.creat_sys_cd,'03',infrm_state,'') sys_infrm_state03
					, DECODE(F.creat_sys_cd,'04',infrm_state,'') sys_infrm_state04
					, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=F.record_center_id AND Z.org_cd=F.cr_report_org_cd) org_nm
					, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=F.record_center_id AND Z.org_cd=F.cr_report_org_cd) org_abbr_nm
					, (SELECT Z.record_center_nm FROM TB_STRECORDCENTER Z WHERE Z.record_center_id=F.record_center_id) record_center_nm  
				FROM (
					SELECT E.record_center_id, E.cr_report_org_cd, E.creat_sys_cd
						, MIN(E.state_div_cd) state_div_cd
						, MAX(E.cr_report_infrm_flag) cr_report_infrm_flag
						, DECODE(MAX(E.cr_report_infrm_flag),'1','통보완료','2','통보완료',DECODE(MIN(E.state_div_cd),'08','통보가능','통보준비중')) infrm_state
						, (SUM(E.sys_folderCnt01)+SUM(E.sys_folderCnt02)+SUM(E.sys_folderCnt03)+SUM(E.sys_folderCnt04)) tot_folderCnt
						, (SUM(E.sys_recordCnt01)+SUM(E.sys_recordCnt02)+SUM(E.sys_recordCnt03)+SUM(E.sys_recordCnt04)) tot_recordCnt
						, SUM(E.sys_folderCnt01) sys_folderCnt01
						, SUM(E.sys_recordCnt01) sys_recordCnt01
						, SUM(E.sys_folderCnt02) sys_folderCnt02
						, SUM(E.sys_recordCnt02) sys_recordCnt02
						, SUM(E.sys_folderCnt03) sys_folderCnt03
						, SUM(E.sys_recordCnt03) sys_recordCnt03
						, SUM(E.sys_folderCnt04) sys_folderCnt04
						, SUM(E.sys_recordCnt04) sys_recordCnt04
					FROM (
						SELECT D.record_center_id, D.cr_report_org_cd, D.creat_sys_cd, D.state_div_cd, D.cr_report_infrm_flag
							, DECODE(D.creat_sys_cd,'01',1,0) sys_folderCnt01
							, DECODE(D.creat_sys_cd,'01',tot_recordCnt,0) sys_recordCnt01
							, DECODE(D.creat_sys_cd,'02',1,0) sys_folderCnt02
							, DECODE(D.creat_sys_cd,'02',tot_recordCnt,0) sys_recordCnt02
							, DECODE(D.creat_sys_cd,'03',1,0) sys_folderCnt03
							, DECODE(D.creat_sys_cd,'03',tot_recordCnt,0) sys_recordCnt03
							, DECODE(D.creat_sys_cd,'04',1,0) sys_folderCnt04
							, DECODE(D.creat_sys_cd,'04',tot_recordCnt,0) sys_recordCnt04
						FROM (
							(
								SELECT A.record_center_id, A.cr_report_org_cd, A.creat_sys_cd, A.state_div_cd, A.cr_report_infrm_flag
									, (SELECT COUNT(1) FROM TB_CRRECORD C WHERE C.record_center_id=B.record_center_id AND C.folder_recv_seq=B.folder_recv_seq) tot_recordCnt
								FROM  TB_CRREPORT A
									, TB_CRFOLDER B
								WHERE B.record_center_id = #recordCenterId:VARCHAR#
								<isNotEmpty prepend="AND" property="crReportOrgCd">
									B.cr_report_org_cd = #crReportOrgCd:VARCHAR#
								</isNotEmpty>
								AND   B.creat_sys_cd IN ('01','02','04')
								<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="">
									( ( B.cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND B.cr_report_infrm_flag = '0' )
										OR ( B.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND B.cr_report_infrm_flag IN ('1','2') ) )
								</isEqual>
								<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="0">
									B.cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND B.cr_report_infrm_flag = '0'
								</isEqual>
								<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="1">
									B.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND B.cr_report_infrm_flag IN ('1','2')
								</isEqual>
								AND   A.record_center_id = B.record_center_id
								AND   A.cr_report_yyyy = B.cr_report_yyyy
								AND   A.cr_report_org_cd = B.cr_report_org_cd
								AND   A.creat_sys_cd = B.creat_sys_cd
								AND   A.cr_report_sno = B.cr_report_sno
							)
							UNION ALL
							(
								SELECT A.record_center_id, A.cr_report_org_cd, A.creat_sys_cd, '08' state_div_cd, A.cr_report_infrm_flag
									, (SELECT COUNT(1) FROM TB_CRRECORD C WHERE C.record_center_id=A.record_center_id AND C.folder_recv_seq=A.folder_recv_seq) tot_recordCnt
								FROM  TB_CRFOLDER A
								WHERE A.record_center_id = #recordCenterId:VARCHAR#
								<isNotEmpty prepend="AND" property="crReportOrgCd">
									A.cr_report_org_cd = #crReportOrgCd:VARCHAR#
								</isNotEmpty>
								AND   A.creat_sys_cd = '03'
								<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="">
									( ( A.reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND A.cr_report_infrm_flag = '0' )
										OR ( A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2') ) )
								</isEqual>
								<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="0">
									A.reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND A.cr_report_infrm_flag = '0'
								</isEqual>
								<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="1">
									A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2')
								</isEqual>
							)
						) D
					) E
					GROUP BY E.record_center_id, E.cr_report_org_cd, E.creat_sys_cd
				) F
				ORDER BY F.record_center_id, F.cr_report_org_cd   
            ) I
            WHERE ROWNUM <![CDATA[<=]]> #pagedEnd:NUMBER#
        ) J
        WHERE J.rnum <![CDATA[>=]]> #pagedStart:NUMBER#
	</select>
	
	<!--
		기록물인수>연계인수>생산현황통보>생산현황통보 통보대상기록물철상세정보조회(COUNT)
	-->
	<select id="countFindCreatStateApprFolder" parameterClass="rms.transf.offer.domain.StateAppr" resultClass="long">
		SELECT COUNT(1)
		FROM (
			(
				SELECT A.record_center_id, A.org_cd, A.folder_recv_seq, A.creat_yyyy, A.title, A.presv_term_cd, A.erecord_flag, A.cr_report_infrm_flag
				FROM  TB_CRREPORT B
				    , TB_CRFOLDER A
				WHERE B.record_center_id = #recordCenterId:VARCHAR#
				AND   B.cr_report_org_cd = #crReportOrgCd:VARCHAR#
				AND   A.creat_sys_cd IN ('01','02','04')
				<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="">
					( ( A.cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag = '0' )
						OR ( A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2') ) )
				</isEqual>
				<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="0">
					A.cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag = '0'
				</isEqual>
				<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="1">
					A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2')
				</isEqual>
				<isNotEmpty prepend="AND" property="creatYyyy">	 			
				   	A.creat_yyyy = #creatYyyy:VARCHAR#
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="clssId">
					(A.clss_div_cd = #clssDivCd:VARCHAR# AND A.clss_id = #clssId:VARCHAR#)
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="presvTermCd">
				 	A.presv_term_cd = #presvTermCd:VARCHAR#
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="title">
					(A.title LIKE #title:VARCHAR# OR A.sub_title LIKE #title:VARCHAR#)
				</isNotEmpty>
				AND   A.record_center_id = B.record_center_id
				AND   A.cr_report_yyyy = B.cr_report_yyyy
				AND   A.cr_report_org_cd = B.cr_report_org_cd
				AND   A.creat_sys_cd = B.creat_sys_cd
				AND   A.cr_report_sno = B.cr_report_sno
			)
			UNION ALL
			(
				SELECT A.record_center_id, A.org_cd, A.folder_recv_seq, A.creat_yyyy, A.title, A.presv_term_cd, A.erecord_flag, A.cr_report_infrm_flag
				FROM  TB_CRFOLDER A
				WHERE A.record_center_id = #recordCenterId:VARCHAR#
				AND   A.cr_report_org_cd = #crReportOrgCd:VARCHAR#
				AND   A.creat_sys_cd = '03'
				<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="">
					( ( A.reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND A.cr_report_infrm_flag = '0' )
						OR ( A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2') ) )
				</isEqual>
				<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="0">
					A.reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND A.cr_report_infrm_flag = '0'
				</isEqual>
				<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="1">
					A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2')
				</isEqual>
				<isNotEmpty prepend="AND" property="creatYyyy">	 			
				   	A.creat_yyyy = #creatYyyy:VARCHAR#
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="clssId">
					(A.clss_div_cd = #clssDivCd:VARCHAR# AND A.clss_id = #clssId:VARCHAR#)
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="presvTermCd">
				 	A.presv_term_cd = #presvTermCd:VARCHAR#
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="title">
					(A.title LIKE #title:VARCHAR# OR A.sub_title LIKE #title:VARCHAR#)
				</isNotEmpty>
			)
		) C
	</select>
	
	<!--
		기록물인수>연계인수>생산현황통보>생산현황통보 통보대상기록물철상세정보조회
	-->
	<select id="findCreatStateApprFolder" parameterClass="rms.transf.offer.domain.StateAppr"  resultMap="creatStateApprFolderList-result">
        SELECT J.*
        FROM (
            SELECT ROWNUM AS rnum
                   , I.*
            FROM (
				SELECT C.record_center_id
					, (SELECT Z.record_center_nm FROM TB_STRECORDCENTER Z WHERE Z.record_center_id=C.record_center_id) record_center_nm
					, C.folder_recv_seq
					, C.org_cd
					, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=C.record_center_id AND Z.org_cd=C.org_cd) org_nm
					, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=C.record_center_id AND Z.org_cd=C.org_cd) org_abbr_nm
					, C.creat_yyyy
					, C.title
					, C.presv_term_cd
					, (CASE WHEN C.presv_term_cd = '01' THEN '1년' WHEN C.presv_term_cd = '03' THEN '3년' WHEN C.presv_term_cd = '05' THEN '5년'
		                    WHEN C.presv_term_cd = '10' THEN '10년' WHEN C.presv_term_cd IN ('20','25') THEN '30년' WHEN C.presv_term_cd = '30' THEN '준영구'
		                    WHEN C.presv_term_cd = '40' THEN '영구' ELSE '' END) presv_term_nm
					, C.erecord_flag
					, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD23' AND Z.com_cd=C.erecord_flag) erecord_flag_nm
					, C.cr_report_infrm_flag
					, DECODE(C.cr_report_infrm_flag,'1','통보(온라인)','2','통보(오프라인)','미통보') cr_report_infrm_flag_nm  
				FROM (
					(
						SELECT A.record_center_id, A.org_cd, A.folder_recv_seq, A.creat_yyyy, A.title, A.presv_term_cd, A.erecord_flag, A.cr_report_infrm_flag
						FROM  TB_CRREPORT B
							, TB_CRFOLDER A
						WHERE B.record_center_id = #recordCenterId:VARCHAR#
						AND   B.cr_report_org_cd = #crReportOrgCd:VARCHAR#
						AND   A.creat_sys_cd IN ('01','02','04')
						<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="">
							( ( A.cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag = '0' )
								OR ( A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2') ) )
						</isEqual>
						<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="0">
							A.cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag = '0'
						</isEqual>
						<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="1">
							A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2')
						</isEqual>
						<isNotEmpty prepend="AND" property="creatYyyy">	 			
							A.creat_yyyy = #creatYyyy:VARCHAR#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="clssId">
							(A.clss_div_cd = #clssDivCd:VARCHAR# AND A.clss_id = #clssId:VARCHAR#)
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="presvTermCd">
							A.presv_term_cd = #presvTermCd:VARCHAR#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="title">
							(A.title LIKE #title:VARCHAR# OR A.sub_title LIKE #title:VARCHAR#)
						</isNotEmpty>
						AND   A.record_center_id = B.record_center_id
						AND   A.cr_report_yyyy = B.cr_report_yyyy
						AND   A.cr_report_org_cd = B.cr_report_org_cd
						AND   A.creat_sys_cd = B.creat_sys_cd
						AND   A.cr_report_sno = B.cr_report_sno
					)
					UNION ALL
					(
						SELECT A.record_center_id, A.org_cd, A.folder_recv_seq, A.creat_yyyy, A.title, A.presv_term_cd, A.erecord_flag, A.cr_report_infrm_flag
						FROM  TB_CRFOLDER A
						WHERE A.record_center_id = #recordCenterId:VARCHAR#
						AND   A.cr_report_org_cd = #crReportOrgCd:VARCHAR#
						AND   A.creat_sys_cd = '03'
						<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="">
							( ( A.reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND A.cr_report_infrm_flag = '0' )
								OR ( A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2') ) )
						</isEqual>
						<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="0">
							A.reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND A.cr_report_infrm_flag = '0'
						</isEqual>
						<isEqual prepend="AND" property="crReportInfrmFlag" compareValue="1">
							A.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND A.cr_report_infrm_flag IN ('1','2')
						</isEqual>
						<isNotEmpty prepend="AND" property="creatYyyy">	 			
							A.creat_yyyy = #creatYyyy:VARCHAR#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="clssId">
							(A.clss_div_cd = #clssDivCd:VARCHAR# AND A.clss_id = #clssId:VARCHAR#)
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="presvTermCd">
							A.presv_term_cd = #presvTermCd:VARCHAR#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="title">
							(A.title LIKE #title:VARCHAR# OR A.sub_title LIKE #title:VARCHAR#)
						</isNotEmpty>
					)
				) C
				ORDER BY C.record_center_id, C.org_cd, C.folder_recv_seq
            ) I
            WHERE ROWNUM <![CDATA[<=]]> #pagedEnd:NUMBER#
        ) J
        WHERE J.rnum <![CDATA[>=]]> #pagedStart:NUMBER#
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 통보파일정보 조회(통보팝업)
	 -->
	<select id="findCreatStateApprFileList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findStateApprFileList-result">
		SELECT	a.record_center_id, a.cr_report_infrm_creat_yyyy, 
						MAX(a.infrm_mst_file_nm) AS infrm_mst_file_full_nm, 
						<!--cubrid SUBSTR(MAX(a.infrm_mst_file_nm),(INSTR(MAX(a.infrm_mst_file_nm),'/',-1,1))+1) AS infrm_mst_file_nm,-->
						SUBSTR(MAX(a.infrm_mst_file_nm),(INSTR(MAX(a.infrm_mst_file_nm),'/',-1))+1) AS infrm_mst_file_nm,
						MAX(a.infrm_take_file_nm) AS infrm_take_file_full_nm,
						<!--cubrid SUBSTR(MAX(a.infrm_take_file_nm),(INSTR(MAX(a.infrm_take_file_nm),'/',-1,1))+1) AS infrm_take_file_nm, -->
						SUBSTR(MAX(a.infrm_take_file_nm),(INSTR(MAX(a.infrm_take_file_nm),'/',-1))+1) AS infrm_take_file_nm, 
						MAX(a.infrm_dtl_file_nm) AS infrm_dtl_file_full_nm,
						<!--cubrid SUBSTR(MAX(a.infrm_dtl_file_nm),(INSTR(MAX(a.infrm_dtl_file_nm),'/',-1,1))+1) AS infrm_dtl_file_nm, -->
						SUBSTR(MAX(a.infrm_dtl_file_nm),(INSTR(MAX(a.infrm_dtl_file_nm),'/',-1))+1) AS infrm_dtl_file_nm, 
						MAX(a.infrm_dfile_file_nm) AS infrm_dfile_file_full_nm,
						<!--cubrid SUBSTR(MAX(a.infrm_dfile_file_nm),(INSTR(MAX(a.infrm_dfile_file_nm),'/',-1,1))+1) AS infrm_dfile_file_nm,-->
						SUBSTR(MAX(a.infrm_dfile_file_nm),(INSTR(MAX(a.infrm_dfile_file_nm),'/',-1))+1) AS infrm_dfile_file_nm,
						MAX(a.infrm_end_file_nm) AS infrm_end_file_full_nm,
						<!--cubrid SUBSTR(MAX(a.infrm_end_file_nm),(INSTR(MAX(a.infrm_end_file_nm),'/',-1,1))+1) AS infrm_end_file_nm,-->
						SUBSTR(MAX(a.infrm_end_file_nm),(INSTR(MAX(a.infrm_end_file_nm),'/',-1))+1) AS infrm_end_file_nm,
						DECODE(MAX(a.cr_report_infrm_flag),'1','통보(온라인)','2','통보(오프라인)','0','미통보') AS cr_report_infrm_flag_nm,
						MAX(cr_report_infrm_dtime) AS cr_report_infrm_dtime,
						DECODE(MAX(b.record_center_type_cnt),1,'1','2') AS record_center_type
		FROM
						(
						SELECT	'1' AS gubun, a.record_center_id, a.cr_report_infrm_creat_yyyy,
										DECODE(a.cr_report_infrm_file_type,'MST', a.cr_report_infrm_file_nm) AS infrm_mst_file_nm,
										DECODE(a.cr_report_infrm_file_type,'TAKE', a.cr_report_infrm_file_nm) AS infrm_take_file_nm,
										DECODE(a.cr_report_infrm_file_type,'DTL', a.cr_report_infrm_file_nm) AS infrm_dtl_file_nm,
										DECODE(a.cr_report_infrm_file_type,'DFILE', a.cr_report_infrm_file_nm) AS infrm_dfile_file_nm,
										DECODE(a.cr_report_infrm_file_type,'END', a.cr_report_infrm_file_nm) AS infrm_end_file_nm,
										a.cr_report_infrm_flag, a.cr_report_infrm_dtime
						FROM 		TB_CRINFRMFILE a,
										(SELECT 	record_center_id, record_center_cd
										FROM 		TB_STRECORDCENTER
										WHERE 	record_center_id = #recordCenterId:VARCHAR#
			  							) b
						WHERE  	a.record_center_id = b.record_center_cd
						AND	    	a.cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
						AND			a.hupper_record_center_flag = '2'
						) a,
						(SELECT	'1' AS gubun, COUNT(1) AS record_center_type_cnt
						FROM		TB_STRECORDCENTER
						) b
		WHERE 	a.gubun = b.gubun
		GROUP BY a.record_center_id, a.cr_report_infrm_creat_yyyy
	</select>
	
	<!--
		기록물인수>연계인수>생산현황통보>생산현황통보 통보대상기록물철상세정보조회(COUNT)
	-->
	<select id="countCreatStateApprInfrmFormPagedList" parameterClass="rms.transf.offer.domain.CrInfrmForm" resultClass="long">
		SELECT COUNT(1)
		FROM (
		    SELECT record_center_id
		    	, infrm_yyyy
		    	, infrm_form_type_cd
		    	, (SELECT com_cd_nm FROM TB_ZZCOMCD WHERE com_type_cd='CR03' AND com_cd=infrm_form_type_cd) AS infrm_form_type_nm
		    	, file_creat_state
		    	, (CASE WHEN file_creat_state='0' THEN '미생성' WHEN file_creat_state='1' THEN '생성중' WHEN file_creat_state='2' THEN '생성완료' END) AS file_creat_state_nm
		    	, file_nm
		    	, file_path
		    	, file_creat_dtime
		    FROM  TB_CRINFRMFORM
		    WHERE record_center_id = #recordCenterId:VARCHAR#
			AND   infrm_yyyy = #infrmYyyy:VARCHAR#
		    ORDER BY record_center_id, infrm_yyyy, infrm_form_type_cd
		) 
	</select>
	
		<!--
		기록물인수>연계인수>생산현황통보현황  생산현황통보현황 목록조회
	-->
	<select id="countFindCreatStateApprState" parameterClass="rms.transf.offer.domain.StateAppr" resultClass="long">
	 	SELECT 	COUNT(1)
		FROM
						(SELECT	cr_report_infrm_yyyy
						FROM 
										(
										SELECT	cr_report_infrm_yyyy, cr_report_org_cd
										FROM  		TB_CRFOLDER 
										WHERE 	cr_report_infrm_flag IN ('1','2')
										<isNotEmpty prepend="AND" property="recordCenterId">
														record_center_id = #recordCenterId:VARCHAR#
										</isNotEmpty>
										<isNotEmpty prepend="AND" property="crReportInfrmYyyy">
							  							cr_report_infrm_yyyy = #crReportInfrmYyyy:VARCHAR#
							  			</isNotEmpty>
										GROUP BY cr_report_infrm_yyyy, cr_report_org_cd
										)
						GROUP BY cr_report_infrm_yyyy
		)
	</select>
	
	<!--
		기록물인수>연계인수>생산현황통보현황  생산현황통보현황 목록조회
	-->
	<select id="findCreatStateApprState" parameterClass="rms.transf.offer.domain.StateAppr"  resultMap="creatStateApprStateList-result">
        SELECT J.*
        FROM (
            SELECT ROWNUM AS rnum
                   , I.*
            FROM (
                SELECT    cr_report_infrm_yyyy,
                        COUNT(cr_report_org_cd) AS cr_report_org_cd_cnt, 
                        SUM(folder_cnt) AS folder_cnt,
                        SUM(record_cnt) AS record_cnt,
                        MAX(cr_report_infrm_user_id) AS cr_report_infrm_user_id,
                        MAX(cr_report_infrm_user_nm) AS cr_report_infrm_user_nm, 
                        SUBSTR(MAX(cr_report_infrm_dtime),1,8) AS cr_report_infrm_dtime,
                        DECODE(MAX(cr_report_infrm_flag),'1','통보(온라인)','2','통보(오프라인)','미통보') AS cr_report_infrm_flag_nm,
                        DECODE(MAX(cr_report_infrm_state_flag), '1', '오류', '2', '반려', '3', '인수', '') as cr_report_infrm_state_flag_nm
                FROM
                        (
                        SELECT    cr_report_infrm_yyyy,
                                cr_report_org_cd,
                                COUNT(folder_recv_seq) AS folder_cnt, 
                                SUM(record_cnt) AS record_cnt,
                                MAX(cr_report_infrm_user_id) AS cr_report_infrm_user_id, 
                                MAX(cr_report_infrm_user_nm) AS cr_report_infrm_user_nm,
                                MAX(cr_report_infrm_dtime) AS cr_report_infrm_dtime, 
                                MAX(cr_report_infrm_flag) AS cr_report_infrm_flag,
                                MAX(cr_report_infrm_state_flag) AS cr_report_infrm_state_flag
                        FROM
                                (
                                SELECT    a.record_center_id, 
                                        a.folder_recv_seq, 
                                        MAX(a.cr_report_org_cd) AS cr_report_org_cd,
                                        COUNT(b.record_recv_seq) AS record_cnt,
                                        MAX(cr_report_infrm_flag) AS cr_report_infrm_flag,
                                        MAX(cr_report_infrm_state_flag) AS cr_report_infrm_state_flag,
                                        MAX(a.cr_report_infrm_yyyy) AS cr_report_infrm_yyyy,
                                        MAX(cr_report_infrm_user_nm) AS cr_report_infrm_user_nm,
                                        MAX(cr_report_infrm_user_id) AS cr_report_infrm_user_id,
                                        MAX(cr_report_infrm_dtime) AS cr_report_infrm_dtime
                                FROM    TB_CRFOLDER a, TB_CRRECORD b
                                WHERE    a.record_center_id = b.record_center_id
                                AND        a.folder_recv_seq = b.folder_recv_seq
                                AND        a.cr_report_infrm_flag IN ('1','2')
                                <isNotEmpty prepend="AND" property="recordCenterId">
                                        a.record_center_id = #recordCenterId:VARCHAR#
                                </isNotEmpty>
                                <isNotEmpty prepend="AND" property="crReportInfrmYyyy">
                                        a.cr_report_infrm_yyyy = #crReportInfrmYyyy:VARCHAR#
                                </isNotEmpty>

                                GROUP BY a.record_center_id, a.folder_recv_seq
                                )
                        GROUP BY cr_report_infrm_yyyy, cr_report_org_cd
                        )
                GROUP BY cr_report_infrm_yyyy
                ORDER BY cr_report_infrm_yyyy
            ) I
            WHERE ROWNUM <![CDATA[<=]]> #pagedEnd:NUMBER#
        ) J
        WHERE J.rnum <![CDATA[>=]]> #pagedStart:NUMBER#
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 통보내역상세목록조회팝업(SELECT)
	 -->
	<select id="findCreatStateApprRecvInfo" parameterClass="rms.transf.offer.domain.StateApprInfo" resultMap="findCreatStateApprRecvInfo-result">
		SELECT	a.record_center_id,  a.cr_report_org_cd,  
						a.cr_report_sno, a.cr_report_yyyy, 
			   			a.state_div_cd, a.recv_ymd, 
			   			NVL(b.com_cd_nm,'미접수') AS state_div_cd_nm,
			   			NVL(a.recv_folder_cnt,'0') AS recv_folder_cnt, 
			   			NVL(a.recv_record_cnt,'0') AS recv_record_cnt,
			   			NVL(a.error_recv_folder_cnt,'0') AS error_recv_folder_cnt, 
			   			NVL(a.error_recv_record_cnt,'0') AS error_recv_record_cnt,
			   			NVL(a.sucess_recv_folder_cnt,'0') AS sucess_recv_folder_cnt, 
			   			NVL(a.sucess_recv_record_cnt,'0') AS sucess_recv_record_cnt,
			   			NVL(a.rjct_folder_cnt,'0') AS rjct_folder_cnt, 
			   			NVL(a.rjct_record_cnt,'0') AS rjct_record_cnt,
			   			NVL(a.fin_folder_cnt,'0') AS fin_folder_cnt, 
			   			NVL(a.fin_record_cnt,'0') AS fin_record_cnt
		FROM 			(
						SELECT	a.record_center_id, a.cr_report_yyyy, a.cr_report_org_cd, 
				   						a.cr_report_sno, MAX(a.state_div_cd) AS state_div_cd,
										MAX(a.recv_ymd) AS recv_ymd,
				   						COUNT(b.folder_recv_seq) AS recv_folder_cnt, 
				   						SUM(b.recv_record_cnt) AS recv_record_cnt, 
				   						SUM(DECODE(b.exam_rslt_cd,'2',1,0)) AS error_recv_folder_cnt,
				   						SUM(b.error_recv_record_cnt) AS error_recv_record_cnt,
				   						SUM(DECODE(b.exam_rslt_cd,'1',1,null,1,'',1,0)) AS sucess_recv_folder_cnt,
				   						SUM(b.sucess_recv_record_cnt) AS sucess_recv_record_cnt,
			  	   						SUM(DECODE(b.rjct_flag,'1',1,0)) AS rjct_folder_cnt,
				   						SUM(b.rjct_record_cnt) AS rjct_record_cnt,
				   						SUM(DECODE(b.take_fin_flag,'1',1,0)) AS fin_folder_cnt,
				   						SUM(b.fin_record_cnt) AS fin_record_cnt
						FROM   	TB_CRREPORT a,
										(
										SELECT	a.record_center_id,
						   								a.cr_report_yyyy, a.cr_report_org_cd, 
												   		a.cr_report_sno, a.folder_recv_seq, 
												   		MAX(a.exam_rslt_cd) AS exam_rslt_cd, 
												  	 	MAX(a.error_flag) AS error_flag, 
												  	 	MAX(a.rjct_flag) AS rjct_flag,
												   		MAX(a.take_fin_flag) AS take_fin_flag,
												   		COUNT(b.record_recv_seq) AS recv_record_cnt,
												   		SUM(DECODE(a.exam_rslt_cd,'2',1,0)) AS error_recv_record_cnt,
												   		SUM(DECODE(a.exam_rslt_cd,'1',1,null,1,'',1,0)) AS sucess_recv_record_cnt,
												   		SUM(DECODE(a.rjct_flag,'1',1,0)) AS rjct_record_cnt,
												   		SUM(DECODE(a.take_fin_flag,'1',1,0)) AS fin_record_cnt
										FROM 		TB_CRFOLDER a, TB_CRRECORD b
										WHERE 	a.record_center_id = #recordCenterId:VARCHAR#
										<isNotEmpty prepend="AND" property="crReportOrgCd">
														a.cr_report_org_cd = #crReportOrgCd:VARCHAR#
										</isNotEmpty>
										AND 			a.creat_sys_cd = #creatSysCd:VARCHAR#
										AND			a.record_center_id = b.record_center_id
										AND			a.folder_recv_seq = b.folder_recv_seq
										GROUP BY a.record_center_id, a.cr_report_yyyy, a.cr_report_org_cd, a.cr_report_sno, a.folder_recv_seq
										) b
						WHERE	  	a.record_center_id = #recordCenterId:VARCHAR#
						<isNotEmpty prepend="AND" property="crReportOrgCd">
										a.cr_report_org_cd =#crReportOrgCd:VARCHAR#
						</isNotEmpty>
						AND		  a.creat_sys_cd = #creatSysCd:VARCHAR#
						AND		  a.record_center_id = b.record_center_id
						AND		  a.cr_report_yyyy = b.cr_report_yyyy
						AND		  a.cr_report_org_cd = b.cr_report_org_cd
						AND		  a.cr_report_sno = b.cr_report_sno
						GROUP BY a.record_center_id, a.cr_report_yyyy, a.cr_report_org_cd, a.cr_report_sno
						) a,
						(SELECT	com_cd, com_cd_nm
						FROM 		TB_ZZCOMCD
						WHERE 	com_type_cd = 'TK08'
						) b
		WHERE 	a.record_center_id = #recordCenterId:VARCHAR#
		<isNotEmpty prepend="AND" property="crReportOrgCd">
						a.cr_report_org_cd = #crReportOrgCd:VARCHAR#
		</isNotEmpty>
		AND	  		a.state_div_cd = b.com_cd(+)
		ORDER BY a.record_center_id, a.cr_report_org_cd, a.cr_report_yyyy, a.cr_report_sno
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 통보파일작성이 가능한 상태인지 체크
				수정 -> 통합 온나라 때문에 04 추가 2009 0305
	 -->
	<select id="findStateApprInfrmPossCheck" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultClass="int">
		SELECT	COUNT(1)
		FROM 		TB_CRREPORT
		<![CDATA[  
		WHERE 	state_div_cd <> '08'  
		]]>
		AND 			creat_sys_cd IN ('01', '02', '03','04')
		AND			record_center_id  =  #recordCenterId:VARCHAR#
		<![CDATA[	
		AND			cr_report_yyyy  <= #crReportInfrmCreatYyyy:VARCHAR# 
		]]>
	</select>	
	
		<!--
		기록물인수>연계인수>기록관갯수(단일기록관인지 공동형기록관인지 체크)
	-->
	<select id="findRecordCenterCnt"  resultClass="int">
		SELECT	COUNT(record_center_cd) AS cnt
		FROM 		TB_STRECORDCENTER
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 이전통보내역 초기화(해당년도의 접수내역에서 통보flag 및 통보년도 초기화)
	 -->
	<update id="updateStateApprReportInfrmClearList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE 	TB_CRREPORT
		SET 			cr_report_infrm_flag = '0',
						cr_report_infrm_yyyy = '',
						cr_report_infrm_creat_yyyy  = ''
		WHERE 	record_center_id = #recordCenterId:VARCHAR#
		AND	  		cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
	</update>
	
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 이전통보내역 초기화(기록물등록 철정보(tb_crfolder)에 통보flag 및 통보년도 초기화)
	 -->
	<update id="updateStateApprRmsFolderInfrmClearList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE 	TB_CRFOLDER
		SET 			cr_report_infrm_flag = '0',
						cr_report_infrm_yyyy = '',
						cr_report_infrm_creat_yyyy = '', 
						cr_report_infrm_dtime = '', 
						cr_report_infrm_user_id = '', 
						cr_report_infrm_user_nm = ''
		WHERE 	record_center_id = #recordCenterId:VARCHAR#
		AND	  		cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
	</update>	
	
		<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 이전통보내역 삭제(파일내역삭제)
	 -->
	<delete id="deleteStateApprInfrmFileInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		DELETE 	FROM TB_CRINFRMFILE
		WHERE  	record_center_id = #recordCenterCd:VARCHAR#
		AND	    	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		AND			hupper_record_center_flag = #hupperRecordCenterFlag:VARCHAR#
	</delete>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 통보파일정보 저장
	 -->
	<insert id="creatStateApprInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		INSERT INTO TB_CRINFRMFILE
		(
			record_center_id, 	cr_report_infrm_creat_yyyy, 	cr_report_infrm_file_type, 		cr_report_infrm_file_nm, 
			reg_dtime, 				cr_report_infrm_flag,					hupper_record_center_flag
		) VALUES (
			#recordCenterCd:VARCHAR#, 	#crReportInfrmCreatYyyy:VARCHAR#, 	#crReportInfrmFileType:VARCHAR#, 	#crReportInfrmFileNm:VARCHAR#, 
			<!--cubrid TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'), '0', #hupperRecordCenterFlag:VARCHAR#-->
			TO_CHAR(sys_datetime, 'YYYYMMDDHH24MISS'), '0', #hupperRecordCenterFlag:VARCHAR#
		)
	</insert>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 기록물철생산내역(MST) 목록조회(SELECT)
				수정 -> 통합 온나라 때문에 04 추가 2009 0305
	 -->
	<select id="findStateApprFolderInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findStateApprFolderInfrmMstList-result">
		SELECT record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy
		     , folder_reg_seq, ho_no, title, folder_type_div_cd, folder_close_yyyy
		     , presv_term_cd, creat_user_nm, creat_purps, folder_recv_seq
		FROM ( 
			(
				SELECT record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy
				     , folder_reg_seq, ho_no, title, folder_type_div_cd, SUBSTR(folder_close_dtime,1,4) AS folder_close_yyyy
					 , presv_term_cd, creat_user_nm, '' creat_purps, folder_recv_seq
				FROM  TB_CRFOLDER
				WHERE record_center_id = #recordCenterId:VARCHAR#
				AND   creat_sys_cd IN ('01','02','04')
				AND ( ( cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR# AND (cr_report_infrm_flag IS NULL OR cr_report_infrm_flag = '0') )
					OR ( cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND cr_report_infrm_flag IN ('1','2') ) )
			)
			UNION ALL
			(
				SELECT record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy
				     , folder_reg_seq, ho_no, title, folder_type_div_cd, SUBSTR(folder_close_dtime,1,4) AS folder_close_yyyy
					 , presv_term_cd, creat_user_nm, '' creat_purps, folder_recv_seq
				FROM  TB_CRFOLDER
				WHERE record_center_id = #recordCenterId:VARCHAR#
				AND   creat_sys_cd = '03'
				AND ( ( reg_dtime <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531' AND (cr_report_infrm_flag IS NULL OR cr_report_infrm_flag = '0') )
					OR ( cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR# AND cr_report_infrm_flag IN ('1','2') ) )
			)
		)
		ORDER BY record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy, folder_reg_seq, ho_no
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 기록물철인수인계내역(TAKE) 목록조회(SELECT)
	 -->
	<select id="findStateApprTakeTakovrInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findStateApprFolderInfrmTakeList-result">
		SELECT A.record_center_id, A.creat_sys_cd, A.org_cd, A.clss_id, A.creat_yyyy
		     , A.folder_reg_seq, A.ho_no, LPAD(B.sno,6,'0') as take_takovr_sno, B.take_takovr_div_cd, B.take_takovr_org_cd
			 , B.take_takovr_creat_dtime
		FROM  TB_CRFOLDER A
		    , TB_CRFOLDERTAKETAKOVR B
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.folder_recv_seq = #folderRecvSeq:VARCHAR#
		AND   A.record_center_id = B.record_center_id
		AND   A.folder_recv_seq = B.folder_recv_seq
		ORDER BY B.record_center_id, B.folder_recv_seq, B.sno
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 기록물건생산내역(DTL) 목록조회(SELECT)
	 -->
	<select id="findStateApprRecordInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findStateApprRecordInfrmDtlList-result">
		SELECT B.record_center_id, B.creat_sys_cd, B.org_cd, B.record_reg_div_cd, SUBSTR(B.creat_reg_dtime,1,12) AS creat_reg_dtime
		     , B.creat_reg_no, B.dtch_reg_no, B.title, B.aprov_pos_rank_nm, B.duty_chrgr_nm
			 , SUBSTR(B.enforc_ymd, 1, 8) enforc_ymd, B.erecord_flag
			 , A.creat_sys_cd||'-'||A.org_cd||'-'||A.clss_id||'-'||A.creat_yyyy||'-'||A.folder_reg_seq||'-'||A.ho_no AS infrm_folder_clss_no
			 , B.spcl_record_type, B.open_div_cd, B.open_grade, B.oper_read_range_cd
		FROM  TB_CRFOLDER A
		    , TB_CRRECORD B
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.folder_recv_seq = #folderRecvSeq:VARCHAR#
		AND   A.record_center_id = B.record_center_id
		AND   A.folder_recv_seq = B.folder_recv_seq
		ORDER BY A.record_center_id, A.folder_recv_seq, B.record_center_id, B.org_cd, B.record_reg_div_cd, B.creat_yyyy, B.creat_reg_no, B.dtch_reg_no
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 기록물문서데이터(본문,첨부)(DFILE)목록조회(SELECT)
	 -->
	<select id="findStateApprAttachInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findStateApprRecordInfrmDfileList-result">
		SELECT A.record_center_id, A.creat_sys_cd, A.org_cd, SUBSTR(A.creat_reg_dtime,1,12) AS creat_reg_dtime, A.creat_reg_no
			, A.dtch_reg_no, B.doc_type_cd, MAX(A.record_reg_div_cd) AS record_reg_div_cd, LPAD(COUNT(1),6,'0') file_cnt, LPAD(SUM(B.file_size),13,'0') file_size 
		FROM  TB_CRRECORD A
			, TB_CRATTACHFILE B
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.folder_recv_seq = #folderRecvSeq:VARCHAR#
		AND   B.record_center_Id=A.record_center_id
		AND   B.record_recv_seq=A.record_recv_seq
		GROUP BY A.record_center_id, A.creat_sys_cd, A.org_cd, A.creat_reg_dtime, A.creat_reg_no, A.dtch_reg_no, B.doc_type_cd
		ORDER BY A.record_center_id, A.creat_sys_cd, A.org_cd, A.creat_reg_dtime, A.creat_reg_no, A.dtch_reg_no, B.doc_type_cd
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보파일생성 후 접수내역에 파일생성년도 update
	 -->
	<update id="updateStateApprReportInfrmInfo" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE 	TB_CRREPORT
		SET 	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		WHERE 	record_center_id = #recordCenterId:VARCHAR#
		AND     cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#
		AND	  	cr_report_infrm_flag = '0'
	</update>


	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보파일생성 후 철내역에 파일생성년도 update(전자문서_온나라정보 철정보(tb_crfolder))
				수정 -> 통합 온나라 때문에 04 추가 2009 0305
	 -->
	<update id="updateStateApprFolderRecvInfrmInfo" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE TB_CRFOLDER Z
		SET    cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		<!--cubrid WHERE (record_center_id, cr_report_yyyy, cr_report_org_cd, cr_report_sno)
		IN (
			SELECT record_center_id, cr_report_yyyy, cr_report_org_cd, cr_report_sno-->
		WHERE 
		EXISTS (
			SELECT 1
			FROM  TB_CRREPORT
			WHERE cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#
			AND   record_center_id = #recordCenterId:VARCHAR#
			AND	  creat_sys_cd IN ('01','02','04')
			AND   (cr_report_infrm_flag IS NULL OR cr_report_infrm_flag = '0')
			<!--cubrid-->
			AND   record_center_id = Z.record_center_id
			AND   cr_report_yyyy = Z.cr_report_yyyy
			AND   cr_report_org_cd = Z.cr_report_org_cd
			AND   cr_report_sno = Z.cr_report_sno
		)
	</update>
	

	<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보파일생성 후 철내역에 파일생성년도 update(기록관등록 철정보(tb_crfolder))
	 -->
	<update id="updateStateApprFolderRmsInfrmInfo" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE TB_CRFOLDER
		SET    cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		WHERE  record_center_id = #recordCenterId:VARCHAR#
		AND    creat_sys_cd = '03'
		AND    (cr_report_infrm_flag IS NULL OR cr_report_infrm_flag = '0')
		AND    reg_dtime  <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#||'0531'
	</update>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 통보처리(파일정보TB에 통보완료처리) => 1:온라인, 2:오프라인
	 -->
	<update id="updateStateApprInfrmEnd" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE	TB_CRINFRMFILE
		SET 	cr_report_infrm_flag =  #crReportInfrmFlag:VARCHAR#,
				<!--cubrid cr_report_infrm_dtime = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')-->
				cr_report_infrm_dtime = TO_CHAR(sys_datetime, 'YYYYMMDDHH24MISS')
		WHERE 	record_center_id = #recordCenterCd:VARCHAR#
		AND	  	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		AND		hupper_record_center_flag = #hupperRecordCenterFlag:VARCHAR#
	</update>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 통보처리(기록관등록 철정보(tb_crfolder)에 통보완료처리) => 1:온라인, 2:오프라인
	 -->
	<update id="updateCrFolderRmsInfrmEnd" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE 	TB_CRFOLDER
		SET 	cr_report_infrm_flag = #crReportInfrmFlag:VARCHAR#,
				cr_report_infrm_yyyy = TO_CHAR(SYSDATE,'YYYY'),
				cr_report_infrm_user_id = #crReportInfrmUserId:VARCHAR#,
				cr_report_infrm_user_nm = #crReportInfrmUserNm:VARCHAR#,
				<!--cubrid cr_report_infrm_dtime = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')-->
				cr_report_infrm_dtime = TO_CHAR(sys_datetime, 'YYYYMMDDHH24MISS')
		WHERE 	record_center_id = #recordCenterId:VARCHAR#
		AND	  	creat_sys_cd = '03'
		AND	  	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		AND   	cr_report_infrm_flag = '0'
	</update>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 통보처리(생산접수내역에 통보완료처리) => 1:온라인, 2:오프라인
	 -->
	<update id="updateCrReportInfrmEnd" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE 	TB_CRREPORT
		SET 	cr_report_infrm_flag = #crReportInfrmFlag:VARCHAR#,
				cr_report_infrm_yyyy = TO_CHAR(SYSDATE,'YYYY')
		WHERE 	record_center_id = #recordCenterId:VARCHAR#
		AND     cr_report_yyyy <![CDATA[ <= ]]> #crReportInfrmCreatYyyy:VARCHAR#
		AND	  	cr_report_infrm_flag = '0'
	</update>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>생산현황통보 통보처리(전자문서_온나라정보 철정보(tb_crfolder)에 통보완료처리) => 1:온라인, 2:오프라인
		수정 -> 통합 온나라 때문에 04 추가 2009 0305
	 -->
	<update id="updateCrFolderRecvInfrmEnd" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE 	TB_CRFOLDER Z
		SET 	cr_report_infrm_flag = #crReportInfrmFlag:VARCHAR#,
				cr_report_infrm_yyyy = TO_CHAR(SYSDATE,'YYYY'),
				cr_report_infrm_user_id = #crReportInfrmUserId:VARCHAR#,
				cr_report_infrm_user_nm = #crReportInfrmUserNm:VARCHAR#,
				<!--cubrid cr_report_infrm_dtime = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')-->
				cr_report_infrm_dtime = TO_CHAR(sys_datetime, 'YYYYMMDDHH24MISS')
		<!--cubrid WHERE 	(record_center_id, cr_report_yyyy, cr_report_org_cd, cr_report_sno)
		IN (
			SELECT	record_center_id, cr_report_yyyy, cr_report_org_cd, cr_report_sno-->
		WHERE 
		EXISTS (
			SELECT	1
			FROM  	TB_CRREPORT
			WHERE 	record_center_id = #recordCenterId:VARCHAR#
			AND	  	creat_sys_cd IN ('01','02','04')
			AND   	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
			<!--cubrid-->
			AND 	record_center_id = Z.record_center_id
			AND 	cr_report_yyyy = Z.cr_report_yyyy
			AND 	cr_report_org_cd = Z.cr_report_org_cd
			AND  	cr_report_sno = Z.cr_report_sno
		)
	</update>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관포함생산현황통보 sendlist xml 생성시 생산통보파일리스트find
	 -->
	<select id="findUnderDeptInfrmFileList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findUnderDeptInfrmFileList-result">
		SELECT		cr_report_infrm_file_nm
		FROM
		(
			SELECT	1 AS gubun, cr_report_infrm_file_nm
			FROM 		TB_CRINFRMFILE
			WHERE  		record_center_id = #recordCenterCd:VARCHAR#
			AND			cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
			AND			hupper_record_center_flag = #hupperRecordCenterFlag:VARCHAR#
			AND			cr_report_infrm_file_nm not LIKE '%_END%'
			UNION ALL
			SELECT	1 AS gubun, cr_report_infrm_file_nm
			FROM 		TB_CRINFRMFILE
			WHERE  		record_center_id = #recordCenterCd:VARCHAR#
			AND			cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
			AND			hupper_record_center_flag = #hupperRecordCenterFlag:VARCHAR#
			AND			cr_report_infrm_file_nm LIKE '%_END%'
		)
		ORDER BY gubun		
	</select>
	
	   <!--
		기록물인수>연계인수>소속기록관생산현황접수 기관코드정보find
	-->
	<select id="findHupperOrgCd" parameterClass="rms.transf.offer.domain.StateApprInfrmFile"  resultClass="string">
		SELECT	a.hupper_org_cd
		FROM 		tb_storg a,
			 			(
						SELECT	org_cd, record_center_id
						FROM	 	tb_stdept
						WHERE 	dept_cd = #sessionOrgCd:VARCHAR#
						) b
		WHERE a.org_cd = b.org_cd
		   AND a.record_center_id = b.record_center_id
	</select>	
	
	<!--
		기록물인수>연계인수>소속기록관생산현황접수 기록물형태 유효성체크
	-->
	<select id="findOfferFolderTypeDivCdCheck" parameterClass="rms.transf.offer.domain.CrInfrmFolder" resultClass="int">
		SELECT  COUNT(com_type_cd)
		FROM 	  TB_ZZCOMCD
		WHERE   com_type_cd = 'RD01'
		AND        com_cd = #folderTypeDivCd:VARCHAR#
	</select>
	
	<!--
		기록물인수>연계인수>소속기록관생산현황접수 중복철이 존재하는지 체크
	-->
	<select id="findOfferFolderDubCheck" parameterClass="rms.transf.offer.domain.CrInfrmFolder" resultClass="string">
		SELECT  	cr_report_infrm_creat_yyyy
		FROM     	TB_CRINFRMFOLDER
		WHERE   	record_center_id = #recordCenterId:VARCHAR#
		AND			creat_sys_cd = #creatSysCd:VARCHAR#
		AND        	org_cd = #orgCd:VARCHAR#
		AND        	clss_id = #clssId:VARCHAR#
		AND        	creat_yyyy = #creatYyyy:VARCHAR#
		AND        	folder_reg_seq = #folderRegSeq:VARCHAR#
		AND		  	ho_no = #hoNo:VARCHAR#
	</select>
	
		<!-- 
		기록물인수>연계인수>소속기록관포함생산현황접수 통보기록물철생산내역 저장
	 -->
	<insert id="creatCrInfrmFolder" parameterClass="rms.transf.offer.domain.CrInfrmFolder">
		INSERT INTO TB_CRINFRMFOLDER
		(
			record_center_id, 					creat_sys_cd, 				org_cd, 		clss_id, 									creat_yyyy, 
			folder_reg_seq, 						ho_no, 							title, 				folder_type_div_cd, 					folder_close_yyyy,
			presv_term_cd, 						creat_purps, 				reg_dtime, 	cr_report_infrm_creat_yyyy, 	cr_report_infrm_state,
			cr_report_infrm_result_state, cr_report_infrm_dtime, creat_user_nm_accum
		) VALUES (
			#recordCenterId:VARCHAR#,	 #creatSysCd:VARCHAR#, 	#orgCd:VARCHAR#, 												#clssId:VARCHAR#, 								#creatYyyy:VARCHAR#, 
			#folderRegSeq:VARCHAR#, 		#hoNo:VARCHAR#, 				#title:VARCHAR#, 													#folderTypeDivCd:VARCHAR#, 				#folderCloseYyyy:VARCHAR#,
			<!--cubrid #presvTermCd:VARCHAR#, 		#creatPurps:VARCHAR#, 		TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'), 	#crReportInfrmCreatYyyy:VARCHAR#, 	#crReportInfrmState:VARCHAR#,-->
                        #presvTermCd:VARCHAR#, 		#creatPurps:VARCHAR#, 		TO_CHAR(sys_datetime, 'YYYYMMDDHH24MISS'), 	#crReportInfrmCreatYyyy:VARCHAR#, 	#crReportInfrmState:VARCHAR#,
			#crReportInfromResultState:VARCHAR#, '', #creatUserNmAccum:VARCHAR#
		)
	</insert>
	
	<!--
		기록물인수>연계인수>소속기록관생산현황접수존재하는 기록물철인지 체크
	-->
	<select id="findOfferFolderExistCheck" parameterClass="rms.transf.offer.domain.CrInfrmFolder" resultClass="int">
		SELECT	COUNT(*) 
		FROM    	TB_CRINFRMFOLDER
		WHERE  	record_center_id 	= #recordCenterId:VARCHAR#
		AND			creat_sys_cd 		= #creatSysCd:VARCHAR#
		AND			org_cd             	= #orgCd:VARCHAR#
		AND	      	clss_id            	 	= #clssId:VARCHAR#
		AND	      	creat_yyyy        	= #creatYyyy:VARCHAR#
		AND	      	folder_reg_seq 	= #folderRegSeq:VARCHAR#
		AND	      	ho_no               	= #hoNo:VARCHAR#
	</select>
	
	<!-- 
		기록물인수>연계인수>소속기록관포함생산현황접수 통보기록물철인수인계내역 저장
	 -->
	<insert id="creatCrInfrmFolderTakeTakovr" parameterClass="rms.transf.offer.domain.CrInfrmFolderTakeTakovr">
		INSERT INTO TB_CRINFRMFOLDERTAKETAKOVR
		(
			record_center_id, 	creat_sys_cd,	org_cd, 				clss_id, 					creat_yyyy, 
			folder_reg_seq, 		ho_no,				take_takovr_sno, 	take_takovr_div_cd, 	take_takovr_org_cd, 
			take_takovr_creat_dtime
		) VALUES (
			#recordCenterId:VARCHAR#, 	#creatSysCd:VARCHAR#, 	#orgCd:VARCHAR#, 										#clssId:VARCHAR#, 					#creatYyyy:VARCHAR#, 
			#folderRegSeq:VARCHAR#, 		#hoNo:VARCHAR#, 				LPAD(#takeTakovrSno:VARCHAR#,6,'0'), 	#takeTakovrDivCd:VARCHAR#, 	#takeTakovrOrgCd:VARCHAR#, 
			<!--cubrid TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')-->
			TO_CHAR(sys_datetime, 'YYYYMMDDHH24MISS')
		)
	</insert>
	
		<!-- 
		기록물인수>연계인수>소속기록관포함생산현황접수 통보기록물건생산내역 저장
	 -->
	<insert id="creatCrInfrmRecord" parameterClass="rms.transf.offer.domain.CrInfrmRecord">
		INSERT INTO TB_CRINFRMRECORD
		(
			record_center_id,				creat_sys_cd, 				org_cd, 					creat_reg_dtime, 			creat_reg_no, 
			dtch_reg_no, 					record_reg_div_cd, 		title, 							aprov_pos_rank_nm, 	enforc_ymd, 
			erecord_flag, 					infrm_folder_clss_no, 	spcl_record_type, 	open_div_cd, 				open_grade, 
			duty_chrgr_nm_accum, 	oper_read_range_cd,	infrm_creat_sys_cd,	infrm_org_cd,				infrm_clss_id,
			infrm_creat_yyyy,				infrm_folder_reg_seq,		infrm_ho_no
		) VALUES (
			#recordCenterId:VARCHAR#, 			#creatSysCd:VARCHAR#, 				#orgCd:VARCHAR#, 						#creatRegDtime:VARCHAR#, 		#creatRegNo:VARCHAR#, 
			#dtchRegNo:VARCHAR#, 					#recordRegDivCd:VARCHAR#, 			#title:VARCHAR#, 							#aprovPosRankNm:VARCHAR#, 	#enforcYmd:VARCHAR#, 
			#erecordFlag:VARCHAR#, 				#infrmFolderClssNo:VARCHAR#, 		#spclRecordType:VARCHAR#, 	#openDivCd:VARCHAR#, 				#openGrade:VARCHAR#, 
			#dutyChrgrNmAccum:VARCHAR#, 	#operReadRangeCd:VARCHAR#,		#infrmCreatSysCd:VARCHAR#,		#infrmOrgCd:VARCHAR#,				#infrmClssId:VARCHAR#,
			#infrmCreatYyyy:VARCHAR#,			#infrmFolderRegSeq:VARCHAR#,		#infrmHoNo:VARCHAR#
		)
	</insert>
	
	<!--
		기록물인수>연계인수>소속기록관생산현황접수 중복건이 존재하는지 체크
	-->
 	<select id="findOfferRecordDubCheck" parameterClass="rms.transf.offer.domain.CrInfrmRecord" resultClass="int">
		SELECT  	COUNT(*)
		FROM     	TB_CRINFRMRECORD
		WHERE   	record_center_id 	 = #recordCenterId:VARCHAR#
		AND			creat_sys_cd 		 = #creatSysCd:VARCHAR#
		AND        	org_cd 				 = #orgCd:VARCHAR#
		AND			creat_reg_dtime 	 = #creatRegDtime:VARCHAR#
		AND			creat_reg_no 		 = #creatRegNo:VARCHAR#
		AND			dtch_reg_no 		 = #dtchRegNo:VARCHAR#
		AND 		infrm_folder_clss_no = #infrmFolderClssNo:VARCHAR#
	</select>		
	
	<!--
		기록물인수>연계인수>소속기록관생산현황접수 문서데이타생산내역 등록시 중복된 문서데이타내역인지 체크
	-->
 	<select id="findOfferDfileDubCheck" parameterClass="rms.transf.offer.domain.CrInfrmDfile" resultClass="int">
		SELECT  	COUNT(1)
		FROM     	TB_CRINFRMDFILE
		WHERE   	record_center_id 	= #recordCenterId:VARCHAR#
		AND			creat_sys_cd 		= #creatSysCd:VARCHAR#
		AND        	org_cd 				= #orgCd:VARCHAR#
		AND        	creat_reg_dtime 	= #creatRegDtime:VARCHAR#
		AND        	creat_reg_no 		= #creatRegNo:VARCHAR#
		AND			attach_file_seq 	= #attachFileSeq:VARCHAR#
		AND			doc_type_cd 		= #docTypeCd:VARCHAR#
	</select>
	
	<!-- 
		기록물인수>연계인수>소속기록관포함생산현황접수 통보기록물문서데이타생산내역 저장
	 -->
	<insert id="creatCrInfrmDfile" parameterClass="rms.transf.offer.domain.CrInfrmDfile">
		INSERT INTO TB_CRINFRMDFILE
		(
			record_center_id, 	creat_sys_cd, 			org_cd, 			creat_reg_dtime, 	creat_reg_no, 
			attach_file_seq, 		record_reg_div_cd, 	doc_type_cd, 	file_cnt,	 				infrm_file_size
		) VALUES (
			#recordCenterId:VARCHAR#,	#creatSysCd:VARCHAR#, 		#orgCd:VARCHAR#, 			#creatRegDtime:VARCHAR#, 		#creatRegNo:VARCHAR#, 
			#attachFileSeq:VARCHAR#, 		#recordRegDivCd:VARCHAR#, 	#docTypeCd:VARCHAR#, LPAD(#fileCnt:VARCHAR#,6,'0'), 	LPAD(#infrmFileSize:VARCHAR#,13,'0')
		)
	</insert>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관생산현황통보 이전통보내역 초기화(해당년도의 소속기록관접수내역에서 통보flag 및 통보년도 초기화)
	 -->
	<update id="updateUnderDeptStateApprInfrmClearList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE 	TB_CRINFRMFOLDER
		SET		cr_report_infrm_state = '0',
				cr_report_infrm_dtime = '',
				cr_report_infrm_result_state = '0',
				cr_report_infrm_flag = '0'
		WHERE 	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
	</update>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관생산현황통보 생산현황통보파일생성 후 접수내역에 파일생성년도 update
	 -->
	<update id="updateUnderDeptStateApprInfrmInfo" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE 	TB_CRINFRMFOLDER
		SET 	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		WHERE 	cr_report_infrm_state = '0'
	</update>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관생산현황통보 기록물철생산내역(MST) 목록조회(SELECT)
	 -->
	<select id="findUnderDeptStateApprFolderInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findUnderDeptStateApprFolderInfrmMstList-result">
		SELECT record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy
		     , folder_reg_seq, ho_no, title, folder_type_div_cd, folder_close_yyyy
		     , presv_term_cd, creat_user_nm_accum, creat_purps
		FROM  TB_CRINFRMFOLDER
		WHERE cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
		AND   cr_report_infrm_state = '0'  
		ORDER BY record_center_id, creat_sys_cd, org_cd, clss_id, creat_yyyy, folder_reg_seq, ho_no
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관생산현황통보 기록물철인수인계내역(TAKE) 목록조회(SELECT)
	 -->
	<select id="findUnderDeptStateApprTakeTakovrInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findUnderDeptStateApprFolderInfrmTakeList-result">
	 	SELECT A.record_center_id, A.creat_sys_cd, A.org_cd, A.clss_id, A.creat_yyyy
		     , A.folder_reg_seq, A.ho_no, LPAD(B.take_takovr_sno,6,'0') as take_takovr_sno, B.take_takovr_div_cd, B.take_takovr_org_cd
			 , B.take_takovr_creat_dtime
		FROM  TB_CRINFRMFOLDER A
		    , TB_CRINFRMFOLDERTAKETAKOVR B
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.creat_sys_cd = #creatSysCd:VARCHAR#
		AND   A.org_cd = #orgCd:VARCHAR#
		AND   A.clss_id = #clssId:VARCHAR#
		AND   A.creat_yyyy = #creatYyyy:VARCHAR#
		AND   A.folder_reg_seq = #folderRegSeq:VARCHAR#
		AND   A.ho_no = #hoNo:VARCHAR#
		AND   A.record_center_id = B.record_center_id
		AND   A.creat_sys_cd = B.creat_sys_cd
		AND   A.org_cd = B.org_cd
		AND   A.clss_id = B.clss_id
		AND   A.creat_yyyy = B.creat_yyyy
		AND   A.folder_reg_seq = B.folder_reg_seq
		AND   A.ho_no = B.ho_no
		ORDER BY A.record_center_id, A.creat_sys_cd, A.org_cd, A.clss_id, A.creat_yyyy, A.folder_reg_seq, A.ho_no, B.take_takovr_sno
	</select>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관생산현황통보 기록물건생산내역(DTL) 목록조회(SELECT)
	 -->
	<select id="findUnderDeptStateApprRecordInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findUnderDeptStateApprRecordInfrmDtlList-result">		
	 	SELECT B.record_center_id, B.creat_sys_cd, B.org_cd, B.record_reg_div_cd, SUBSTR(B.creat_reg_dtime,1,12) AS creat_reg_dtime
		     , B.creat_reg_no, B.dtch_reg_no, B.title, B.aprov_pos_rank_nm, B.duty_chrgr_nm_accum
			 , SUBSTR(B.enforc_ymd, 1, 8) AS enforc_ymd, B.erecord_flag
			 , A.creat_sys_cd||'-'||A.org_cd||'-'||A.clss_id||'-'||A.creat_yyyy||'-'||A.folder_reg_seq||'-'||A.ho_no AS infrm_folder_clss_no
			 , B.spcl_record_type, B.open_div_cd, B.open_grade, B.oper_read_range_cd
		FROM  TB_CRINFRMFOLDER A
		    , TB_CRINFRMRECORD B
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.creat_sys_cd = #creatSysCd:VARCHAR#
		AND   A.org_cd = #orgCd:VARCHAR#
		AND   A.clss_id = #clssId:VARCHAR#
		AND   A.creat_yyyy = #creatYyyy:VARCHAR#
		AND   A.folder_reg_seq = #folderRegSeq:VARCHAR#
		AND   A.ho_no = #hoNo:VARCHAR#
		AND   A.record_center_id = B.record_center_id
		AND   A.creat_sys_cd = B.infrm_creat_sys_cd
		AND   A.org_cd = B.infrm_org_cd
		AND   A.clss_id = B.infrm_clss_id
		AND   A.creat_yyyy = B.infrm_creat_yyyy
		AND   A.folder_reg_seq = B.infrm_folder_reg_seq
		AND   A.ho_no = B.infrm_ho_no
		ORDER BY A.record_center_id, A.creat_sys_cd, A.org_cd, B.creat_reg_dtime, B.creat_reg_no, B.dtch_reg_no
	</select>
	
		<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관생산현황통보 기록물문서데이터(본문,첨부)(DFILE)목록조회(SELECT)
	 -->
	<select id="findUnderDeptStateApprAttachInfrmInfoList" parameterClass="rms.transf.offer.domain.StateApprInfrmFile" resultMap="findUnderDeptStateApprRecordInfrmDfileList-result">
	 	SELECT A.record_center_id, A.creat_sys_cd, A.org_cd, SUBSTR(A.creat_reg_dtime,1,12) AS creat_reg_dtime, A.creat_reg_no
		    , A.dtch_reg_no AS attach_file_seq, MAX(A.record_reg_div_cd) record_reg_div_cd, B.doc_type_cd, LPAD(SUM(B.file_cnt),6,'0') file_cnt, LPAD(SUM(B.infrm_file_size),13,'0') infrm_file_size 
		FROM  TB_CRINFRMRECORD A
		    , TB_CRINFRMDFILE B
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.infrm_creat_sys_cd = #creatSysCd:VARCHAR#
		AND   A.infrm_org_cd = #orgCd:VARCHAR#
		AND   A.infrm_clss_id = #clssId:VARCHAR#
		AND   A.infrm_creat_yyyy = #creatYyyy:VARCHAR#
		AND   A.infrm_folder_reg_seq = #folderRegSeq:VARCHAR#
		AND   A.infrm_ho_no = #hoNo:VARCHAR#
		AND   B.record_center_id = A.record_center_id
		AND   B.creat_sys_cd = A.creat_sys_cd
		AND   B.org_cd = A.org_cd
		AND   B.creat_reg_dtime = A.creat_reg_dtime
		AND   B.creat_reg_no = A.creat_reg_no
		GROUP BY A.record_center_id, A.creat_sys_cd, A.org_cd, A.creat_reg_dtime, A.creat_reg_no, A.dtch_reg_no, B.doc_type_cd
		ORDER BY A.record_center_id, A.creat_sys_cd, A.org_cd, A.creat_reg_dtime, A.creat_reg_no, A.dtch_reg_no, B.doc_type_cd
	</select>
	
	<!-- 
		기록물인수>연계인수>생산현황통보>소속기록관생산현황통보 소속기록관 통보내역에 통보완료처리
	 -->
	<update id="updateUnderDeptStateApprInfrmFolderEnd" parameterClass="rms.transf.offer.domain.StateApprInfrmFile">
		UPDATE	TB_CRINFRMFOLDER
		SET 	cr_report_infrm_flag = #crReportInfrmFlag:VARCHAR#,
				cr_report_infrm_state = '2',
				cr_report_infrm_result_state = '0',
				cr_report_infrm_user_id = #crReportInfrmUserId:VARCHAR#,
				cr_report_infrm_user_nm = #crReportInfrmUserNm:VARCHAR#,
				<!--cubrid cr_report_infrm_dtime = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')-->
				cr_report_infrm_dtime = TO_CHAR(sys_datetime, 'YYYYMMDDHH24MISS')
		WHERE 	cr_report_infrm_creat_yyyy = #crReportInfrmCreatYyyy:VARCHAR#
	</update>
</sqlMap>
