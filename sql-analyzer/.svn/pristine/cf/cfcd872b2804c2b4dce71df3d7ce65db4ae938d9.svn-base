-- File Open : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findDisuseExcuteHandlPagedList

		SELECT D.*		FROM (			SELECT ROWNUM AS rnum				, C.*			FROM (				SELECT A.folder_id				 	, NVL(B.org_cd, A.org_cd) as handl_org_cd		      		, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = NVL(B.org_cd, A.org_cd)) handl_org_nm		        	, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd= NVL(B.org_cd, A.org_cd)) handl_org_abbr_nm					, A.org_cd					, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd=A.org_cd) org_nm					, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd=A.org_cd) org_abbr_nm					, A.clss_id					, A.clss_nm					, A.title					, A.creat_yyyy					, A.presv_term_cd					, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd = 'RD07' AND Z.com_cd=A.presv_term_cd) presv_term_nm					, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z,TB_ZZBISCLSS Y WHERE Z.com_type_cd = 'RD07'AND Z.com_cd=A.presv_term_cd AND Y.bis_clss_id=A.clss_id) bis_term_nm					, A.disuse_ymd		      		, B.disuse_user_nm		      		, B.disuse_method_cd		      		, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd = 'RD78' AND Z.com_cd = B.disuse_method_cd) disuse_method_nm					      		, B.mf_stat_confm_flag		      		, B.cd_stat_confm_flag		      		, A.folder_keep_state_cd		      		, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd = 'RD32' AND Z.com_cd = A.folder_keep_state_cd) folder_keep_state_nm	    					, b.DISCU_REQ_FLAG				FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B						WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID		    	AND   A.FOLDER_ID = B.Folder_Id		    	AND   A.Disu_Div_Cd = '1'          							   		AND   B.RECORD_CENTER_ID = '1'  		    	AND   B.discu_yyyy = '1'          	 AND 		    		B.discu_yyyy_seq = '1'     		    	  AND 			    	B.discu_req_flag = '1'      	  AND 			   		B.org_cd = '1'            					      AND  						A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')					  				ORDER BY A.folder_id			) C			WHERE ROWNUM <= '1'		) D		WHERE D.rnum >= '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : countDisuseExcuteHandlPagedList

		SELECT COUNT(1)		FROM TB_RDFOLDER A, TB_DFDISUSEOPIN B		WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID    	AND   A.FOLDER_ID = B.Folder_Id    	AND   A.Disu_Div_Cd = '1'          					   		AND   B.RECORD_CENTER_ID = '1'     	AND   B.discu_yyyy = '1'          	    	 AND     		B.discu_yyyy_seq = '1'         	  AND 	    	B.discu_req_flag = '1'      		      AND 	   		B.org_cd = '1'            			      AND  				A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			  ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : countDisuseExcuteHandlforBatch

		SELECT COUNT(1)		FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B		WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID    	AND   A.FOLDER_ID = B.Folder_Id    	AND   A.Disu_Div_Cd = '1'          					    	AND   A.folder_keep_state_cd in ('01','04') 		   		AND   B.RECORD_CENTER_ID = '1'     	AND   B.discu_yyyy = '1'          	 AND     		  B.discu_yyyy_seq = '1'        	  AND 	    	B.discu_req_flag = '1'      		      AND 	   		B.org_cd = '1'            			      AND  				A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			  ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findDisuseExcuteEfileDelPagedList

		SELECT F.*		FROM (			SELECT ROWNUM AS rnum				, E.*			FROM (				SELECT U.folder_id					, U.handl_org_cd		      		, U.handl_org_nm		        	, U.handl_org_abbr_nm					, U.org_cd					, U.org_nm					, U.org_abbr_nm					, U.clss_id					, U.clss_nm					, U.title					, U.creat_yyyy					, U.presv_term_cd					, U.presv_term_nm					, U.bis_term_nm					, U.efile_del_dtime					, U.efile_del_user_id		      		, U.efile_del_user_nm					, U.efile_del_cd					, U.efile_del_nm				FROM (					SELECT A.folder_id						, NVL(B.org_cd, A.org_cd) as handl_org_cd		      			, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = NVL(B.org_cd, A.org_cd)) handl_org_nm		        		, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd= NVL(B.org_cd, A.org_cd)) handl_org_abbr_nm						, A.org_cd						, (SELECT B.org_nm FROM TB_STORG B WHERE B.record_center_id = A.record_center_id AND B.org_cd = A.org_cd) org_nm						, (SELECT B.org_abbr_nm FROM TB_STORG B WHERE B.record_center_id = A.record_center_id AND B.org_cd = A.org_cd) org_abbr_nm						, A.clss_id						, A.clss_nm						, A.title						, A.creat_yyyy						, A.presv_term_cd						, (SELECT C.com_cd_nm FROM TB_ZZCOMCD C WHERE C.com_type_cd = 'RD07' AND C.com_cd=A.presv_term_cd) presv_term_nm						, (SELECT C.com_cd_nm FROM TB_ZZBISCLSS D , TB_ZZCOMCD C WHERE C.com_type_cd = 'RD07' AND C.com_cd=D.presv_term_cd AND D.bis_clss_id=A.clss_id) bis_term_nm						, B.efile_del_dtime						, B.efile_del_user_id			      		, (SELECT U.user_nm FROM TB_STUSER U WHERE U.user_id = B.efile_del_user_id) efile_del_user_nm						, A.efile_del_cd						, (SELECT C.com_cd_nm FROM TB_ZZCOMCD C WHERE C.com_type_cd = 'RD90' AND C.com_cd=A.efile_del_cd ) efile_del_nm					FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B								WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID			    	AND   A.FOLDER_ID = B.Folder_Id			    	AND   A.Disu_Div_Cd = '1'			    	AND   A.folder_keep_state_cd = '03'          								   		AND   B.RECORD_CENTER_ID = '1' 			    	AND   B.discu_yyyy = '1'          				    	 AND 			    		B.discu_yyyy_seq = '1'     			    	  AND 				   		B.org_cd = '1'            						      AND 						B.discu_req_flag = '1'       AND  							A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')						   AND  				        	A.efile_del_cd NOT IN ('01','02','03','04') 				          				    UNION ALL				    SELECT A.folder_id						, NVL(B.org_cd, A.org_cd) as handl_org_cd			      		, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = NVL(B.org_cd, A.org_cd)) handl_org_nm			        	, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd= NVL(B.org_cd, A.org_cd)) handl_org_abbr_nm						, A.org_cd						, (SELECT B.org_nm FROM TB_STORG B WHERE B.record_center_id = A.record_center_id AND B.org_cd = A.org_cd) org_nm						, (SELECT B.org_abbr_nm FROM TB_STORG B WHERE B.record_center_id = A.record_center_id AND B.org_cd = A.org_cd) org_abbr_nm						, A.clss_id						, A.clss_nm						, A.title						, A.creat_yyyy						, A.presv_term_cd						, (SELECT C.com_cd_nm FROM TB_ZZCOMCD C WHERE C.com_type_cd = 'RD07' AND C.com_cd=A.presv_term_cd) presv_term_nm						, (SELECT C.com_cd_nm FROM TB_ZZBISCLSS D, TB_ZZCOMCD C WHERE C.com_type_cd = 'RD07' AND C.com_cd=D.presv_term_cd AND D.bis_clss_id=A.clss_id) bis_term_nm						, B.efile_del_dtime						, B.efile_del_user_id			      		, (SELECT U.user_nm FROM TB_STUSER U WHERE U.user_id = B.efile_del_user_id) efile_del_user_nm						, A.efile_del_cd						, (SELECT C.com_cd_nm FROM TB_ZZCOMCD C WHERE C.com_type_cd = 'RD90' AND C.com_cd=A.efile_del_cd ) efile_del_nm					FROM  TB_NKFOLDER A, TB_DFDISUSEOPIN B								WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID			    	AND   A.FOLDER_ID = B.Folder_Id			    	AND   A.Disu_Div_Cd = '1'			    	AND   A.folder_keep_state_cd = '03'          								   		AND   B.RECORD_CENTER_ID = '1' 			    	AND   B.discu_yyyy = '1'          				    	 AND 			    		B.discu_yyyy_seq = '1'     			    	  AND 				   		B.org_cd = '1'            						      AND 						B.discu_req_flag = '1'       AND  							A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')						   AND  				        	A.efile_del_cd NOT IN ('01','02','03','04') 				          			    ) U				ORDER BY U.efile_del_cd, U.efile_del_dtime			) E			WHERE ROWNUM <= '1'		) F		WHERE F.rnum >= '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : countDisuseExcuteEfileDelPagedList

		SELECT COUNT(1)		FROM (			SELECT A.folder_id			FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B			WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID	    	AND   A.FOLDER_ID = B.Folder_Id	    	AND   A.Disu_Div_Cd = '1'	    	AND   A.folder_keep_state_cd = '03'          						   		AND   B.RECORD_CENTER_ID = '1' 	    	AND   B.discu_yyyy = '1'          		    	 AND 	    		  B.discu_yyyy_seq = '1'     	    	  AND 				  B.org_cd = '1'            		  AND 				  B.discu_req_flag = '1'       AND  					A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')				   AND  		        	efile_del_cd NOT IN ('01','02','03','04') 		          		    UNION ALL		    SELECT A.folder_id			FROM  TB_NKFOLDER A, TB_DFDISUSEOPIN B			WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID	    	AND   A.FOLDER_ID = B.Folder_Id	    	AND   A.Disu_Div_Cd = '1'	    	AND   A.folder_keep_state_cd = '03'          						   		AND   B.RECORD_CENTER_ID = '1' 	    	AND   B.discu_yyyy = '1'          		    	 AND 	    		  B.discu_yyyy_seq = '1'     	    	  AND 				  B.org_cd = '1'            		  AND 				  B.discu_req_flag = '1'       AND  					A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')				   AND  		        	efile_del_cd NOT IN ('01','02','03','04') 		          		)	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findExcelDocDisuseExcuteEfileDel

		SELECT A.folder_id			, NVL(B.org_cd, A.org_cd) as handl_org_cd      		, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = NVL(B.org_cd, A.org_cd)) handl_org_nm        	, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd= NVL(B.org_cd, A.org_cd)) handl_org_abbr_nm			, A.org_cd			, (SELECT B.org_nm FROM TB_STORG B WHERE B.record_center_id = A.record_center_id AND B.org_cd = A.org_cd) org_nm			, (SELECT B.org_abbr_nm FROM TB_STORG B WHERE B.record_center_id = A.record_center_id AND B.org_cd = A.org_cd) org_abbr_nm			, A.clss_id			, A.clss_nm			, A.title			, A.creat_yyyy			, A.presv_term_cd			, (SELECT C.com_cd_nm FROM TB_ZZCOMCD C WHERE C.com_type_cd = 'RD07' AND C.com_cd=A.presv_term_cd) presv_term_nm			,  NVL((SELECT C.com_cd_nm FROM TB_ZZBISCLSS D , TB_ZZCOMCD C WHERE C.com_type_cd = 'RD07' AND C.com_cd=D.presv_term_cd AND D.bis_clss_id=A.clss_id),'-') as  bis_term_nm			, B.efile_del_dtime			, B.efile_del_user_id      		, (SELECT U.user_nm FROM TB_STUSER U WHERE U.user_id = B.efile_del_user_id) efile_del_user_nm			, A.efile_del_cd			, (SELECT C.com_cd_nm FROM TB_ZZCOMCD C WHERE C.com_type_cd = 'RD90' AND C.com_cd=A.efile_del_cd) efile_del_nm		FROM  TB_RDFOLDER A			, TB_DFDISUSEOPIN B		WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID    	AND   A.FOLDER_ID = B.Folder_Id    	AND   A.Disu_Div_Cd = '1'    	AND   A.folder_keep_state_cd = '03'   		AND   B.RECORD_CENTER_ID = '1'     	AND   B.discu_yyyy = '1'    	 AND  	        	A.efile_del_cd NOT IN ('01','02','03','04') 	           AND     		B.discu_yyyy_seq = '1'         	  AND 	   		B.org_cd = '1'            			      AND 			B.discu_req_flag = '1'       AND  				A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			  		ORDER BY A.folder_id	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : countDisuseExcuteEfileDelforBatch

		SELECT COUNT(1)		FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B		WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID    	AND   A.FOLDER_ID = B.Folder_Id    	AND   A.Disu_Div_Cd = '1'    	AND   A.folder_keep_state_cd = '03'    	AND   A.efile_del_cd IS NULL    	AND	  (A.efile_del_flag IS NULL OR A.efile_del_flag = '0')          					   		AND   B.RECORD_CENTER_ID = '1'     	AND   B.discu_yyyy = '1'          	 AND     		  B.discu_yyyy_seq = '1'         	  AND 	   		  B.org_cd = '1'            			      AND 			  B.discu_req_flag = '1'       AND  				A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			  ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findDisuseEvalFolder

		SELECT U.*		FROM (			SELECT A.FOLDER_ID		    	, A.DISCU_YYYY		    	, B.CREAT_YYYY		     	, B.TITLE			 	, (CASE WHEN B.CLSS_DIV_CD = '1' THEN (SELECT MAX(A.BIS_CLSS_NM) FROM TB_ZZBISCLSS A WHERE A.BIS_CLSS_ID = B.CLSS_ID)				    	WHEN B.CLSS_DIV_CD = '2' THEN (SELECT MAX(A.UNIT_NM) FROM TB_ZZUNIT A WHERE A.UNIT_CD = B.CLSS_ID)				   END) AS BIS_CLSS_NM		     	, B.ORG_CD	AS CREAT_ORG_CD		     	, A.ORG_CD AS HANDL_ORG_CD		     	, A.CUR_PRESV_TERM_CD		     	, A.HANDL_ORG_DISU_DIV_CD		     	, A.HANDL_ORG_DEFER_CD		     	, A.HANDL_ORG_TERM_CD		     	, A.HANDL_ORG_RSN		     	, A.EXPERT_DISU_DIV_CD		     	, A.EXPERT_DISU_DEFER_CD		     	, A.EXPERT_DISU_TERM_CD		     	, A.EXPERT_DISU_RSN		     	, A.REVIEW_DIV_CD		     	, A.REVIEW_DEFER_CD		     	, A.REVIEW_REFIX_AFT_PRESV_TERM AS REVIEW_TERM_CD		     	, A.REVIEW_REFIX_AFT_RSN AS REVIEW_RSN		     	, A.DISCU_REQ_FLAG		     	, A.DISCU_ORIGN_TYPE_CD		     	, (SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD) AS CREAT_ORG_NM		     	, (SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = A.RECORD_CENTER_ID AND ORG_CD = A.ORG_CD) AS HANDL_ORG_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.EXPERT_DISU_DIV_CD) AS EXPERT_DISU_DIV_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.REVIEW_DIV_CD) AS REVIEW_DIV_NM          		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.REVIEW_DEFER_CD) AS REVIEW_DEFER_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.REVIEW_REFIX_AFT_PRESV_TERM) AS REVIEW_TERM_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF13' AND COM_CD = A.DISCU_ORIGN_TYPE_CD) AS DISCU_ORIGN_TYPE_NM		  	FROM TB_DFDISUSEOPIN A, TB_RDFOLDER B		  	WHERE A.RECORD_CENTER_ID = '1'		   	AND A.DISCU_YYYY = '1'		   	AND A.FOLDER_ID = '1'		   	AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID		   	AND B.FOLDER_ID = A.FOLDER_ID		   	UNION ALL 		 	SELECT A.FOLDER_ID		     	, A.DISCU_YYYY		     	, B.CREAT_YYYY		     	, B.TITLE			 	, (CASE WHEN B.CLSS_DIV_CD = '1' THEN (SELECT MAX(A.BIS_CLSS_NM) FROM TB_ZZBISCLSS A WHERE A.BIS_CLSS_ID = B.CLSS_ID)				    	WHEN B.CLSS_DIV_CD = '2' THEN (SELECT MAX(A.UNIT_NM) FROM TB_ZZUNIT A WHERE A.UNIT_CD = B.CLSS_ID)				   END) AS BIS_CLSS_NM		     	, B.ORG_CD	AS CREAT_ORG_CD		     	, A.ORG_CD AS HANDL_ORG_CD		     	, A.CUR_PRESV_TERM_CD		     	, A.HANDL_ORG_DISU_DIV_CD		     	, A.HANDL_ORG_DEFER_CD		     	, A.HANDL_ORG_TERM_CD		     	, A.HANDL_ORG_RSN		     	, A.EXPERT_DISU_DIV_CD		     	, A.EXPERT_DISU_DEFER_CD		     	, A.EXPERT_DISU_TERM_CD		     	, A.EXPERT_DISU_RSN		     	, A.REVIEW_DIV_CD		     	, A.REVIEW_DEFER_CD		     	, A.REVIEW_REFIX_AFT_PRESV_TERM AS REVIEW_TERM_CD		     	, A.REVIEW_REFIX_AFT_RSN AS REVIEW_RSN		     	, A.DISCU_REQ_FLAG		     	, A.DISCU_ORIGN_TYPE_CD		     	, (SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = B.RECORD_CENTER_ID AND ORG_CD = B.ORG_CD) AS CREAT_ORG_NM		     	, (SELECT MAX(ORG_NM) FROM TB_STORG WHERE RECORD_CENTER_ID = A.RECORD_CENTER_ID AND ORG_CD = A.ORG_CD) AS HANDL_ORG_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.CUR_PRESV_TERM_CD) AS CUR_PRESV_TERM_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.HANDL_ORG_DISU_DIV_CD) AS HANDL_ORG_DISU_DIV_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.HANDL_ORG_DEFER_CD) AS HANDL_ORG_DEFER_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.HANDL_ORG_TERM_CD) AS HANDL_ORG_TERM_NM				, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.EXPERT_DISU_DIV_CD) AS EXPERT_DISU_DIV_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.EXPERT_DISU_DEFER_CD) AS EXPERT_DISU_DEFER_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.EXPERT_DISU_TERM_CD) AS EXPERT_DISU_TERM_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF02' AND COM_CD = A.REVIEW_DIV_CD) AS REVIEW_DIV_NM          		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF07' AND COM_CD = A.REVIEW_DEFER_CD) AS REVIEW_DEFER_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'RD07' AND COM_CD = A.REVIEW_REFIX_AFT_PRESV_TERM) AS REVIEW_TERM_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF14' AND COM_CD = A.DISCU_REQ_FLAG) AS DISCU_REQ_FLAG_NM		     	, (SELECT COM_CD_NM FROM TB_ZZCOMCD WHERE COM_TYPE_CD = 'DF13' AND COM_CD = A.DISCU_ORIGN_TYPE_CD) AS DISCU_ORIGN_TYPE_NM		  	FROM TB_DFDISUSEOPIN A, TB_NKFOLDER B		 	WHERE A.RECORD_CENTER_ID = '1'		   	AND A.DISCU_YYYY = '1'		   	AND A.FOLDER_ID = '1'		   	AND B.RECORD_CENTER_ID = A.RECORD_CENTER_ID		   	AND B.FOLDER_ID = A.FOLDER_ID		) U;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findDisuseExcuteHandlFolderListforBatch

		SELECT A.folder_id		FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B		WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID    	AND   A.FOLDER_ID = B.Folder_Id    	AND   A.folder_keep_state_cd in ('01','04') 		    	AND   A.Disu_Div_Cd = '1'          					   		AND   B.RECORD_CENTER_ID = '1'     	AND   B.discu_yyyy = '1'          	 AND     		  B.discu_yyyy_seq = '1'       AND 	    	B.discu_req_flag = '1'      	  AND 	   		B.org_cd = '1'            			  AND  				A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			  ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findDisuseExcuteEfileDelFolder

		SELECT A.folder_id		FROM  TB_RDFOLDER A			, TB_DFDISUSEOPIN B		WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID    	AND   A.FOLDER_ID = B.Folder_Id    	AND   A.Disu_Div_Cd = '1'    	AND   A.folder_keep_state_cd = '03'    	AND   A.efile_del_cd IS NULL    	AND	  (A.efile_del_flag IS NULL OR A.efile_del_flag = '0')          					   		AND   B.RECORD_CENTER_ID = '1'     	AND   B.discu_yyyy = '1'          	    	 AND     		  B.discu_yyyy_seq = '1'         	  AND 	   		  B.org_cd = '1'            			      AND 			  B.discu_req_flag = '1'       AND  				A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')			  		ORDER BY A.folder_id	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findExcelDocDisuseExcuteHandl

		SELECT AA.*			, BB.mf_id		    , BB.mf_loc		    , CC.op_id		    , CC.op_loc		FROM (			SELECT A.RECORD_CENTER_ID		    	, A.folder_id		    	, NVL(B.org_cd, A.org_cd) as handl_org_cd		    	, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd = NVL(B.org_cd, A.org_cd)) handl_org_nm				, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id = '1' AND Z.org_cd=A.org_cd) org_nm				, A.clss_nm		    	, A.creat_sys_cd		    	, A.org_cd		    	, A.clss_id		      	, A.folder_reg_seq		      	, A.ho_no			  	, A.title			  	, A.creat_yyyy		      	, A.take_yyyy			  	, A.presv_term_cd			  	, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd = 'RD07' AND Z.com_cd=A.presv_term_cd) presv_term_nm		      	, A.ERECORD_FLAG		      	, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd = 'RD23' AND Z.com_cd=A.ERECORD_FLAG) ERECORD_FLAG_NM		      	, B.discu_req_flag		      	, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd = 'DF14' AND Z.com_cd=B.discu_req_flag) discu_req_flag_nm		      	, B.discu_orign_type_cd		      	, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd = 'DF13' AND Z.com_cd=B.discu_orign_type_cd) discu_orign_type_nm		      	, (case when presv_box_id is null then '미배치'		              	else substr(A.presv_box_id,1,3) ||'-'||substr(A.presv_box_id,4,3) ||'-'||substr(A.presv_box_id,7,3) ||'-'||substr(A.presv_box_id,10,3) ||'-'||substr(A.presv_box_id,13,3)  		           end) as presv_box_id 			FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B			WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID		    AND   A.FOLDER_ID = B.Folder_Id		    AND   A.Disu_Div_Cd = '1'          							    AND   A.folder_keep_state_cd in ('01','04')					   	AND   B.RECORD_CENTER_ID = '1'  		   	AND   B.discu_yyyy = '1'          	 AND 		    	B.discu_yyyy_seq = '1'       AND 			    B.discu_req_flag = '1'        AND 			   	B.org_cd = '1'            		  AND  					A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')				  		) AA LEFT OUTER JOIN (			SELECT record_center_id				, folder_id		      	, substr( max(sys_connect_by_path(mf_id,',')),2) as mf_id		      	, substr( max(sys_connect_by_path(mf_loc,',')),2) as mf_loc		    FROM ( 		    	SELECT MFd.folder_id		    		, MF.record_center_id		            , max(MF.record_center_id||'-'||lpad(MF.Pic_Sno,6,'0')) as mf_id		          	, max(lpad(mf_stakrm_id,3,'0')||'-'||lpad(mf_booksf_id,3,'0')||'-'||lpad(booksf_shelf_cno,3,'0')||'-'||lpad(booksf_shelf_rno,3,'0')||'-'||lpad(shelf_r_sno,3,'0')) as mf_loc		          	, row_number() over(partition by MFd.folder_id order by MFd.folder_id, MF.record_center_id, MF.pic_sno) as rnum		        FROM tb_rdfolder rdf , tb_srmfpicdetl MFd , tb_srmfpic MF		        where rdf.record_center_id = '1'		        and mfd.record_center_id = rdf.record_center_id		        and mfd.folder_id = rdf.folder_id		        and MFd.Record_Center_Id = MF.Record_Center_Id		        AND MFd.pic_sno = MF.pic_sno		        group by MFd.Folder_Id, MF.Record_Center_Id, MF.Pic_Sno		    ) aa   		    start with rnum = 1		    connect by prior  rnum= rnum-1		    group by Record_Center_Id, Folder_Id		) BB		ON BB.folder_id = AA.folder_id and BB.RECORD_CENTER_ID = AA.RECORD_CENTER_ID		LEFT OUTER JOIN (			select D.Record_Center_Id		        ,D.Folder_Id		        ,MAX(E.ORG_CD||'-'||lpad(E.SEQ,6,'0')||'('||E.SPLIT_TOT||')') as op_id		        ,MAX(case when BOOKSF_ARNG_FLAG = '0' then '미배치'		                  when BOOKSF_ARNG_FLAG = '1' OR BOOKSF_ARNG_FLAG = '2' then lpad(OPTIDISK_STAKRM_ID,3,'0')||'-'||lpad(OPTIDISK_BOOKSF_ID,3,'0')||'-'||lpad(FLOOR_NO,3,'0')||'-'||lpad(COL_NO,3,'0')		             end) as op_loc		    from TB_SROPTIDISK_FLD D, Tb_Sroptidisk_Mst E		    where D.ORG_CD = E.ORG_CD		    AND   D.SEQ = E.SEQ		    AND   D.RECORD_CENTER_ID = E.RECORD_CENTER_ID		    GROUP BY  D.Record_Center_Id,D.Folder_Id     		) CC		ON CC.folder_id = AA.folder_id and CC.RECORD_CENTER_ID = AA.RECORD_CENTER_ID		ORDER BY AA.folder_id;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateDisuseExcutePresvBoxInfo

		UPDATE TB_SRPRESVBOX		SET ARNG_FOLDER_CNT = ARNG_FOLDER_CNT - 1			, USE_FLAG = DECODE(ARNG_FOLDER_CNT -1, 0, '0','1')		WHERE RECORD_CENTER_ID = '1'     	AND   PRESV_BOX_ID = (			SELECT A.PRESV_BOX_ID             FROM TB_RDFOLDER A, TB_DFDISUSEOPIN B            WHERE B.record_center_id = '1'            AND   B.DISCU_YYYY = '1'            AND   A.Record_Center_Id = B.RECORD_CENTER_ID            AND   A.Folder_Id = B.Folder_Id            AND   A.Disu_Div_Cd = '1'            AND   B.discu_orign_type_cd = '1'          	AND	  A.folder_id = '1'        )	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateDisuseExcuteHandlMethod

		UPDATE TB_DFDISUSEOPIN		SET disuse_expt_ymd = '1'	    	, disuse_user_nm = '1'	        , disuse_method_cd = case when discu_orign_type_cd = '1' then '1'	        					      else disuse_method_cd	                			 end                									 	        , mf_stat_confm_flag = case when discu_orign_type_cd = '1' then '1'	                					else mf_stat_confm_flag	                			   end	        , cd_stat_confm_flag = case when discu_orign_type_cd = '1' then '1'	                					else cd_stat_confm_flag	                			   end		WHERE record_center_id = '1'	    AND discu_yyyy = '1'	    AND ((DISCU_REQ_FLAG='0' AND review_div_cd = '1') OR (DISCU_REQ_FLAG='1' AND NAT_CMT_DIV_CD = '1'))	    AND DISCU_PROG_STATE_CD = '09'		AND	folder_id = '1'	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateDisuseExcuteHandl

		UPDATE TB_RDFOLDER A		SET A.disuse_ymd = '1'			,A.folder_keep_state_cd = (				select case when B.discu_req_flag||B.discu_orign_type_cd = '01' then '03'							when B.discu_req_flag||B.discu_orign_type_cd = '02' then '03'					   		else A.folder_keep_state_cd					   end				from  tb_dfdisuseopin B 				where B.record_center_id = A.record_center_id				and   B.folder_id = A.folder_id				and   B.discu_yyyy = A.last_eval_yyyy			)	        ,A.Expt_Disuse_Yyyy = (	        	select case when B.discu_req_flag||B.discu_orign_type_cd = '01' then null							when B.discu_req_flag||B.discu_orign_type_cd = '02' then null										          							when B.discu_req_flag||B.discu_orign_type_cd = '11' AND TO_NUMBER(A.Presv_Term_Cd) >= 25 then null							when B.discu_req_flag||B.discu_orign_type_cd = '11' AND TO_NUMBER(A.Presv_Term_Cd) < 25 then TO_NUMBER(A.creat_yyyy) + 1 + TO_NUMBER(A.Presv_Term_Cd)							else TO_NUMBER(A.Expt_Disuse_Yyyy)					   end				from  tb_dfdisuseopin B 				where B.record_center_id = A.record_center_id				and   B.folder_id = A.folder_id				and   B.discu_yyyy = A.last_eval_yyyy			)	        , A.orign_dis_cd = (	        	select case when B.discu_req_flag||B.discu_orign_type_cd = '01' then '1'							when B.discu_req_flag||B.discu_orign_type_cd = '11' then '1'							else A.orign_dis_cd					   end				from  tb_dfdisuseopin B 				where B.record_center_id = A.record_center_id				and   B.folder_id = A.folder_id				and   B.discu_yyyy = A.last_eval_yyyy			)	        , A.PRESV_BOX_ID = (	        	select case when B.discu_req_flag||B.discu_orign_type_cd = '01' then null							when B.discu_req_flag||B.discu_orign_type_cd = '11' then null							else A.PRESV_BOX_ID					   end				from  tb_dfdisuseopin B 				where B.record_center_id = A.record_center_id				and   B.folder_id = A.folder_id				and   B.discu_yyyy = A.last_eval_yyyy			)		WHERE A.record_center_id = '1'		AND   A.last_eval_yyyy = '1'		AND   A.Disu_Div_Cd = '1'		AND	  A.folder_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateDisuseExcuteOpenList

		UPDATE TB_STOPENLIST				SET DISUSE_DTIME=TO_CHAR(sys_datetime,'YYYYMMDDHH24MISS')	    	, CHNG_DTIME=TO_CHAR(sys_datetime,'YYYYMMDDHH24MISS')			, CHNG_TYPE='03'			, DISUSE_DIV='01'					    , OPENLIST_OFFER_FLAG='0'	    WHERE record_center_id = '1'		AND folder_id IN (			SELECT A.folder_id 			FROM TB_RDFOLDER A, TB_DFDISUSEOPIN B			WHERE B.record_center_id = '1'	        AND   B.DISCU_YYYY = '1'                            	        AND   A.Record_Center_Id = B.RECORD_CENTER_ID	        AND   A.Folder_Id = B.Folder_Id	        AND   A.Disu_Div_Cd = '1'	        AND   B.discu_req_flag = '0'  			AND	  A.folder_id = '1'	    ) 	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateDisuseExcutePresvBoxInfoBatch

		UPDATE TB_SRPRESVBOX		SET ARNG_FOLDER_CNT = ARNG_FOLDER_CNT - 1		    , USE_FLAG = DECODE(ARNG_FOLDER_CNT -1, 0, '0','1')		WHERE RECORD_CENTER_ID = '1'     	AND PRESV_BOX_ID IN (     		SELECT A.PRESV_BOX_ID 		    FROM TB_RDFOLDER A, TB_DFDISUSEOPIN B		    WHERE B.record_center_id = '1'	        AND   B.DISCU_YYYY = '1'	        AND   A.Record_Center_Id = B.RECORD_CENTER_ID	        AND   A.Folder_Id = B.Folder_Id	        AND   A.Disu_Div_Cd = '1'	        AND   B.discu_orign_type_cd = '1'			AND A.folder_id IN (				SELECT A.folder_id				FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B				WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID				AND   A.FOLDER_ID = B.Folder_Id				AND   A.folder_keep_state_cd in ('01','04') 						AND   A.Disu_Div_Cd = '1'          									AND   B.RECORD_CENTER_ID = '1' 				AND   B.discu_yyyy = '1'          	 AND 					B.discu_yyyy_seq = '1'         AND 					B.discu_req_flag = '1'      	  AND 					B.org_cd = '1'            		      AND  						A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')					  	    	)        );


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateDisuseExcuteHandlMethodBatch

		UPDATE TB_DFDISUSEOPIN		SET disuse_expt_ymd = '1'	        , disuse_user_nm = '1'	        , disuse_method_cd = case when discu_orign_type_cd = '1' then '1'	                				  else disuse_method_cd	                			 end                									 	        , mf_stat_confm_flag = case when discu_orign_type_cd = '1' then '1'	                					else mf_stat_confm_flag	                			   end	        , cd_stat_confm_flag = case when discu_orign_type_cd = '1' then '1'	                					else cd_stat_confm_flag	                			   end		WHERE record_center_id = '1'	    AND discu_yyyy = '1'	    AND ((DISCU_REQ_FLAG='0' AND review_div_cd = '1') OR (DISCU_REQ_FLAG='1' AND NAT_CMT_DIV_CD = '1'))		AND folder_id IN (			SELECT A.folder_id			FROM TB_RDFOLDER A, TB_DFDISUSEOPIN B			WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID			AND   A.FOLDER_ID = B.Folder_Id			AND   A.folder_keep_state_cd in ('01','04') 					AND   A.Disu_Div_Cd = '1'          								AND   B.RECORD_CENTER_ID = '1' 			AND   B.discu_yyyy = '1'          	 AND 				B.discu_yyyy_seq = '1'     	  AND 				B.discu_req_flag = '1'      	  AND 				B.org_cd = '1'            			  AND  					A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')				  	    )	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateDisuseExcuteHandlBatch

		UPDATE TB_RDFOLDER A		SET A.disuse_ymd = '1'			,A.folder_keep_state_cd = (				select case when B.discu_req_flag||B.discu_orign_type_cd = '01' then '03'							when B.discu_req_flag||B.discu_orign_type_cd = '02' then '03'							else A.folder_keep_state_cd					   end				from  tb_dfdisuseopin B 				where B.record_center_id = A.record_center_id				and   B.folder_id = A.folder_id				and   B.discu_yyyy = A.last_eval_yyyy			)	        ,A.Expt_Disuse_Yyyy = (	        	select case when B.discu_req_flag||B.discu_orign_type_cd = '01' then null							when B.discu_req_flag||B.discu_orign_type_cd = '02' then null										          							when B.discu_req_flag||B.discu_orign_type_cd = '11' AND TO_NUMBER(A.Presv_Term_Cd) >= 25 then null							when B.discu_req_flag||B.discu_orign_type_cd = '11' AND TO_NUMBER(A.Presv_Term_Cd) < 25 then TO_NUMBER(A.creat_yyyy) + 1 + TO_NUMBER(A.Presv_Term_Cd)							else TO_NUMBER(A.Expt_Disuse_Yyyy)					   end				from  tb_dfdisuseopin B 				where B.record_center_id = A.record_center_id				and   B.folder_id = A.folder_id				and   B.discu_yyyy = A.last_eval_yyyy			)	        , A.orign_dis_cd = (	        	select case when B.discu_req_flag||B.discu_orign_type_cd = '01' then '1'							when B.discu_req_flag||B.discu_orign_type_cd = '11' then '1'							else A.orign_dis_cd					   end				from  tb_dfdisuseopin B 				where B.record_center_id = A.record_center_id				and   B.folder_id = A.folder_id				and   B.discu_yyyy = A.last_eval_yyyy			)	        , A.PRESV_BOX_ID = (	        	select case when B.discu_req_flag||B.discu_orign_type_cd = '01' then null							when B.discu_req_flag||B.discu_orign_type_cd = '11' then null							else A.PRESV_BOX_ID					   end				from  tb_dfdisuseopin B 				where B.record_center_id = A.record_center_id				and   B.folder_id = A.folder_id				and   B.discu_yyyy = A.last_eval_yyyy			)		WHERE A.record_center_id = '1'	    AND A.last_eval_yyyy = '1'	    AND A.Disu_Div_Cd = '1'	    AND A.folder_id IN (			SELECT A.folder_id			FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B			WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID			AND   A.FOLDER_ID = B.Folder_Id			AND   A.folder_keep_state_cd in ('01','04') 					AND   A.Disu_Div_Cd = '1'          								AND   B.RECORD_CENTER_ID = '1' 			AND   B.discu_yyyy = '1'          	 AND 				B.discu_yyyy_seq = '1'     	  AND 				B.discu_req_flag = '1'      	  AND 				B.org_cd = '1'            			  AND  					A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')				  	    )	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateDisuseExcuteOpenListBatch

		UPDATE TB_STOPENLIST				SET DISUSE_DTIME=TO_CHAR(sys_datetime,'YYYYMMDDHH24MISS')	        , CHNG_DTIME=TO_CHAR(sys_datetime,'YYYYMMDDHH24MISS')			, CHNG_TYPE='03'			, DISUSE_DIV='01'					    , OPENLIST_OFFER_FLAG='0'	    WHERE record_center_id = '1'		AND folder_id IN (			SELECT A.folder_id 			FROM TB_RDFOLDER A, TB_DFDISUSEOPIN B			WHERE B.record_center_id = '1'	        AND B.DISCU_YYYY = '1'                            	        AND A.Record_Center_Id = B.RECORD_CENTER_ID	        AND A.Folder_Id = B.Folder_Id	        AND A.Disu_Div_Cd = '1'	        AND B.discu_req_flag = '0'  			AND A.folder_id IN (				SELECT A.folder_id				FROM  TB_RDFOLDER A, TB_DFDISUSEOPIN B				WHERE A.RECORD_CENTER_ID = B.RECORD_CENTER_ID				AND   A.FOLDER_ID = B.Folder_Id				AND   A.folder_keep_state_cd in ('01','04') 						AND   A.Disu_Div_Cd = '1'          									AND   B.RECORD_CENTER_ID = '1' 				AND   B.discu_yyyy = '1'          	 AND 					B.discu_yyyy_seq = '1'     	  AND 					B.discu_req_flag = '1'      	  AND 					B.org_cd = '1'            			  AND  						A.PRESV_TERM_CD in ('01', '03', '05', '10', '25')					  	    	)	    ) ;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findEfileListWorkSno

		SELECT NVL(MAX(work_sno),0) AS work_sno FROM TB_NKEFILELIST	;


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : insert
-- Query Id : creatEfileDelWork

		INSERT INTO TB_NKEFILELIST		VALUES ('1'			, '1'			, '1'			, (SELECT NVL(MAX(work_sno),0) FROM TB_NKEFILELIST) + 1			, '1'			, TO_CHAR(sys_datetime, 'yyyymmddhhmiss')		);


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : update
-- Query Id : updateEfileDelCd

		UPDATE TB_RDFOLDER		SET efile_del_cd = '02'		WHERE record_center_id = '1'		AND folder_id = '1';


-- Filename : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
-- Query    : select
-- Query Id : findDisuseExcuteFolderTrace

		SELECT A.ORG_CD		      ,A.FOLDER_ID		      ,B.REVIEW_RSN		      ,(CASE WHEN B.REVIEW_OPIN = '1' THEN (SELECT Z.DISUSE_YMD FROM TB_RDFOLDER Z WHERE Z.RECORD_CENTER_ID = A.RECORD_CENTER_ID AND Z.FOLDER_ID = A.FOLDER_ID)		             WHEN B.REVIEW_OPIN = '2' THEN B.REVIEW_YMD		             WHEN B.REVIEW_OPIN = '3' THEN B.REVIEW_YMD		             ELSE ''		        END) AS REVIEW_YMD		      ,(SELECT Z.CREAT_SYS_CD||'-'||Z.ORG_CD||'-'||Z.CREAT_YYYY||'-'||Z.FOLDER_REG_SEQ||'-'||Z.HO_NO FROM TB_RDFOLDER Z WHERE Z.RECORD_CENTER_ID = B.RECORD_CENTER_ID AND Z.FOLDER_ID = B.FOLDER_ID) AS FOLDER_KEY		FROM TB_RDFOLDER A, TB_DFDISUSEOPINHIST B		WHERE A.RECORD_CENTER_ID = '1'		AND A.FOLDER_ID = '1'		AND A.RECORD_CENTER_ID = B.RECORD_CENTER_ID		AND A.FOLDER_ID = B.FOLDER_ID;


-- File Close : C:\eclipse\workspace\SqlMapXMLParser\rmsCubrid\rms\default\rms\eval\disuseeval\DisuseExcuteHandl.xml
