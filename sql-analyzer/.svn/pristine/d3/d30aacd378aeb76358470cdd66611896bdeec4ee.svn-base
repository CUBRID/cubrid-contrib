<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="common.detail">
	
	<!--
		기록물건 상세정보 : 공통 정보 조회 (인수후-보유기록물)
	-->
	<resultMap id="findRcRecordHead-result" class="rms.common.detail.domain.Record">
		<result property="recordCenterId"			column="record_center_id" />
		<result property="recordId"					column="record_id" />
		<result property="title"					column="title" />
		<result property="creatSysCd"				column="creat_sys_cd" />
		<result property="recordRegDivCd"			column="record_reg_div_cd" />
		<result property="recordRegDivNm"			column="record_reg_div_nm" />
		<result property="recordDetlTypeCd"			column="record_detl_type_cd" />
		<result property="recordDetlTypeNm"			column="record_detl_type_nm" />
		<result property="orgCd"					column="org_cd" />
		<result property="orgNm"					column="org_nm" />
		<result property="orgAbbrNm"				column="org_abbr_nm" />
		<result property="erecordFlag"				column="erecord_flag" />
		<result property="erecordFlagNm"			column="erecord_flag_nm" />
		<result property="prodTypeCd"				column="prod_type_cd" />
		<result property="folderId"					column="folder_id" />
		<result property="folderTitle"				column="folder_title" />
		<result property="accsFlag"					column="accs_flag" />
	</resultMap>
	<select id="findRcRecordHead" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordHead-result">
		SELECT A.record_center_id
			, A.record_id
			, A.title
<!-- 			, A.org_title as title -->
			, A.creat_sys_cd
			, A.record_reg_div_cd
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD02' AND Z.com_cd=A.record_reg_div_cd) record_reg_div_nm
			, A.record_detl_type_cd
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD03' AND Z.com_cd=A.record_detl_type_cd) record_detl_type_nm
			, A.org_cd
			, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=A.org_cd) org_nm
			, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=A.org_cd) org_abbr_nm
			, A.erecord_flag
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD23' AND Z.com_cd=A.erecord_flag) erecord_flag_nm
<!-- 			, (CASE WHEN A.record_reg_div_cd IN ('1','3','5','6','7','8') THEN 0 ELSE 1 END) prod_type_cd -->
			, (CASE WHEN A.prod_type_cd is not null THEN A.prod_type_cd ELSE (CASE WHEN A.record_reg_div_cd IN ('1','3','5','6','7','8') THEN '0' ELSE '1' END) END) prod_type_cd
			, A.folder_id
			, (SELECT F.title FROM TB_RDFOLDER F WHERE F.record_center_id=A.record_center_id AND F.folder_id=A.folder_id) folder_title
		    , '1' accs_flag
		FROM  TB_RCRECORD A
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.record_id = #recordId:VARCHAR#
	</select>
	
	
	<!--
		기록물건 상세정보 : 공통 정보 조회 (인수후-보유기록물)
	-->
	<resultMap id="findRcRecordInfo-result" class="rms.common.detail.domain.Record">
		<result property="recordCenterId"			column="record_center_id" />
		<result property="recordId"					column="record_id" />
		<result property="orignId"					column="orign_id" />
		<result property="title"					column="title" />
		<result property="subTitle"					column="sub_title" />
		<result property="corctTitle"				column="corct_title" />
		<result property="folderId"					column="folder_id" />
		<result property="folderTitle"				column="folder_title" />
		<result property="creatSysCd"				column="creat_sys_cd" />
		<result property="creatSysNm"				column="creat_sys_nm" />
		<result property="recordRegDivCd"			column="record_reg_div_cd" />
		<result property="recordRegDivNm"			column="record_reg_div_nm" />
		<result property="recordSumry"				column="record_sumry"	jdbcType="CLOB"	javaType="java.lang.String" />
		<result property="creatYyyy"				column="creat_yyyy" />
		<result property="dtchRegNo"				column="dtch_reg_no" />
		<result property="orgCd"					column="org_cd" />
		<result property="orgNm"					column="org_nm" />
		<result property="orgAbbrNm"				column="org_abbr_nm" />
		<result property="clssDivCd"				column="clss_div_cd" />
		<result property="clssId"					column="clss_id" />
		<result property="clssNm"					column="clss_nm" />
		<result property="creatRegDtime"			column="creat_reg_dtime" />
		<result property="recordDetlTypeCd"			column="record_detl_type_cd" />
		<result property="recordDetlTypeNm"			column="record_detl_type_nm" />
		<result property="recver"					column="recver" />
		<result property="sender"					column="sender" />
		<result property="enforcYmd"				column="enforc_ymd" />
		<result property="docNo"					column="doc_no" />
		<result property="docNoNm"					column="doc_no_nm" />
		<result property="enforcDocno"				column="enforc_docno" />
		<result property="readRangeNm"				column="read_range_nm" />
		<result property="dutyChrgrNm"				column="duty_chrgr_nm" />
		<result property="draftUserNm"				column="draft_user_nm" />
		<result property="signUserNm"				column="sign_user_nm" />
		<result property="operReadRangeCd"			column="oper_read_range_cd" />
		<result property="operReadRangeNm"			column="oper_read_range_nm" />
		<result property="openDivCd"				column="open_div_cd" />
		<result property="openDivNm"				column="open_div_nm" />
		<result property="openGrade"				column="open_grade" />
		<result property="openGradeA"				column="open_grade_a" />
		<result property="openGradeB"				column="open_grade_b" />
		<result property="openGradeC"				column="open_grade_c" />
		<result property="openGradeD"				column="open_grade_d" />
		<result property="openGradeE"				column="open_grade_e" />
		<result property="openGradeF"				column="open_grade_f" />
		<result property="openGradeG"				column="open_grade_g" />
		<result property="openGradeH"				column="open_grade_h" />
		<result property="partOpenRsn"				column="part_open_rsn" />
		<result property="openLimitPart"			column="open_limit_part" />
		<result property="secuClssCd"				column="secu_clss_cd" />
		<result property="secuClssNm"				column="secu_clss_nm" />
		<result property="secuClssRsn"				column="secu_clss_rsn" />
		<result property="secretTerm"				column="secret_term" />
		<result property="spclRecordType"			column="spcl_record_type" />
		<result property="spclRecordTypeA"			column="spcl_record_type_a" />
		<result property="spclRecordTypeB"			column="spcl_record_type_b" />
		<result property="spclRecordTypeC"			column="spcl_record_type_c" />
		<result property="spclRecordTypeD"			column="spcl_record_type_d" />
		<result property="spclRecordTypeE"			column="spcl_record_type_e" />
		<result property="creatUserNm"				column="creat_user_nm" />
		<result property="creatUserOrgNm"			column="creat_user_org_nm" />
		<result property="creatUserPosRankNm"		column="creat_user_pos_rank_nm" />
		<result property="creatDtime"				column="creat_dtime" />
		<result property="creatSysRecordId"			column="creat_sys_record_id" />
		<result property="oldRecordCreatOrgNm"		column="old_record_creat_org_nm" />
		<result property="oldRecordDocno"			column="old_record_docno" />
		<result property="oldRecordPresvTerm"		column="old_record_presv_term" />
		<result property="oldRecordPresvTermNm"		column="old_record_presv_term_nm" />
		<result property="presvLoc"					column="presv_loc" />
		<result property="recordSize"				column="record_size" />
		<result property="attachCnt"				column="attach_cnt" />
		<result property="recordPageCnt"			column="record_page_cnt" />
		<result property="creatRegNo"				column="creat_reg_no" />
		<result property="creatOrgRegNo"			column="creat_org_reg_no" />
		<result property="erecordFlag"				column="erecord_flag" />
		<result property="erecordFlagNm"			column="erecord_flag_nm" />
		<result property="scanProgStateCd"			column="scan_prog_state_cd" />
		<result property="adjstDescr"				column="adjst_descr" />
		<result property="audvisRecordType"			column="audvis_record_type" />
		<result property="picYmd"					column="pic_ymd" />
		<result property="picArea"					column="pic_area" />
		<result property="mainUserNm"				column="main_user_nm" />
		<result property="recordClssNm"				column="record_clss_nm" />
		<result property="prodTypeCd"				column="prod_type_cd" />
		<result property="neoTransState"			column="neo_trans_state" />
		<result property="neoTransStateNm"			column="neo_trans_state_nm" />
		<result property="neoTransDtime"			column="neo_trans_dtime" />
		<result property="neoChngSno"				column="neo_chng_sno" />
		<result property="neoFileSize"				column="neo_file_size" />
		<result property="folderKeepStateCd"		column="folder_keep_state_cd" />
		<result property="folderKeepStateNm"		column="folder_keep_state_nm" />
		<result property="disuseYmd"				column="disuse_ymd" />
		<result property="transfYmd"				column="transf_ymd" />
		<result property="accsFlag"					column="accs_flag" />
		<result property="takeFinDivCd"				column="take_fin_div_cd" />
		<result property="takeFinDivNm"				column="take_fin_div_nm" />
		<result property="takeImpossDivCd"			column="take_imposs_div_cd" />
		<result property="takeImpossDivNm"			column="take_imposs_div_nm" />
		<result property="takeImpossRsn"			column="take_imposs_rsn" />
		<result property="nonelectRegDtime"			column="nonelect_reg_dtime" />
		<result property="dtchRegNoCnt"				column="dtch_reg_no_cnt" />
		<result property="creatRegNoSub"			column="creat_reg_no_sub" />
	</resultMap>
	<select id="findRcRecordInfo" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordInfo-result">
		SELECT A.record_center_id
			, A.record_id
			, A.orign_id
			, A.title
<!-- 			, A.org_title as title -->
			, A.sub_title
			, A.corct_title
			, (SELECT F.title FROM TB_RDFOLDER F WHERE F.record_center_id=A.record_center_id AND F.folder_id=A.folder_id) folder_title
			, A.creat_sys_cd
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD17' AND Z.com_cd=A.creat_sys_cd) creat_sys_nm
			, A.record_reg_div_cd
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD02' AND Z.com_cd=A.record_reg_div_cd) record_reg_div_nm
			, A.record_sumry
			, A.creat_yyyy
			, A.dtch_reg_no
			, A.org_cd
			, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=A.org_cd) org_nm
			, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=A.org_cd) org_abbr_nm
			, A.clss_div_cd
			, A.clss_id
			, A.clss_nm
			, RPAD(A.creat_reg_dtime,14,'0') creat_reg_dtime
			, A.record_detl_type_cd
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD03' AND Z.com_cd=A.record_detl_type_cd) record_detl_type_nm
			, A.recver
			, A.sender
			, SUBSTR(A.enforc_ymd, 1, 8) AS enforc_ymd
			, A.doc_no
			, (CASE WHEN (A.creat_sys_cd='02' OR A.creat_sys_cd='05' OR A.creat_sys_cd='06')
						THEN NVL((SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=SUBSTR(A.creat_reg_no,1,7)),SUBSTR(A.creat_reg_no,1,7)) ||'-'|| TO_NUMBER(SUBSTR(A.creat_reg_no,8))
					WHEN (A.creat_sys_cd='01' OR A.creat_sys_cd='04')
						THEN ( CASE WHEN A.record_detl_type_cd='01' THEN NVL((SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=A.org_cd),A.org_cd) ||'-'|| TO_NUMBER(A.doc_no)
									ELSE A.doc_no END)
					ELSE A.doc_no
				END) doc_no_nm
			, (CASE WHEN (LENGTH(A.creat_org_reg_no)>7 AND (SELECT 1 FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=SUBSTR(A.creat_org_reg_no,1,7))=1)
						THEN NVL((SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=SUBSTR(A.creat_org_reg_no,1,7)),SUBSTR(A.creat_org_reg_no,1,7)) ||'-'|| TO_NUMBER(SUBSTR(A.creat_org_reg_no,8))
					ELSE A.creat_org_reg_no
				END) creat_org_reg_no
			, A.enforc_docno
			, (CASE WHEN LENGTH(A.read_range)=7 THEN (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=A.record_center_id AND Z.org_cd=A.read_range)
					ELSE (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD43' AND Z.com_cd=A.read_range)
				END) read_range_nm
			, A.duty_chrgr_nm
			, (CASE WHEN (A.record_detl_type_cd='01' AND A.prod_type_cd='1')
						THEN (SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MIN(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='28'))
					WHEN (A.record_detl_type_cd='02' OR A.record_detl_type_cd='03')
						THEN (SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MIN(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='06'))
					WHEN A.record_detl_type_cd='04'
						THEN (SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MIN(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='07'))
					WHEN A.creat_sys_cd='03'
						THEN (SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MIN(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='01'))
					ELSE
						(SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MIN(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='02'))
				END) draft_user_nm 
			, (CASE WHEN (A.record_detl_type_cd='01' AND A.prod_type_cd='0' AND A.close_type_cd = '0' AND A.draft_user_nm_tmp is not null AND A.sign_user_nm_tmp is null)
                        THEN (SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MIN(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='02'))
                     ELSE (SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MAX(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='05'))
                END ) sign_user_nm
			, A.oper_read_range_cd
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD53' AND Z.com_cd=A.oper_read_range_cd) oper_read_range_nm
			, A.open_div_cd
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD05' AND Z.com_cd=A.open_div_cd) open_div_nm
			, A.open_grade
			, SUBSTR(A.open_grade,1,1) open_grade_a
			, SUBSTR(A.open_grade,2,1) open_grade_b
			, SUBSTR(A.open_grade,3,1) open_grade_c
			, SUBSTR(A.open_grade,4,1) open_grade_d
			, SUBSTR(A.open_grade,5,1) open_grade_e
			, SUBSTR(A.open_grade,6,1) open_grade_f
			, SUBSTR(A.open_grade,7,1) open_grade_g
			, SUBSTR(A.open_grade,8,1) open_grade_h
			, A.part_open_rsn
			, A.open_limit_part
			, A.secu_clss_cd
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD11' AND Z.com_cd=A.secu_clss_cd) secu_clss_nm
			, A.secu_clss_rsn
			, A.secret_term
			, A.spcl_record_type
			, SUBSTR(A.spcl_record_type,1,1) spcl_record_type_a
			, SUBSTR(A.spcl_record_type,2,1) spcl_record_type_b
			, SUBSTR(A.spcl_record_type,3,1) spcl_record_type_c
			, SUBSTR(A.spcl_record_type,4,1) spcl_record_type_d
			, SUBSTR(A.spcl_record_type,5,1) spcl_record_type_e
			, A.creat_user_nm
			, A.creat_user_org_nm
			, A.creat_user_pos_rank_nm
			, RPAD(A.creat_dtime,14,'0') creat_dtime
			, A.creat_sys_record_id
			, A.old_record_creat_org_nm
			, A.old_record_docno
			, A.old_record_presv_term
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD57' AND Z.com_cd=A.old_record_presv_term) old_record_presv_term_nm
			, A.presv_loc
			, CEIL(NVL(A.record_size/1024,0)) record_size
			, TO_NUMBER(NVL(A.attach_cnt,'0')) attach_cnt
			, TO_NUMBER(NVL(A.record_page_cnt,'0')) record_page_cnt
			, A.creat_reg_no
			, A.erecord_flag
			, (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD23' AND Z.com_cd=A.erecord_flag) erecord_flag_nm
			, (SELECT F.scan_prog_state_cd FROM TB_RDFOLDER F WHERE F.record_center_id=A.record_center_id AND F.folder_id=A.folder_id) scan_prog_state_cd
			, A.adjst_descr
			, A.audvis_record_type
			, A.pic_ymd
			, A.pic_area
			, A.main_user_nm
			, (CASE WHEN (SELECT Z.sub_com_type_cd FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD02' AND Z.com_cd=A.record_reg_div_cd)='' THEN ''
					ELSE (SELECT Y.com_cd_nm FROM TB_ZZCOMCD Y WHERE Y.com_type_cd=(SELECT Z.sub_com_type_cd FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD02' AND Z.com_cd=A.record_reg_div_cd) AND Y.com_cd=A.record_clss_cd)
				END) record_clss_nm
			, A.folder_id
<!-- 			, (CASE WHEN A.record_reg_div_cd IN ('1','3','5','6','7','8') THEN 0 ELSE 1 END) prod_type_cd -->
			, (CASE WHEN A.prod_type_cd is not null THEN A.prod_type_cd ELSE (CASE WHEN A.record_reg_div_cd IN ('1','3','5','6','7','8') THEN '0' ELSE '1' END) END) prod_type_cd
            , A.neo_trans_state
            , (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='ST03' AND Z.com_cd=A.neo_trans_state) neo_trans_state_nm
            , (SELECT MAX(Y.chng_sno) FROM TB_RCORIGNNEOFILE Y WHERE Y.record_center_id=A.record_center_id AND Y.orign_id=A.orign_id) neo_chng_sno
			, (SELECT Z.reg_dtime FROM TB_RCORIGNNEOFILE Z WHERE Z.record_center_id=A.record_center_id AND Z.orign_id=A.orign_id AND Z.chng_sno=(SELECT MAX(Y.chng_sno) FROM TB_RCORIGNNEOFILE Y WHERE Y.record_center_id=Z.record_center_id AND Y.orign_id=Z.orign_id)) neo_trans_dtime
			, (SELECT CEIL(Z.file_size/1024) FROM TB_RCORIGNNEOFILE Z WHERE Z.record_center_id=A.record_center_id AND Z.orign_id=A.orign_id AND Z.chng_sno=(SELECT MAX(Y.chng_sno) FROM TB_RCORIGNNEOFILE Y WHERE Y.record_center_id=Z.record_center_id AND Y.orign_id=Z.orign_id)) neo_file_size
			, (SELECT F.folder_keep_state_cd FROM TB_RDFOLDER F WHERE F.record_center_id=A.record_center_id AND F.folder_id=A.folder_id) folder_keep_state_cd
			, (SELECT (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD32' AND Z.com_cd=F.folder_keep_state_cd) FROM TB_RDFOLDER F WHERE F.record_center_id=A.record_center_id AND F.folder_id=A.folder_id ) folder_keep_state_nm
			, (SELECT F.disuse_ymd FROM TB_RDFOLDER F WHERE F.record_center_id=A.record_center_id AND F.folder_id=A.folder_id) disuse_ymd
			, (SELECT F.transf_ymd FROM TB_RDFOLDER F WHERE F.record_center_id=A.record_center_id AND F.folder_id=A.folder_id) transf_ymd
			, '1' accs_flag
			, NVL((SELECT Z.take_fin_div_cd FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '0') take_fin_div_cd
			, (CASE WHEN NVL((SELECT Z.take_fin_div_cd FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '0') = '0' THEN '미인수'
	                WHEN NVL((SELECT Z.take_fin_div_cd FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '0') = '1' THEN '인수완료'
	           END) take_fin_div_nm
	        , NVL((SELECT Z.take_imposs_div_cd FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '00') take_imposs_div_cd   
	        , (CASE WHEN NVL((SELECT Z.take_imposs_div_cd FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '01') = '01' THEN '정상'
	                WHEN NVL((SELECT Z.take_imposs_div_cd FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '02') = '02' THEN '분실'
	                WHEN NVL((SELECT Z.take_imposs_div_cd FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '03') = '03' THEN '훼손'
	                WHEN NVL((SELECT Z.take_imposs_div_cd FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '04') = '04' THEN '기타'
	                ELSE ''
	           END) take_imposs_div_nm
	        , NVL((SELECT Z.take_imposs_rsn FROM tb_rdrecord_nonelect Z WHERE Z.record_center_id = A.record_center_id AND Z.record_id = A.record_id), '') take_imposs_rsn
	        , A.nonelect_reg_dtime
	        , (SELECT COUNT(DTCH_REG_NO)
          		FROM TB_RCRECORD
          		WHERE CREAT_SYS_CD = A.CREAT_SYS_CD
          		AND RECORD_CENTER_ID = A.RECORD_CENTER_ID
          		AND ORG_CD = A.ORG_CD
          		AND CREAT_YYYY = A.CREAT_YYYY
          		AND CREAT_REG_NO = A.CREAT_REG_NO) dtch_reg_no_cnt
           , SUBSTR(A.creat_reg_no, 8, 6) creat_reg_no_sub
		FROM (
			SELECT  A.*
				  , (SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MIN(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='02')) as draft_user_nm_tmp 
                  , (SELECT Z.agent_nm FROM TB_RCRECORDCREAT Z WHERE Z.record_center_id=A.record_center_id AND Z.record_id=A.record_id AND Z.agent_sno=(SELECT MIN(agent_sno) FROM TB_RCRECORDCREAT Y WHERE Y.record_center_id=Z.record_center_id AND Y.record_id=Z.record_id AND Y.agent_type_cd='05')) as sign_user_nm_tmp
			FROM  TB_RCRECORD A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND   A.record_id = #recordId:VARCHAR#
		) A
	</select>
	
	<!-- 
		기록물건 상세정보 : 분류체계 정보
	 -->
	<resultMap id="findRcRecordClssBisList-result" class="rms.common.detail.domain.RecordClss">
		<result property="bisClssId"				column="bis_clss_id" />
		<result property="bisClssNm"				column="bis_clss_nm" />
		<result property="levl"						column="levl" />
	</resultMap>
	<select id="findRcRecordClssBisList" parameterClass="java.lang.String" resultMap="findRcRecordClssBisList-result">
		SELECT bis_clss_id, bis_clss_nm, levl
		FROM  TB_ZZBISCLSS
		START WITH bis_clss_id = #value#
		CONNECT BY PRIOR upper_bis_clss_id = bis_clss_id 
	</select>
	
	<!-- 
		인수이후 기록물건 (이력정보) - 전자문서시스템 변경이력 
	 -->
	<resultMap id="findRcRecordChngHistList-result" class="rms.common.detail.domain.RecordChngHist">
		<result property="chngYmd"					column="chng_ymd" />
		<result property="chngUserNm"				column="chng_user_nm" />
		<result property="chngRsn"					column="chng_rsn" />
		<result property="creatRegYmdBef"			column="creat_reg_ymd_bef" />
		<result property="titleBef"					column="title_bef" />
		<result property="pageCntBef"				column="page_cnt_bef" />
		<result property="aprovPosRankBef"			column="aprov_pos_rank_bef" />
		<result property="dutyChrgrBef"				column="duty_chrgr_bef" />
		<result property="enforcYmdBef"				column="enforc_ymd_bef" />
		<result property="recverBef"				column="recver_bef" />
	</resultMap>
	<select id="findRcRecordChngHistList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordChngHistList-result">
        SELECT A.chng_ymd
             , A.chng_user_nm
             , A.chng_rsn
             , (CASE WHEN A.creat_reg_ymd_bef != A.creat_reg_ymd_aft THEN A.creat_reg_ymd_bef END) AS creat_reg_ymd_bef
             , (CASE WHEN A.title_bef != A.title_aft THEN A.title_bef END) AS title_bef
             , (CASE WHEN A.page_cnt_bef != A.page_cnt_aft THEN TO_CHAR(TO_NUMBER(A.page_cnt_bef)) END) AS page_cnt_bef
             , (CASE WHEN A.aprov_pos_rank_bef != A.aprov_pos_rank_aft THEN A.aprov_pos_rank_bef END) AS aprov_pos_rank_bef
             , (CASE WHEN A.duty_chrgr_bef != A.duty_chrgr_aft THEN A.duty_chrgr_bef END) AS duty_chrgr_bef
             , (CASE WHEN SUBSTR(A.enforc_ymd_bef, 1, 8) != SUBSTR(A.enforc_ymd_aft, 1, 8) THEN SUBSTR(A.enforc_ymd_bef, 1, 8) END) AS enforc_ymd_bef
             , (CASE WHEN A.recver_bef != A.recver_aft THEN A.recver_bef END) recver_bef
		FROM  TB_RCRECORDCHNGHIST A
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.record_id = #recordId:VARCHAR#
	</select>
	
	<!-- 
		인수이후 기록물건 (이력정보) - 건제목 변경이력 
	 -->
	<resultMap id="findRcRecordTitleHistList-result" class="rms.common.detail.domain.RecordChngHist">
		<result property="chngYmd"					column="chng_ymd" />
		<result property="chngUserNm"				column="chng_user_nm" />
		<result property="chngRsn"					column="chng_rsn" />
		<result property="titleBef"					column="title_bef" />
	</resultMap>
	<select id="findRcRecordTitleHistList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordTitleHistList-result">
		SELECT chng_ymd
		     , chng_user_nm
		     , title_bef
		     , chng_rsn
		FROM  TB_RCRECORDTITLEHIST
		WHERE record_center_id = #recordCenterId:VARCHAR#
		AND   record_id = #recordId:VARCHAR#
		ORDER BY reg_dtime DESC
	</select>
	
	<!-- 
		인수이후 기록물건 (이력정보) - 공개재분류 이력 
	 -->
	<resultMap id="findRcRecordOpenHistList-result" class="rms.common.detail.domain.RecordOpenHist">
		<result property="openDivCdBef"				column="open_div_cd_bef" />
		<result property="openGradeBef"			column="open_grade_bef" />
		<result property="openLimitPartBef"		column="open_limit_part_bef" />
		<result property="partOpenRsnBef"			column="part_open_rsn_bef" />
		<result property="chngRsn"					column="chng_rsn" />
		<result property="chngYmd"					column="chng_ymd" />
	</resultMap>
	<select id="findRcRecordOpenHistList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordOpenHistList-result">
		SELECT (CASE WHEN A.open_div_cd_bef IS NOT NULL THEN '공개여부:'||(SELECT Z.com_cd_nm FROM tb_zzcomcd Z WHERE Z.com_type_cd = 'RD05' AND Z.com_cd = A.open_div_cd_bef)
			             ELSE ''
			        END) open_div_cd_bef
			      , (CASE WHEN A.open_grade_bef IS NOT NULL THEN '공개등급:'||(A.open_grade_bef)
			              ELSE ''
			         END) open_grade_bef
			      , (CASE WHEN A.open_limit_part_bef IS NOT NULL  THEN '공개제한부분:'||A.open_limit_part_bef
			              ELSE ''
			         END) open_limit_part_bef
			       , (CASE WHEN A.part_open_rsn_bef IS NOT NULL THEN '부분공개사유:'||A.part_open_rsn_bef
			               ELSE ''
			          END) part_open_rsn_bef
			      ,A.resort_doc_no
			      ,A.chng_rsn
			      ,A.chng_ymd
			FROM tb_rdopenhist A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND   A.record_id = #recordId:VARCHAR# 
			ORDER BY A.record_center_id, A.record_id, A.chng_hist_no
	</select>
	
	<!-- 
		인수이후 기록물건 (이력정보) - 접근범위재분류 이력 
	 -->
	<resultMap id="findRcRecordReadRangeHistList-result" class="rms.common.detail.domain.RecordReadRangeHist">
		<result property="handlFinYmd"					column="handl_fin_ymd" />
		<result property="operReadRangeBef"				column="oper_read_range_bef" />
		<result property="handlOrgOpin"					column="handl_org_opin" />
	</resultMap>
	<select id="findRcRecordReadRangeHistList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordReadRangeHistList-result">
		SELECT   (SELECT Z.com_cd_nm FROM tb_zzcomcd Z WHERE Z.com_type_cd = 'RD53' AND Z.com_cd = A.oper_read_range_bef) oper_read_range_bef
				    ,A.chng_opin handl_org_opin
				    ,A.chng_ymd handl_fin_ymd
		FROM tb_rdrangeresorthist A
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.record_id =  #recordId:VARCHAR#
		ORDER BY A.record_center_id, A.record_id, A.resort_chng_hist_no
	</select>
	
	<!-- 
		인수이후 기록물건 (파일목록 - 파일목록)
		기관간인수의 건에 파일 목록 전체 호출 오류로  C.record_id = E.record_id 추가 2015.02.27 김경수
	 -->
	<resultMap id="findRcRecordFileList-result" class="rms.common.detail.domain.AttachFile">
		<result property="rnum"						column="rnum" />
		<result property="docTypeCd"				column="doc_type_cd" />
		<result property="docTypeNm"				column="doc_type_nm" />
		<result property="docTypeSno"				column="doc_type_sno" />
		<result property="fileNm"					column="file_nm" />
		<result property="fileSize"					column="file_size" />
		<result property="agentNm"					column="agent_nm" />
		<result property="attachFilePageCnt"		column="attach_file_page_cnt" />
		<result property="ver"						column="ver" />
		<result property="orignFileId"				column="orign_file_id" />
		<result property="pdfA1FileId"				column="pdf_a1_file_id" />
		<result property="pdfA1TransState"			column="pdf_a1_trans_state" />
		<result property="pdfA1TransDtime"			column="pdf_a1_trans_dtime" />
		<result property="pdfA1FileSize"			column="pdf_a1_file_size" />
		<result property="operReadRangeCd"			column="oper_read_range_cd" />
		<result property="erecordFlag"				column="erecord_flag" />
		<result property="idx"						column="idx" />
		<result property="attachFileMngInfo"		column="attach_file_mng_info" />
	</resultMap>
	<select id="findRcRecordFileList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordFileList-result">
		SELECT ROWNUM rnum, ROWNUM idx, TA.*
		FROM (
			SELECT A.orign_file_id
				 , A.doc_type_cd
				 , A.doc_type_sno
				 , Z.com_cd_nm doc_type_nm
				 , A.file_nm
				 , CEIL((NVL(E.file_size, A.file_size)/1024)) file_size
			     , A.agent_nm
				 , TO_NUMBER(NVL(A.page_cnt,'0')) attach_file_page_cnt
				 , ( SELECT E.pdf_a1_file_id
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_file_id
				 , ( SELECT CEIL(E.file_size/1024)
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_file_size
				 , ( SELECT E.reg_dtime
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_trans_dtime
				 , A.pdf_a1_trans_state
				 , C.oper_read_range_cd
				 , C.erecord_flag
				 , A.ver
				 , C.mig_flag
				 , A.attach_file_mng_info
			FROM  TB_RCORIGNFILE A
			    , TB_RCRECORD C
			    , TB_RDFOLDER D
			    , TB_RCORIGNPAGE E
			    , (SELECT com_cd, com_cd_nm FROM TB_ZZCOMCD WHERE com_type_cd = 'RD21') Z
			WHERE C.record_center_id = #recordCenterId:VARCHAR#
			AND   C.record_id = #recordId:VARCHAR#
			AND   D.record_center_id = C.record_center_id
			AND   D.folder_id = C.folder_id
            AND   C.record_id           = E.record_id
			AND   ( (C.erecord_flag = '1') OR ( (C.erecord_flag = '2' AND ( D.scan_prog_state_cd = '5' OR A.doc_type_cd = 'S1') ) ) )
			AND   A.record_center_id = C.record_center_id
			AND   A.record_id = C.record_id
			<isNotEmpty prepend="AND" property="docTypeCd">
				A.doc_type_cd  = #docTypeCd:VARCHAR#
			</isNotEmpty>
			AND   A.orign_file_id = E.orign_file_id(+)
			AND   A.doc_type_cd = Z.com_cd(+)
			ORDER BY A.doc_type_cd, A.doc_type_sno, E.sno
		) TA
	</select>
	
	
	<!-- 
		파일목록 - 01:본문+05:안건본문
	 -->
	<select id="findRcRecordFileList01" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordFileList-result">
		SELECT ROWNUM rnum, ROWNUM idx, TA.*
		FROM (
			SELECT A.orign_file_id
				 , A.doc_type_cd
				 , A.doc_type_sno
				 , Z.com_cd_nm doc_type_nm
				 , A.file_nm
				 , CEIL((NVL(E.file_size, A.file_size)/1024)) file_size
			     , A.agent_nm
				 , TO_NUMBER(NVL(A.page_cnt,'0')) attach_file_page_cnt
				 , ( SELECT E.pdf_a1_file_id
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_file_id
				 , ( SELECT CEIL(E.file_size/1024)
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_file_size
				 , ( SELECT E.reg_dtime
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_trans_dtime
				 , A.pdf_a1_trans_state
				 , C.oper_read_range_cd
				 , C.erecord_flag
				 , A.ver
				 , C.mig_flag
				 , A.attach_file_mng_info
			FROM  TB_RCORIGNFILE A
			    , TB_RCRECORD C
			    , TB_RDFOLDER D
			    , TB_RCORIGNPAGE E
			    , (SELECT com_cd, com_cd_nm FROM TB_ZZCOMCD WHERE com_type_cd = 'RD21') Z
			WHERE C.record_center_id = #recordCenterId:VARCHAR#
			AND   C.record_id = #recordId:VARCHAR#
			AND   D.record_center_id = C.record_center_id
			AND   D.folder_id = C.folder_id
			AND   ( (C.erecord_flag = '1') OR ( (C.erecord_flag = '2' AND ( D.scan_prog_state_cd = '5' OR A.doc_type_cd = 'S1') ) ) )
			AND   A.record_center_id = C.record_center_id
			AND   A.record_id = C.record_id
			AND   A.doc_type_cd IN ('01','05')
			AND   A.orign_file_id = E.orign_file_id(+)
			AND   A.doc_type_cd = Z.com_cd(+)
			ORDER BY A.doc_type_cd, A.doc_type_sno, E.sno
		) TA
	</select>
	
	
	<!-- 
		파일목록 - 02:붙임+06:안건첨부+07:안건붙임+09:안건결과
	 -->
	<select id="findRcRecordFileList02" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordFileList-result">
		SELECT ROWNUM rnum, ROWNUM idx, TA.*
		FROM (
			SELECT A.orign_file_id
				 , A.doc_type_cd
				 , A.doc_type_sno
				 , Z.com_cd_nm doc_type_nm
				 , A.file_nm
				 , CEIL((NVL(E.file_size, A.file_size)/1024)) file_size
			     , A.agent_nm
				 , TO_NUMBER(NVL(A.page_cnt,'0')) attach_file_page_cnt
				 , ( SELECT E.pdf_a1_file_id
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_file_id
				 , ( SELECT CEIL(E.file_size/1024)
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_file_size
				 , ( SELECT E.reg_dtime
				     FROM  TB_RCORIGNPDFA1FILE E
				     WHERE E.record_center_id = A.record_center_id
				     AND   E.orign_id = A.orign_id
				     AND   E.doc_type_cd = A.doc_type_cd
				     AND   E.doc_type_sno = A.doc_type_sno ) pdf_a1_trans_dtime
				 , A.pdf_a1_trans_state
				 , C.oper_read_range_cd
				 , C.erecord_flag
				 , A.ver
				 , C.mig_flag
				 , A.attach_file_mng_info
			FROM  TB_RCORIGNFILE A
			    , TB_RCRECORD C
			    , TB_RDFOLDER D
			    , TB_RCORIGNPAGE E
			    , (SELECT com_cd, com_cd_nm FROM TB_ZZCOMCD WHERE com_type_cd = 'RD21') Z
			WHERE C.record_center_id = #recordCenterId:VARCHAR#
			AND   C.record_id = #recordId:VARCHAR#
			AND   D.record_center_id = C.record_center_id
			AND   D.folder_id = C.folder_id
			AND   ( (C.erecord_flag = '1') OR ( (C.erecord_flag = '2' AND ( D.scan_prog_state_cd = '5' OR A.doc_type_cd = 'S1') ) ) )
			AND   A.record_center_id = C.record_center_id
			AND   A.record_id = C.record_id
			AND   A.doc_type_cd IN ('02','06','07','09')
			AND   A.orign_file_id = E.orign_file_id(+)
			AND   A.doc_type_cd = Z.com_cd(+)
			ORDER BY A.doc_type_cd, A.doc_type_sno, E.sno
		) TA
	</select>
	
	
	<!-- 
		인수이후 기록물건 (파일목록 - 파일변경이력)
	 -->
	<resultMap id="findRcRecordFileHistList-result" class="rms.common.detail.domain.AttachFile">
		<result property="rnum"						column="rnum" />
		<result property="fileNm"       			column="file_nm" />
		<result property="orignFileId"       		column="orign_file_id" />
		<result property="orignPageId"       		column="orign_page_id" />
		<result property="chngUserNm"       		column="chng_user_nm" />
		<result property="chngDtime"       			column="chng_dtime" />
		<result property="chngRsn"       			column="chng_rsn" />
	</resultMap>
	<select id="findRcRecordFileHistList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordFileHistList-result">
		SELECT ROWNUM rnum, T.*
		  FROM (SELECT
			          NVL(P.chng_user_nm ,(SELECT user_nm FROM tb_stuser WHERE user_id = p.chng_user_id)) chng_user_nm,
			           p.orign_file_id,
			           P.orign_page_id,
					   f.file_nm,
					   p.chng_rsn,
					   p.chng_dtime
			      FROM tb_rdfolder a, tb_rdrecord b, tb_strecordorignhist o, tb_storignfilehist f, tb_storignpagehist p
			     WHERE b.record_center_id = #recordCenterId:VARCHAR#
				   AND b.record_id = #recordId:VARCHAR#
				   AND a.record_center_id = b.record_center_id
				   AND a.folder_id = b.folder_id
				   AND a.scan_prog_state_cd = '5'
				   AND b.erecord_flag = '2'
				   AND b.record_center_id = o.record_center_id
				   AND b.record_id = o.record_id
			       AND o.record_center_id = f.record_center_id
				   AND o.orign_id = f.orign_id
				   AND f.orign_file_id = p.orign_file_id
			  ORDER BY p.orign_page_id, p.chng_dtime DESC) T
	</select>
	
	
	<!-- 
		인수이후 기록물건 (행위자정보)
	 -->
	<resultMap id="findRcRecordCreatList-result" class="rms.common.detail.domain.RecordCreat">
		<result property="rnum"						column="rnum" />
		<result property="agentId"					column="agent_id" />
		<result property="agentTypeCd"				column="agent_type_cd" />
		<result property="agentTypeNm"				column="agent_type_nm" />
		<result property="agentNm"					column="agent_nm" />
		<result property="agentOrgNm"				column="agent_org_nm" />
		<result property="agentPosRankNm"			column="agent_pos_rank_nm" />
		<result property="dutyActDtime"				column="duty_act_dtime" />
		<result property="reqStateVal"				column="req_state_val" />
		<result property="opin"						column="opin"	jdbcType="CLOB"	javaType="java.lang.String" />
		<result property="handlRslt"				column="handl_rslt" />
		<result property="agentDutyTypeCd"			column="agent_duty_type_cd" />
		<result property="ver"						column="ver" />
		<result property="recordCenterId"			column="record_center_id" />
		<result property="recordId"					column="record_id" />
		<result property="regSeq"					column="reg_seq" />
	</resultMap>
	<select id="findRcRecordCreatList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordCreatList-result">
		SELECT ROWNUM rnum, TA.*
		FROM (
			SELECT A.agent_id
			     , A.agent_type_cd
			     , (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD12' AND Z.com_cd=A.agent_type_cd) agent_type_nm
			     , TRIM(A.agent_nm) agent_nm
			     , TRIM(A.agent_org_nm) agent_org_nm
				 , A.agent_pos_rank_nm
				 , A.req_state_val
				 , (CASE WHEN A.duty_act_dtime='11111111111111' THEN '' ELSE RPAD(A.duty_act_dtime,14,'0') END) duty_act_dtime
				 , A.opin
				 , A.handl_rslt
				 , A.agent_duty_type_cd
				 , '' ver
				 , A.record_center_id
				 , A.record_id
				 , '' reg_seq
			FROM  TB_RCRECORDCREAT A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND   A.record_id = #recordId:VARCHAR#
			<isNotEmpty prepend="AND" property="agentTypeCd">
				A.agent_type_cd = #agentTypeCd:VARCHAR#
			</isNotEmpty>
			ORDER BY A.duty_act_dtime, A.agent_sno
		) TA
	</select>
	<select id="findRcRecordCreatFirst" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordCreatList-result">
		SELECT ROWNUM rnum, TA.*
		FROM (
			SELECT A.agent_id
			     , A.agent_type_cd
				 , (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD12' AND Z.com_cd=A.agent_type_cd) agent_type_nm
			     , TRIM(A.agent_nm) agent_nm
			     , TRIM(A.agent_org_nm) agent_org_nm
				 , A.agent_pos_rank_nm
				 , A.req_state_val
				 , (CASE WHEN A.duty_act_dtime='11111111111111' THEN '' ELSE RPAD(A.duty_act_dtime,14,'0') END) duty_act_dtime
				 , A.opin
				 , A.handl_rslt
				 , A.agent_duty_type_cd
				 , '' ver
				 , A.record_center_id
				 , A.record_id
				 , '' reg_seq
			FROM  TB_RCRECORDCREAT A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND   A.record_id = #recordId:VARCHAR#
			AND   A.agent_type_cd IN ('06','07')
			ORDER BY A.duty_act_dtime, A.agent_sno
		) TA
		WHERE ROWNUM = 1
	</select>
	<select id="findRcRecordCreatPathList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordCreatList-result">
		SELECT ROWNUM rnum, TA.*
		FROM (
			SELECT A.agent_id
			     , A.agent_type_cd
			     , (SELECT Z.com_cd_nm FROM TB_ZZCOMCD Z WHERE Z.com_type_cd='RD12' AND Z.com_cd=A.agent_type_cd) agent_type_nm
			     , TRIM(A.agent_nm) agent_nm
			     , TRIM(A.agent_org_nm) agent_org_nm
				 , A.agent_pos_rank_nm
				 , A.req_state_val
				 , (CASE WHEN A.duty_act_dtime='11111111111111' THEN '' ELSE RPAD(A.duty_act_dtime,14,'0') END) duty_act_dtime
				 , A.opin
				 , A.handl_rslt
				 , A.agent_duty_type_cd
				 , '' ver
				 , A.record_center_id
				 , A.record_id
				 , '' reg_seq
			FROM  TB_RCRECORDCREAT A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND   A.record_id = #recordId:VARCHAR#
			AND   A.agent_type_cd != '09'
			ORDER BY A.agent_sno, A.duty_act_dtime 
		) TA
	</select>
	<select id="findRcRecordCreatListRecv" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordCreatList-result">
		SELECT ROWNUM rnum, TA.*
		FROM (
			SELECT A.agent_id
			     , A.agent_type_cd
			     , (CASE WHEN A.agent_type_cd='08' THEN '보고' WHEN A.agent_type_cd='04' THEN '참조' ELSE '' END) agent_type_nm
			     , TRIM(A.agent_nm) agent_nm
			     , TRIM(A.agent_org_nm) agent_org_nm
				 , A.agent_pos_rank_nm
				 , A.req_state_val
				 , (CASE WHEN A.duty_act_dtime='11111111111111' THEN '' ELSE RPAD(A.duty_act_dtime,14,'0') END) duty_act_dtime
				 , A.opin
				 , A.handl_rslt
				 , A.agent_duty_type_cd
				 , '' ver
				 , A.record_center_id
				 , A.record_id
				 , '' reg_seq
			FROM  TB_RCRECORDCREAT A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND   A.record_id = #recordId:VARCHAR#
			AND   A.agent_type_cd IN ('08','04')
			ORDER BY A.duty_act_dtime, A.agent_sno
		) TA
	</select>
	
	<!-- 
		인수이후 기록물건 (기록물건정보 - 출처정보)
	 -->
	<resultMap id="findRcRecordInfoSrcList-result" class="rms.common.detail.domain.RecordInfoSrc">
		<result property="infoSrcTypeCd"			column="info_src_type_cd" />
		<result property="infoSrcTypeNm"			column="info_src_type_nm" />
		<result property="infoSrcSno"				column="info_src_sno" />
		<result property="infoSrcTitle"				column="info_src_title" />
		<result property="regDtime"					column="reg_dtime" />
	</resultMap>
	<select id="findRcRecordInfoSrcList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordInfoSrcList-result">
		SELECT A.info_src_type_cd
			 , Z.com_cd_nm info_src_type_nm
		     , A.info_src_sno
		     , A.info_src_title
		     , A.reg_dtime
		FROM  TB_RCRECORDINFOSRC A
			, (SELECT com_cd, com_cd_nm FROM TB_ZZCOMCD WHERE com_type_cd = 'RD47') Z
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.record_id = #recordId:VARCHAR#
		AND   A.info_src_type_cd = Z.com_cd(+)
	</select>
	
	<!-- 
		인수이후 기록물건 (기록물건정보 - 검색어)
	 -->
	<resultMap id="findRcRecordKeywdList-result" class="rms.common.detail.domain.RecordKeywd">
		<result property="keywd"					column="keywd"	jdbcType="CLOB"	javaType="java.lang.String" />
	</resultMap>
	<select id="findRcRecordKeywdList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordKeywdList-result">
		SELECT A.keywd
		FROM  TB_RCRECORDKEYWD A
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.record_id = #recordId:VARCHAR#
	</select>
	
	<!-- 
		기록물건 - 품질검사 정보  
	 -->
	<resultMap id="findRcRecordQultyTestFileList-result" class="rms.common.detail.domain.AttachFile">
	  <result property="rowIdx"               column="ROW_IDX"                />
	  <result property="rowCnt"               column="ROW_CNT"                />
	  <result property="rowIdx2"              column="ROW_IDX2"               />
	  <result property="rowCnt2"              column="ROW_CNT2"               />
	  <result property="docTypeCd"            column="DOC_TYPE_CD"            />
	  <result property="docTypeNm"            column="DOC_TYPE_NM"            />
	  <result property="docTypeSno"           column="DOC_TYPE_SNO"            />
	  <result property="orignFileId"          column="ORIGN_FILE_ID"          />
	  <result property="pdfA1FileId"          column="PDF_A1_FILE_ID"         />
	  <result property="virusFlag"            column="VIRUS_FLAG"             />
	  <result property="virusCleanFlag"       column="VIRUS_CLEAN_FLAG"       />
	  <result property="virusCleanApplyFlag"  column="VIRUS_CLEAN_APPLY_FLAG" />
	  <result property="virusCleanFlagNm"     column="VIRUS_CLEAN_FLAG_NM"    />
	  <result property="fileNm"               column="FILE_NM"                />
	  <result property="fileSize"             column="FILE_SIZE"              />
	  <result property="orignFileType"        column="ORIGN_FILE_TYPE"        />
	  <result property="orignFileTypeNm"      column="ORIGN_FILE_TYPE_NM"     />
	  <result property="virusCleanFileInfo"   column="VIRUS_CLEAN_FILE_INFO"  />
	  <result property="virusCleanFileSize"   column="VIRUS_CLEAN_FILE_SIZE"  />
	  <result property="virusCleanFilePath"   column="VIRUS_CLEAN_FILE_PATH"  />
	</resultMap>
	<select id="findRcRecordQultyTestFileList" parameterClass="rms.common.detail.domain.FindRecord" resultMap="findRcRecordQultyTestFileList-result">
		SELECT ROW_NUMBER() OVER(PARTITION BY Z.ORIGN_FILE_TYPE ORDER BY Z.ORIGN_FILE_TYPE, Z.DOC_TYPE_CD, Z.FILE_NM, Z.SNO) AS ROW_IDX
		      ,COUNT(*) OVER(PARTITION BY Z.ORIGN_FILE_TYPE) AS ROW_CNT
		      ,ROW_NUMBER() OVER(PARTITION BY Z.ORIGN_FILE_TYPE, Z.DOC_TYPE_CD ORDER BY Z.ORIGN_FILE_TYPE, Z.DOC_TYPE_CD, Z.FILE_NM, Z.SNO) AS ROW_IDX2
		      ,COUNT(*) OVER(PARTITION BY Z.ORIGN_FILE_TYPE, Z.DOC_TYPE_CD) AS ROW_CNT2
		      ,Z.DOC_TYPE_CD
		      ,Z.DOC_TYPE_NM
		      ,Z.DOC_TYPE_SNO
		      ,Z.ORIGN_FILE_ID
		      ,Z.PDF_A1_FILE_ID
		      ,Z.VIRUS_FLAG
		      ,Z.VIRUS_CLEAN_FLAG
		      ,Z.VIRUS_CLEAN_APPLY_FLAG
		      ,Z.VIRUS_CLEAN_FLAG_NM
		      ,Z.FILE_NM
		      ,Z.FILE_SIZE
		      ,Z.ORIGN_FILE_TYPE
		      ,DECODE(Z.ORIGN_FILE_TYPE, 'OF', '원문', 'PF', 'PDF', '') AS ORIGN_FILE_TYPE_NM
		      ,Z.VIRUS_CLEAN_FILE_INFO
		      ,Z.VIRUS_CLEAN_FILE_SIZE
		      ,Z.VIRUS_CLEAN_FILE_PATH
		FROM   (SELECT A.DOC_TYPE_CD
		              ,A.DOC_TYPE_SNO
		              ,B.COM_CD_NM AS DOC_TYPE_NM
		              ,A.ORIGN_FILE_ID
		              ,A.PDF_A1_FILE_ID
		              ,A.VIRUS_FLAG
		              ,NVL(A.VIRUS_CLEAN_FLAG, '0') AS VIRUS_CLEAN_FLAG
		              ,NVL(A.VIRUS_CLEAN_APPLY_FLAG, '0') AS VIRUS_CLEAN_APPLY_FLAG
		              ,DECODE(A.VIRUS_CLEAN_APPLY_FLAG, '1', '치료적용', '2', '치료미적용', DECODE(A.VIRUS_CLEAN_FLAG, '1', '치료', '2', '치료불가', DECODE(A.VIRUS_FLAG, '1', '감염', 'X'))) AS VIRUS_CLEAN_FLAG_NM
		              ,A.FILE_NM
		              ,A.FILE_SIZE
		              ,DECODE(A.PDF_A1_FILE_ID, '', 'OF', 'PF') AS ORIGN_FILE_TYPE
		              ,(DECODE(A.PDF_A1_FILE_ID, '', 'OF', 'PF') || '|' || A.ORIGN_FILE_ID || A.PDF_A1_FILE_ID) AS VIRUS_CLEAN_FILE_INFO
		              ,A.VIRUS_CLEAN_FILE_SIZE
		              ,A.VIRUS_CLEAN_FILE_PATH
		              ,A.SNO
		        FROM   (SELECT AA.DOC_TYPE_CD
		                      ,AA.DOC_TYPE_SNO
		                      ,AA.ORIGN_FILE_ID
		                      ,'' AS PDF_A1_FILE_ID
		                      ,AA.FILE_NM
		                      ,(NVL(AE.FILE_SIZE, AA.FILE_SIZE) / 1024) AS FILE_SIZE
		                      ,(NVL(AA.VIRUS_CLEAN_FILE_SIZE, 0) / 1024) AS VIRUS_CLEAN_FILE_SIZE
		                      ,AA.VIRUS_CLEAN_FILE_PATH
		                      ,AA.VIRUS_FLAG
		                      ,AA.VIRUS_CLEAN_FLAG
		                      ,AA.VIRUS_CLEAN_APPLY_FLAG
		                      ,AA.DOC_TYPE_SNO
		                      ,AE.SNO
		                FROM   TB_RCORIGNFILE   AA
		                      ,TB_RCRECORD      AC
		                      ,TB_RCORIGNPAGE   AE
		                WHERE  AC.RECORD_CENTER_ID = #recordCenterId:VARCHAR#
		                AND    AC.RECORD_ID = #recordId:VARCHAR#
		                AND    AC.ERECORD_FLAG = '1'
		                AND    AA.RECORD_CENTER_ID = AC.RECORD_CENTER_ID
		                AND    AA.RECORD_ID = AC.RECORD_ID
		                AND    AA.ORIGN_FILE_ID = AE.ORIGN_FILE_ID(+)
		                UNION ALL
		                SELECT AF.DOC_TYPE_CD
		                      ,AF.DOC_TYPE_SNO
		                      ,'' AS ORIGN_FILE_ID
		                      ,AF.PDF_A1_FILE_ID
		                      ,AF.FILE_NM
		                      ,(NVL(AE.FILE_SIZE, AF.FILE_SIZE) / 1024) AS FILE_SIZE
		                      ,(NVL(AF.VIRUS_CLEAN_FILE_SIZE, 0) / 1024) AS VIRUS_CLEAN_FILE_SIZE
		                      ,AF.VIRUS_CLEAN_FILE_PATH
		                      ,AF.VIRUS_FLAG
		                      ,AF.VIRUS_CLEAN_FLAG
		                      ,AF.VIRUS_CLEAN_APPLY_FLAG
		                      ,AF.DOC_TYPE_SNO
		                      ,AE.SNO
		                FROM   TB_RCORIGNPDFA1FILE AF
		                      ,TB_RCRECORD         AC
		                      ,TB_RCORIGNPAGE      AE
		                WHERE  AC.RECORD_CENTER_ID = #recordCenterId:VARCHAR#
		                AND    AC.RECORD_ID = #recordId:VARCHAR#
		                AND    AC.ERECORD_FLAG = '1'
		                AND    AF.RECORD_CENTER_ID = AC.RECORD_CENTER_ID
		                AND    AF.RECORD_ID = AC.RECORD_ID
		                AND    AF.PDF_A1_FILE_ID = AE.ORIGN_FILE_ID(+)) A
		              ,(SELECT COM_CD
		                      ,COM_CD_NM
		                FROM   TB_ZZCOMCD
		                WHERE  COM_TYPE_CD = 'RD21') B
		        WHERE  A.DOC_TYPE_CD = B.COM_CD(+)) Z
	</select>
	
</sqlMap>
