<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="srch.stat">

	<!--
		이용현황 검색통계
		: 일별 통계
	-->
	<resultMap id="findUsageCurStateSrchStatDayList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
		<result property="sum11"			column="sum11"			/>
		<result property="sum12"			column="sum12"			/>
		<result property="sum13"			column="sum13"			/>
		<result property="sum14"			column="sum14"			/>
		<result property="sum15"			column="sum15"			/>
		<result property="sum16"			column="sum16"			/>
		<result property="sum17"			column="sum17"			/>
		<result property="sum18"			column="sum18"			/>
		<result property="sum19"			column="sum19"			/>
		<result property="sum20"			column="sum20"			/>
		<result property="sum21"			column="sum21"			/>
		<result property="sum22"			column="sum22"			/>
		<result property="sum23"			column="sum23"			/>
		<result property="sum24"			column="sum24"			/>
		<result property="sum25"			column="sum25"			/>
		<result property="sum26"			column="sum26"			/>
		<result property="sum27"			column="sum27"			/>
		<result property="sum28"			column="sum28"			/>
		<result property="sum29"			column="sum29"			/>
		<result property="sum30"			column="sum30"			/>
		<result property="sum31"			column="sum31"			/>
	</resultMap>
	<select id="findUsageCurStateSrchStatDayTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateSrchStatDayList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
		    , COUNT(1) AS total
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='01' THEN 1 ELSE 0 END)),0) AS sum01
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='02' THEN 1 ELSE 0 END)),0) AS sum02
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='03' THEN 1 ELSE 0 END)),0) AS sum03
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='04' THEN 1 ELSE 0 END)),0) AS sum04
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='05' THEN 1 ELSE 0 END)),0) AS sum05
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='06' THEN 1 ELSE 0 END)),0) AS sum06
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='07' THEN 1 ELSE 0 END)),0) AS sum07
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='08' THEN 1 ELSE 0 END)),0) AS sum08
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='09' THEN 1 ELSE 0 END)),0) AS sum09
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='10' THEN 1 ELSE 0 END)),0) AS sum10
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='11' THEN 1 ELSE 0 END)),0) AS sum11
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='12' THEN 1 ELSE 0 END)),0) AS sum12
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='13' THEN 1 ELSE 0 END)),0) AS sum13
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='14' THEN 1 ELSE 0 END)),0) AS sum14
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='15' THEN 1 ELSE 0 END)),0) AS sum15
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='16' THEN 1 ELSE 0 END)),0) AS sum16
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='17' THEN 1 ELSE 0 END)),0) AS sum17
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='18' THEN 1 ELSE 0 END)),0) AS sum18
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='19' THEN 1 ELSE 0 END)),0) AS sum19
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='20' THEN 1 ELSE 0 END)),0) AS sum20
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='21' THEN 1 ELSE 0 END)),0) AS sum21
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='22' THEN 1 ELSE 0 END)),0) AS sum22
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='23' THEN 1 ELSE 0 END)),0) AS sum23
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='24' THEN 1 ELSE 0 END)),0) AS sum24
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='25' THEN 1 ELSE 0 END)),0) AS sum25
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='26' THEN 1 ELSE 0 END)),0) AS sum26
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='27' THEN 1 ELSE 0 END)),0) AS sum27
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='28' THEN 1 ELSE 0 END)),0) AS sum28
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='29' THEN 1 ELSE 0 END)),0) AS sum29
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='30' THEN 1 ELSE 0 END)),0) AS sum30
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='31' THEN 1 ELSE 0 END)),0) AS sum31
		FROM  TB_RDSRCHREADSTAT A
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.srch_ymd LIKE #srchYmd:VARCHAR#
		<dynamic>
			<isNotEmpty prepend="AND" property="orgCd">
				A.org_cd = #orgCd:VARCHAR#
			</isNotEmpty>
		</dynamic>
		AND   A.srch_div_cd = #divCd:VARCHAR#
	</select>
	<select id="findUsageCurStateSrchStatDayList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateSrchStatDayList-result">
		SELECT B.org_cd
			, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.org_cd) AS org_nm
			, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.org_cd) AS org_abbr_nm
			, B.total
			, B.sum01, B.sum02, B.sum03, B.sum04, B.sum05, B.sum06, B.sum07, B.sum08, B.sum09, B.sum10
			, B.sum11, B.sum12, B.sum13, B.sum14, B.sum15, B.sum16, B.sum17, B.sum18, B.sum19, B.sum20
			, B.sum21, B.sum22, B.sum23, B.sum24, B.sum25, B.sum26, B.sum27, B.sum28, B.sum29, B.sum30
			, B.sum31
		FROM (
			SELECT A.record_center_id
				, A.org_cd
				, COUNT(1) AS total
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='01' THEN 1 ELSE 0 END)) AS sum01
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='02' THEN 1 ELSE 0 END)) AS sum02
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='03' THEN 1 ELSE 0 END)) AS sum03
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='04' THEN 1 ELSE 0 END)) AS sum04
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='05' THEN 1 ELSE 0 END)) AS sum05
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='06' THEN 1 ELSE 0 END)) AS sum06
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='07' THEN 1 ELSE 0 END)) AS sum07
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='08' THEN 1 ELSE 0 END)) AS sum08
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='09' THEN 1 ELSE 0 END)) AS sum09
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='10' THEN 1 ELSE 0 END)) AS sum10
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='11' THEN 1 ELSE 0 END)) AS sum11
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='12' THEN 1 ELSE 0 END)) AS sum12
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='13' THEN 1 ELSE 0 END)) AS sum13
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='14' THEN 1 ELSE 0 END)) AS sum14
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='15' THEN 1 ELSE 0 END)) AS sum15
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='16' THEN 1 ELSE 0 END)) AS sum16
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='17' THEN 1 ELSE 0 END)) AS sum17
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='18' THEN 1 ELSE 0 END)) AS sum18
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='19' THEN 1 ELSE 0 END)) AS sum19
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='20' THEN 1 ELSE 0 END)) AS sum20
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='21' THEN 1 ELSE 0 END)) AS sum21
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='22' THEN 1 ELSE 0 END)) AS sum22
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='23' THEN 1 ELSE 0 END)) AS sum23
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='24' THEN 1 ELSE 0 END)) AS sum24
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='25' THEN 1 ELSE 0 END)) AS sum25
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='26' THEN 1 ELSE 0 END)) AS sum26
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='27' THEN 1 ELSE 0 END)) AS sum27
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='28' THEN 1 ELSE 0 END)) AS sum28
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='29' THEN 1 ELSE 0 END)) AS sum29
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='30' THEN 1 ELSE 0 END)) AS sum30
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,7,2)='31' THEN 1 ELSE 0 END)) AS sum31
			FROM  TB_RDSRCHREADSTAT A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND   A.srch_ymd LIKE #srchYmd:VARCHAR#
			<dynamic>
				<isNotEmpty prepend="AND" property="orgCd">
					A.org_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			</dynamic>
			AND   A.srch_div_cd = #divCd:VARCHAR#
			GROUP BY A.record_center_id, A.org_cd
		) B
		ORDER BY org_nm
	</select>

	<!--
		이용현황 검색통계
		: 월별 통계
	-->
	<resultMap id="findUsageCurStateSrchStatMonthList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
		<result property="sum11"			column="sum11"			/>
		<result property="sum12"			column="sum12"			/>
	</resultMap>
	<select id="findUsageCurStateSrchStatMonthTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateSrchStatMonthList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
		    , COUNT(1) AS total
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='01' THEN 1 ELSE 0 END)),0) AS sum01
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='02' THEN 1 ELSE 0 END)),0) AS sum02
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='03' THEN 1 ELSE 0 END)),0) AS sum03
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='04' THEN 1 ELSE 0 END)),0) AS sum04
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='05' THEN 1 ELSE 0 END)),0) AS sum05
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='06' THEN 1 ELSE 0 END)),0) AS sum06
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='07' THEN 1 ELSE 0 END)),0) AS sum07
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='08' THEN 1 ELSE 0 END)),0) AS sum08
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='09' THEN 1 ELSE 0 END)),0) AS sum09
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='10' THEN 1 ELSE 0 END)),0) AS sum10
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='11' THEN 1 ELSE 0 END)),0) AS sum11
		    , NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='12' THEN 1 ELSE 0 END)),0) AS sum12
		FROM  TB_RDSRCHREADSTAT A
		WHERE A.record_center_id = #recordCenterId:VARCHAR#
		AND   A.srch_ymd LIKE #srchYmd:VARCHAR#
		<dynamic>
			<isNotEmpty prepend="AND" property="orgCd">
				A.org_cd = #orgCd:VARCHAR#
			</isNotEmpty>
		</dynamic>
		AND   A.srch_div_cd = #divCd:VARCHAR#
	</select>
	<select id="findUsageCurStateSrchStatMonthList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateSrchStatMonthList-result">
		SELECT B.org_cd
			, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.org_cd) AS org_nm
			, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.org_cd) AS org_abbr_nm
			, B.total
			, B.sum01, B.sum02, B.sum03, B.sum04, B.sum05, B.sum06, B.sum07, B.sum08, B.sum09, B.sum10
			, B.sum11, B.sum12
		FROM (
			SELECT A.record_center_id
				, A.org_cd
				, COUNT(1) AS total
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='01' THEN 1 ELSE 0 END)) AS sum01
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='02' THEN 1 ELSE 0 END)) AS sum02
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='03' THEN 1 ELSE 0 END)) AS sum03
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='04' THEN 1 ELSE 0 END)) AS sum04
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='05' THEN 1 ELSE 0 END)) AS sum05
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='06' THEN 1 ELSE 0 END)) AS sum06
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='07' THEN 1 ELSE 0 END)) AS sum07
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='08' THEN 1 ELSE 0 END)) AS sum08
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='09' THEN 1 ELSE 0 END)) AS sum09
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='10' THEN 1 ELSE 0 END)) AS sum10
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='11' THEN 1 ELSE 0 END)) AS sum11
			    , SUM((CASE WHEN SUBSTR(A.srch_ymd,5,2)='12' THEN 1 ELSE 0 END)) AS sum12
			FROM  TB_RDSRCHREADSTAT A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND   A.srch_ymd LIKE #srchYmd:VARCHAR#
			<dynamic>
				<isNotEmpty prepend="AND" property="orgCd">
					A.org_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			</dynamic>
			AND   A.srch_div_cd = #divCd:VARCHAR#
			GROUP BY A.record_center_id, A.org_cd
		) B
		ORDER BY org_nm
	</select>

	<!--
		이용현황 검색통계
		: 년도별 통계
	-->
	<resultMap id="findUsageCurStateSrchStatYearList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
	</resultMap>
	<select id="findUsageCurStateSrchStatYearTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateSrchStatYearList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
			, NVL((SUM(B.sum01)+SUM(B.sum02)+SUM(B.sum03)+SUM(B.sum04)+SUM(B.sum05)+SUM(B.sum06)+SUM(B.sum07)+SUM(B.sum08)+SUM(B.sum09)+SUM(B.sum10)),0) AS total
		    , NVL(SUM(B.sum01),0) AS sum01
		    , NVL(SUM(B.sum02),0) AS sum02
		    , NVL(SUM(B.sum03),0) AS sum03
		    , NVL(SUM(B.sum04),0) AS sum04
		    , NVL(SUM(B.sum05),0) AS sum05
		    , NVL(SUM(B.sum06),0) AS sum06
		    , NVL(SUM(B.sum07),0) AS sum07
		    , NVL(SUM(B.sum08),0) AS sum08
		    , NVL(SUM(B.sum09),0) AS sum09
		    , NVL(SUM(B.sum10),0) AS sum10
		FROM (
			SELECT NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-9),4,'0') THEN 1 ELSE 0 END)),0) AS sum01
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-8),4,'0') THEN 1 ELSE 0 END)),0) AS sum02
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-7),4,'0') THEN 1 ELSE 0 END)),0) AS sum03
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-6),4,'0') THEN 1 ELSE 0 END)),0) AS sum04
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-5),4,'0') THEN 1 ELSE 0 END)),0) AS sum05
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-4),4,'0') THEN 1 ELSE 0 END)),0) AS sum06
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-3),4,'0') THEN 1 ELSE 0 END)),0) AS sum07
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-2),4,'0') THEN 1 ELSE 0 END)),0) AS sum08
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-1),4,'0') THEN 1 ELSE 0 END)),0) AS sum09
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-0),4,'0') THEN 1 ELSE 0 END)),0) AS sum10
			FROM  TB_RDSRCHREADSTAT A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND  (SUBSTR(A.srch_ymd,1,4) BETWEEN LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-9),4,'0') AND #srchYmd:VARCHAR#)
			<dynamic>
				<isNotEmpty prepend="AND" property="orgCd">
					A.org_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			</dynamic>
			AND   A.srch_div_cd = #divCd:VARCHAR#
		) B
	</select>
	<select id="findUsageCurStateSrchStatYearList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateSrchStatYearList-result">
		SELECT B.org_cd
			, (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.org_cd) AS org_nm
			, (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.org_cd) AS org_abbr_nm
			, NVL((B.sum01+B.sum02+B.sum03+B.sum04+B.sum05+B.sum06+B.sum07+B.sum08+B.sum09+B.sum10),0) total
		    , NVL(B.sum01,0) AS sum01
		    , NVL(B.sum02,0) AS sum02
		    , NVL(B.sum03,0) AS sum03
		    , NVL(B.sum04,0) AS sum04
		    , NVL(B.sum05,0) AS sum05
		    , NVL(B.sum06,0) AS sum06
		    , NVL(B.sum07,0) AS sum07
		    , NVL(B.sum08,0) AS sum08
		    , NVL(B.sum09,0) AS sum09
		    , NVL(B.sum10,0) AS sum10
		FROM (
			SELECT A.record_center_id
				, A.org_cd
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-9),4,'0') THEN 1 ELSE 0 END)),0) AS sum01
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-8),4,'0') THEN 1 ELSE 0 END)),0) AS sum02
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-7),4,'0') THEN 1 ELSE 0 END)),0) AS sum03
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-6),4,'0') THEN 1 ELSE 0 END)),0) AS sum04
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-5),4,'0') THEN 1 ELSE 0 END)),0) AS sum05
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-4),4,'0') THEN 1 ELSE 0 END)),0) AS sum06
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-3),4,'0') THEN 1 ELSE 0 END)),0) AS sum07
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-2),4,'0') THEN 1 ELSE 0 END)),0) AS sum08
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-1),4,'0') THEN 1 ELSE 0 END)),0) AS sum09
				, NVL(SUM((CASE WHEN SUBSTR(A.srch_ymd,1,4)=LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-0),4,'0') THEN 1 ELSE 0 END)),0) AS sum10
			FROM  TB_RDSRCHREADSTAT A
			WHERE A.record_center_id = #recordCenterId:VARCHAR#
			AND  (SUBSTR(A.srch_ymd,1,4) BETWEEN LPAD(TO_CHAR(TO_NUMBER(#srchYmd:VARCHAR#)-9),4,'0') AND #srchYmd:VARCHAR#)
			<dynamic>
				<isNotEmpty prepend="AND" property="orgCd">
					A.org_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			</dynamic>
			AND   A.srch_div_cd = #divCd:VARCHAR#
			GROUP BY A.record_center_id, A.org_cd
		) B
		ORDER BY org_nm
	</select>

	<!--
		이용현황 접속통계
		: 일별 통계
	-->
	<resultMap id="findUsageCurStateConnStatDayList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="userNm"			column="user_nm"		/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
		<result property="sum11"			column="sum11"			/>
		<result property="sum12"			column="sum12"			/>
		<result property="sum13"			column="sum13"			/>
		<result property="sum14"			column="sum14"			/>
		<result property="sum15"			column="sum15"			/>
		<result property="sum16"			column="sum16"			/>
		<result property="sum17"			column="sum17"			/>
		<result property="sum18"			column="sum18"			/>
		<result property="sum19"			column="sum19"			/>
		<result property="sum20"			column="sum20"			/>
		<result property="sum21"			column="sum21"			/>
		<result property="sum22"			column="sum22"			/>
		<result property="sum23"			column="sum23"			/>
		<result property="sum24"			column="sum24"			/>
		<result property="sum25"			column="sum25"			/>
		<result property="sum26"			column="sum26"			/>
		<result property="sum27"			column="sum27"			/>
		<result property="sum28"			column="sum28"			/>
		<result property="sum29"			column="sum29"			/>
		<result property="sum30"			column="sum30"			/>
		<result property="sum31"			column="sum31"			/>
	</resultMap>
	<select id="findUsageCurStateConnStatDayTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateConnStatDayList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
			, '총계' AS user_nm
		    , COUNT(1) AS total
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='01' THEN 1 ELSE 0 END)),0) AS sum01
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='02' THEN 1 ELSE 0 END)),0) AS sum02
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='03' THEN 1 ELSE 0 END)),0) AS sum03
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='04' THEN 1 ELSE 0 END)),0) AS sum04
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='05' THEN 1 ELSE 0 END)),0) AS sum05
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='06' THEN 1 ELSE 0 END)),0) AS sum06
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='07' THEN 1 ELSE 0 END)),0) AS sum07
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='08' THEN 1 ELSE 0 END)),0) AS sum08
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='09' THEN 1 ELSE 0 END)),0) AS sum09
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='10' THEN 1 ELSE 0 END)),0) AS sum10
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='11' THEN 1 ELSE 0 END)),0) AS sum11
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='12' THEN 1 ELSE 0 END)),0) AS sum12
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='13' THEN 1 ELSE 0 END)),0) AS sum13
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='14' THEN 1 ELSE 0 END)),0) AS sum14
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='15' THEN 1 ELSE 0 END)),0) AS sum15
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='16' THEN 1 ELSE 0 END)),0) AS sum16
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='17' THEN 1 ELSE 0 END)),0) AS sum17
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='18' THEN 1 ELSE 0 END)),0) AS sum18
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='19' THEN 1 ELSE 0 END)),0) AS sum19
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='20' THEN 1 ELSE 0 END)),0) AS sum20
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='21' THEN 1 ELSE 0 END)),0) AS sum21
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='22' THEN 1 ELSE 0 END)),0) AS sum22
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='23' THEN 1 ELSE 0 END)),0) AS sum23
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='24' THEN 1 ELSE 0 END)),0) AS sum24
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='25' THEN 1 ELSE 0 END)),0) AS sum25
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='26' THEN 1 ELSE 0 END)),0) AS sum26
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='27' THEN 1 ELSE 0 END)),0) AS sum27
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='28' THEN 1 ELSE 0 END)),0) AS sum28
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='29' THEN 1 ELSE 0 END)),0) AS sum29
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='30' THEN 1 ELSE 0 END)),0) AS sum30
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='31' THEN 1 ELSE 0 END)),0) AS sum31
		FROM  TB_STUSERLOGIN A
			, TB_STUSER B
		WHERE B.record_center_id = #recordCenterId:VARCHAR#
		AND   A.user_id = B.user_id
		AND   A.conn_dtime LIKE #connDtime:VARCHAR#
		<dynamic>
			<isNotEmpty prepend="AND" property="orgCd">
				A.dept_cd = #orgCd:VARCHAR#
			</isNotEmpty>
		</dynamic>
	</select>
	<select id="findUsageCurStateConnStatDayList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateConnStatDayList-result">
		SELECT B.dept_cd AS org_cd
			, (SELECT Z.dept_nm FROM TB_STDEPT Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.dept_cd) AS org_nm
			, (SELECT Z.dept_abbr_nm FROM TB_STDEPT Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.dept_cd) AS org_abbr_nm
			, (SELECT Z.user_nm FROM TB_STUSER Z WHERE Z.record_center_id=B.record_center_id AND Z.user_id=B.user_id) AS user_nm
			, B.total
			, B.sum01, B.sum02, B.sum03, B.sum04, B.sum05, B.sum06, B.sum07, B.sum08, B.sum09, B.sum10
			, B.sum11, B.sum12, B.sum13, B.sum14, B.sum15, B.sum16, B.sum17, B.sum18, B.sum19, B.sum20
			, B.sum21, B.sum22, B.sum23, B.sum24, B.sum25, B.sum26, B.sum27, B.sum28, B.sum29, B.sum30
			, B.sum31
		FROM (
			SELECT B.record_center_id
				, A.dept_cd
				, A.user_id
				, COUNT(1) AS total
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='01' THEN 1 ELSE 0 END)) AS sum01
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='02' THEN 1 ELSE 0 END)) AS sum02
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='03' THEN 1 ELSE 0 END)) AS sum03
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='04' THEN 1 ELSE 0 END)) AS sum04
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='05' THEN 1 ELSE 0 END)) AS sum05
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='06' THEN 1 ELSE 0 END)) AS sum06
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='07' THEN 1 ELSE 0 END)) AS sum07
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='08' THEN 1 ELSE 0 END)) AS sum08
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='09' THEN 1 ELSE 0 END)) AS sum09
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='10' THEN 1 ELSE 0 END)) AS sum10
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='11' THEN 1 ELSE 0 END)) AS sum11
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='12' THEN 1 ELSE 0 END)) AS sum12
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='13' THEN 1 ELSE 0 END)) AS sum13
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='14' THEN 1 ELSE 0 END)) AS sum14
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='15' THEN 1 ELSE 0 END)) AS sum15
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='16' THEN 1 ELSE 0 END)) AS sum16
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='17' THEN 1 ELSE 0 END)) AS sum17
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='18' THEN 1 ELSE 0 END)) AS sum18
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='19' THEN 1 ELSE 0 END)) AS sum19
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='20' THEN 1 ELSE 0 END)) AS sum20
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='21' THEN 1 ELSE 0 END)) AS sum21
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='22' THEN 1 ELSE 0 END)) AS sum22
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='23' THEN 1 ELSE 0 END)) AS sum23
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='24' THEN 1 ELSE 0 END)) AS sum24
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='25' THEN 1 ELSE 0 END)) AS sum25
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='26' THEN 1 ELSE 0 END)) AS sum26
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='27' THEN 1 ELSE 0 END)) AS sum27
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='28' THEN 1 ELSE 0 END)) AS sum28
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='29' THEN 1 ELSE 0 END)) AS sum29
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='30' THEN 1 ELSE 0 END)) AS sum30
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,7,2)='31' THEN 1 ELSE 0 END)) AS sum31
			FROM  TB_STUSERLOGIN A
				, TB_STUSER B
			WHERE B.record_center_id = #recordCenterId:VARCHAR#
			AND   A.user_id = B.user_id
			AND   A.conn_dtime LIKE #connDtime:VARCHAR#
			<dynamic>
				<isNotEmpty prepend="AND" property="orgCd">
					A.dept_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			</dynamic>
			GROUP BY B.record_center_id, A.dept_cd, A.user_id
		) B
		ORDER BY org_nm, user_nm
	</select>

	<!--
		이용현황 접속통계
		: 월별 통계
	-->
	<resultMap id="findUsageCurStateConnStatMonthList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="userNm"			column="user_nm"		/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
		<result property="sum11"			column="sum11"			/>
		<result property="sum12"			column="sum12"			/>
	</resultMap>
	<select id="findUsageCurStateConnStatMonthTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateConnStatMonthList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
			, '총계' AS user_nm
		    , COUNT(1) AS total
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='01' THEN 1 ELSE 0 END)),0) AS sum01
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='02' THEN 1 ELSE 0 END)),0) AS sum02
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='03' THEN 1 ELSE 0 END)),0) AS sum03
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='04' THEN 1 ELSE 0 END)),0) AS sum04
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='05' THEN 1 ELSE 0 END)),0) AS sum05
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='06' THEN 1 ELSE 0 END)),0) AS sum06
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='07' THEN 1 ELSE 0 END)),0) AS sum07
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='08' THEN 1 ELSE 0 END)),0) AS sum08
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='09' THEN 1 ELSE 0 END)),0) AS sum09
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='10' THEN 1 ELSE 0 END)),0) AS sum10
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='11' THEN 1 ELSE 0 END)),0) AS sum11
		    , NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='12' THEN 1 ELSE 0 END)),0) AS sum12
		FROM  TB_STUSERLOGIN A
			, TB_STUSER B
		WHERE B.record_center_id = #recordCenterId:VARCHAR#
		AND   A.user_id = B.user_id
		AND   A.conn_dtime LIKE #connDtime:VARCHAR#
		<dynamic>
			<isNotEmpty prepend="AND" property="orgCd">
				A.dept_cd = #orgCd:VARCHAR#
			</isNotEmpty>
		</dynamic>
	</select>
	<select id="findUsageCurStateConnStatMonthList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateConnStatMonthList-result">
		SELECT B.dept_cd AS org_cd
			, (SELECT Z.dept_nm FROM TB_STDEPT Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.dept_cd) AS org_nm
			, (SELECT Z.dept_abbr_nm FROM TB_STDEPT Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.dept_cd) AS org_abbr_nm
			, (SELECT Z.user_nm FROM TB_STUSER Z WHERE Z.record_center_id=B.record_center_id AND Z.user_id=B.user_id) AS user_nm
			, B.total
			, B.sum01, B.sum02, B.sum03, B.sum04, B.sum05, B.sum06, B.sum07, B.sum08, B.sum09, B.sum10
			, B.sum11, B.sum12
		FROM (
			SELECT B.record_center_id
				, A.dept_cd
				, A.user_id
				, COUNT(1) AS total
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='01' THEN 1 ELSE 0 END)) AS sum01
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='02' THEN 1 ELSE 0 END)) AS sum02
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='03' THEN 1 ELSE 0 END)) AS sum03
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='04' THEN 1 ELSE 0 END)) AS sum04
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='05' THEN 1 ELSE 0 END)) AS sum05
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='06' THEN 1 ELSE 0 END)) AS sum06
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='07' THEN 1 ELSE 0 END)) AS sum07
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='08' THEN 1 ELSE 0 END)) AS sum08
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='09' THEN 1 ELSE 0 END)) AS sum09
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='10' THEN 1 ELSE 0 END)) AS sum10
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='11' THEN 1 ELSE 0 END)) AS sum11
			    , SUM((CASE WHEN SUBSTR(A.conn_dtime,5,2)='12' THEN 1 ELSE 0 END)) AS sum12
			FROM  TB_STUSERLOGIN A
				, TB_STUSER B
			WHERE B.record_center_id = #recordCenterId:VARCHAR#
			AND   A.user_id = B.user_id
			AND   A.conn_dtime LIKE #connDtime:VARCHAR#
			<dynamic>
				<isNotEmpty prepend="AND" property="orgCd">
					A.dept_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			</dynamic>
			GROUP BY B.record_center_id, A.dept_cd, A.user_id
		) B
		ORDER BY org_nm, user_nm
	</select>

	<!--
		이용현황 접속통계
		: 년도별 통계
	-->
	<resultMap id="findUsageCurStateConnStatYearList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="userNm"			column="user_nm"		/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
	</resultMap>
	<select id="findUsageCurStateConnStatYearTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateConnStatYearList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
			, '총계' AS user_nm
			, NVL((SUM(B.sum01)+SUM(B.sum02)+SUM(B.sum03)+SUM(B.sum04)+SUM(B.sum05)+SUM(B.sum06)+SUM(B.sum07)+SUM(B.sum08)+SUM(B.sum09)+SUM(B.sum10)),0) AS total
		    , NVL(SUM(B.sum01),0) AS sum01
		    , NVL(SUM(B.sum02),0) AS sum02
		    , NVL(SUM(B.sum03),0) AS sum03
		    , NVL(SUM(B.sum04),0) AS sum04
		    , NVL(SUM(B.sum05),0) AS sum05
		    , NVL(SUM(B.sum06),0) AS sum06
		    , NVL(SUM(B.sum07),0) AS sum07
		    , NVL(SUM(B.sum08),0) AS sum08
		    , NVL(SUM(B.sum09),0) AS sum09
		    , NVL(SUM(B.sum10),0) AS sum10
		FROM (
			SELECT NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-9),4,'0') THEN 1 ELSE 0 END)),0) AS sum01
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-8),4,'0') THEN 1 ELSE 0 END)),0) AS sum02
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-7),4,'0') THEN 1 ELSE 0 END)),0) AS sum03
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-6),4,'0') THEN 1 ELSE 0 END)),0) AS sum04
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-5),4,'0') THEN 1 ELSE 0 END)),0) AS sum05
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-4),4,'0') THEN 1 ELSE 0 END)),0) AS sum06
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-3),4,'0') THEN 1 ELSE 0 END)),0) AS sum07
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-2),4,'0') THEN 1 ELSE 0 END)),0) AS sum08
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-1),4,'0') THEN 1 ELSE 0 END)),0) AS sum09
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-0),4,'0') THEN 1 ELSE 0 END)),0) AS sum10
			FROM  TB_STUSERLOGIN A
				, TB_STUSER B
			WHERE B.record_center_id = #recordCenterId:VARCHAR#
			AND   A.user_id = B.user_id
			AND  (SUBSTR(A.conn_dtime,1,4) BETWEEN LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-9),4,'0') AND #connDtime:VARCHAR#)
			<dynamic>
				<isNotEmpty prepend="AND" property="orgCd">
					A.dept_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			</dynamic>
		) B
	</select>
	<select id="findUsageCurStateConnStatYearList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateConnStatYearList-result">
		SELECT B.dept_cd AS org_cd
			, (SELECT Z.dept_nm FROM TB_STDEPT Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.dept_cd) AS org_nm
			, (SELECT Z.dept_abbr_nm FROM TB_STDEPT Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.dept_cd) AS org_abbr_nm
			, (SELECT Z.user_nm FROM TB_STUSER Z WHERE Z.record_center_id=B.record_center_id AND Z.user_id=B.user_id) AS user_nm
			, NVL((B.sum01+B.sum02+B.sum03+B.sum04+B.sum05+B.sum06+B.sum07+B.sum08+B.sum09+B.sum10),0) total
		    , NVL(B.sum01,0) AS sum01
		    , NVL(B.sum02,0) AS sum02
		    , NVL(B.sum03,0) AS sum03
		    , NVL(B.sum04,0) AS sum04
		    , NVL(B.sum05,0) AS sum05
		    , NVL(B.sum06,0) AS sum06
		    , NVL(B.sum07,0) AS sum07
		    , NVL(B.sum08,0) AS sum08
		    , NVL(B.sum09,0) AS sum09
		    , NVL(B.sum10,0) AS sum10
		FROM (
			SELECT B.record_center_id
				, A.dept_cd
				, A.user_id
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-9),4,'0') THEN 1 ELSE 0 END)),0) AS sum01
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-8),4,'0') THEN 1 ELSE 0 END)),0) AS sum02
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-7),4,'0') THEN 1 ELSE 0 END)),0) AS sum03
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-6),4,'0') THEN 1 ELSE 0 END)),0) AS sum04
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-5),4,'0') THEN 1 ELSE 0 END)),0) AS sum05
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-4),4,'0') THEN 1 ELSE 0 END)),0) AS sum06
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-3),4,'0') THEN 1 ELSE 0 END)),0) AS sum07
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-2),4,'0') THEN 1 ELSE 0 END)),0) AS sum08
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-1),4,'0') THEN 1 ELSE 0 END)),0) AS sum09
				, NVL(SUM((CASE WHEN SUBSTR(A.conn_dtime,1,4)=LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-0),4,'0') THEN 1 ELSE 0 END)),0) AS sum10
			FROM  TB_STUSERLOGIN A
				, TB_STUSER B
			WHERE B.record_center_id = #recordCenterId:VARCHAR#
			AND   A.user_id = B.user_id
			AND  (SUBSTR(A.conn_dtime,1,4) BETWEEN LPAD(TO_CHAR(TO_NUMBER(#connDtime:VARCHAR#)-9),4,'0') AND #connDtime:VARCHAR#)
			<dynamic>
				<isNotEmpty prepend="AND" property="orgCd">
					A.dept_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			</dynamic>
			GROUP BY B.record_center_id, A.dept_cd, A.user_id
		) B
		ORDER BY org_nm, user_nm
	</select>

	<!--
		이용현황 열람승인처리통계
		: 일별 통계
	-->
	<resultMap id="findUsageCurStateReadApprStatDayList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
		<result property="sum11"			column="sum11"			/>
		<result property="sum12"			column="sum12"			/>
		<result property="sum13"			column="sum13"			/>
		<result property="sum14"			column="sum14"			/>
		<result property="sum15"			column="sum15"			/>
		<result property="sum16"			column="sum16"			/>
		<result property="sum17"			column="sum17"			/>
		<result property="sum18"			column="sum18"			/>
		<result property="sum19"			column="sum19"			/>
		<result property="sum20"			column="sum20"			/>
		<result property="sum21"			column="sum21"			/>
		<result property="sum22"			column="sum22"			/>
		<result property="sum23"			column="sum23"			/>
		<result property="sum24"			column="sum24"			/>
		<result property="sum25"			column="sum25"			/>
		<result property="sum26"			column="sum26"			/>
		<result property="sum27"			column="sum27"			/>
		<result property="sum28"			column="sum28"			/>
		<result property="sum29"			column="sum29"			/>
		<result property="sum30"			column="sum30"			/>
		<result property="sum31"			column="sum31"			/>
	</resultMap>
	<select id="findUsageCurStateReadApprStatDayTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateReadApprStatDayList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
		    , COUNT(1) AS total
		    , NVL(SUM((CASE WHEN C.read_aprov_day='01' THEN 1 ELSE 0 END)),0) AS sum01
		    , NVL(SUM((CASE WHEN C.read_aprov_day='02' THEN 1 ELSE 0 END)),0) AS sum02
		    , NVL(SUM((CASE WHEN C.read_aprov_day='03' THEN 1 ELSE 0 END)),0) AS sum03
		    , NVL(SUM((CASE WHEN C.read_aprov_day='04' THEN 1 ELSE 0 END)),0) AS sum04
		    , NVL(SUM((CASE WHEN C.read_aprov_day='05' THEN 1 ELSE 0 END)),0) AS sum05
		    , NVL(SUM((CASE WHEN C.read_aprov_day='06' THEN 1 ELSE 0 END)),0) AS sum06
		    , NVL(SUM((CASE WHEN C.read_aprov_day='07' THEN 1 ELSE 0 END)),0) AS sum07
		    , NVL(SUM((CASE WHEN C.read_aprov_day='08' THEN 1 ELSE 0 END)),0) AS sum08
		    , NVL(SUM((CASE WHEN C.read_aprov_day='09' THEN 1 ELSE 0 END)),0) AS sum09
		    , NVL(SUM((CASE WHEN C.read_aprov_day='10' THEN 1 ELSE 0 END)),0) AS sum10
		    , NVL(SUM((CASE WHEN C.read_aprov_day='11' THEN 1 ELSE 0 END)),0) AS sum11
		    , NVL(SUM((CASE WHEN C.read_aprov_day='12' THEN 1 ELSE 0 END)),0) AS sum12
		    , NVL(SUM((CASE WHEN C.read_aprov_day='13' THEN 1 ELSE 0 END)),0) AS sum13
		    , NVL(SUM((CASE WHEN C.read_aprov_day='14' THEN 1 ELSE 0 END)),0) AS sum14
		    , NVL(SUM((CASE WHEN C.read_aprov_day='15' THEN 1 ELSE 0 END)),0) AS sum15
		    , NVL(SUM((CASE WHEN C.read_aprov_day='16' THEN 1 ELSE 0 END)),0) AS sum16
		    , NVL(SUM((CASE WHEN C.read_aprov_day='17' THEN 1 ELSE 0 END)),0) AS sum17
		    , NVL(SUM((CASE WHEN C.read_aprov_day='18' THEN 1 ELSE 0 END)),0) AS sum18
		    , NVL(SUM((CASE WHEN C.read_aprov_day='19' THEN 1 ELSE 0 END)),0) AS sum19
		    , NVL(SUM((CASE WHEN C.read_aprov_day='20' THEN 1 ELSE 0 END)),0) AS sum20
		    , NVL(SUM((CASE WHEN C.read_aprov_day='21' THEN 1 ELSE 0 END)),0) AS sum21
		    , NVL(SUM((CASE WHEN C.read_aprov_day='22' THEN 1 ELSE 0 END)),0) AS sum22
		    , NVL(SUM((CASE WHEN C.read_aprov_day='23' THEN 1 ELSE 0 END)),0) AS sum23
		    , NVL(SUM((CASE WHEN C.read_aprov_day='24' THEN 1 ELSE 0 END)),0) AS sum24
		    , NVL(SUM((CASE WHEN C.read_aprov_day='25' THEN 1 ELSE 0 END)),0) AS sum25
		    , NVL(SUM((CASE WHEN C.read_aprov_day='26' THEN 1 ELSE 0 END)),0) AS sum26
		    , NVL(SUM((CASE WHEN C.read_aprov_day='27' THEN 1 ELSE 0 END)),0) AS sum27
		    , NVL(SUM((CASE WHEN C.read_aprov_day='28' THEN 1 ELSE 0 END)),0) AS sum28
		    , NVL(SUM((CASE WHEN C.read_aprov_day='29' THEN 1 ELSE 0 END)),0) AS sum29
		    , NVL(SUM((CASE WHEN C.read_aprov_day='30' THEN 1 ELSE 0 END)),0) AS sum30
		    , NVL(SUM((CASE WHEN C.read_aprov_day='31' THEN 1 ELSE 0 END)),0) AS sum31
		FROM (
			(
				SELECT A.record_center_id, B.handl_org_cd, SUBSTR(B.read_aprov_ymd,7,2) AS read_aprov_day
				FROM  TB_RDREADREQ A
				<isEqual property="divCd" compareValue="1">
					, TB_RDFOLDERREADDETL B
				</isEqual>
				<isNotEqual property="divCd" compareValue="1">
					, TB_RDRECORDREADDETL B
				</isNotEqual>
				WHERE A.record_center_id = #recordCenterId:VARCHAR#
				AND   A.read_req_div_cd = #divCd:VARCHAR#
				AND   B.record_center_id = A.record_center_id
				AND   B.read_reqno = A.read_reqno
				AND   B.read_aprov_cd = '2'
				AND   B.read_aprov_ymd LIKE #readApprYmd:VARCHAR#
				<isNotEmpty prepend="AND" property="orgCd">
					B.handl_org_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			) UNION ALL (
				SELECT A.record_center_id, B.handl_org_cd, SUBSTR(B.read_aprov_ymd,7,2) AS read_aprov_day
				FROM  TB_NKREADREQ A
				<isEqual property="divCd" compareValue="1">
					, TB_NKFOLDERREADDETL B
				</isEqual>
				<isNotEqual property="divCd" compareValue="1">
					, TB_NKRECORDREADDETL B
				</isNotEqual>
				WHERE A.record_center_id = #recordCenterId:VARCHAR#
				AND   A.read_req_div_cd = #divCd:VARCHAR#
				AND   B.record_center_id = A.record_center_id
				AND   B.read_reqno = A.read_reqno
				AND   B.read_aprov_cd = '2'
				AND   B.read_aprov_ymd LIKE #readApprYmd:VARCHAR#
				<isNotEmpty prepend="AND" property="orgCd">
					B.handl_org_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			)
		) C
	</select>
	<select id="findUsageCurStateReadApprStatDayList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateReadApprStatDayList-result">
		SELECT D.handl_org_cd AS org_cd
			, (CASE WHEN (D.handl_org_cd IS NULL OR D.handl_org_cd = '') THEN '기록관승인' ELSE (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=D.record_center_id AND Z.org_cd=D.handl_org_cd) END) AS org_nm
			, (CASE WHEN (D.handl_org_cd IS NULL OR D.handl_org_cd = '') THEN '기록관승인' ELSE (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=D.record_center_id AND Z.org_cd=D.handl_org_cd) END) AS org_abbr_nm
			, D.total
			, D.sum01, D.sum02, D.sum03, D.sum04, D.sum05, D.sum06, D.sum07, D.sum08, D.sum09, D.sum10
			, D.sum11, D.sum12, D.sum13, D.sum14, D.sum15, D.sum16, D.sum17, D.sum18, D.sum19, D.sum20
			, D.sum21, D.sum22, D.sum23, D.sum24, D.sum25, D.sum26, D.sum27, D.sum28, D.sum29, D.sum30
			, D.sum31
		FROM (
			SELECT C.record_center_id
				, C.handl_org_cd
			    , COUNT(1) AS total
			    , NVL(SUM((CASE WHEN C.read_aprov_day='01' THEN 1 ELSE 0 END)),0) AS sum01
			    , NVL(SUM((CASE WHEN C.read_aprov_day='02' THEN 1 ELSE 0 END)),0) AS sum02
			    , NVL(SUM((CASE WHEN C.read_aprov_day='03' THEN 1 ELSE 0 END)),0) AS sum03
			    , NVL(SUM((CASE WHEN C.read_aprov_day='04' THEN 1 ELSE 0 END)),0) AS sum04
			    , NVL(SUM((CASE WHEN C.read_aprov_day='05' THEN 1 ELSE 0 END)),0) AS sum05
			    , NVL(SUM((CASE WHEN C.read_aprov_day='06' THEN 1 ELSE 0 END)),0) AS sum06
			    , NVL(SUM((CASE WHEN C.read_aprov_day='07' THEN 1 ELSE 0 END)),0) AS sum07
			    , NVL(SUM((CASE WHEN C.read_aprov_day='08' THEN 1 ELSE 0 END)),0) AS sum08
			    , NVL(SUM((CASE WHEN C.read_aprov_day='09' THEN 1 ELSE 0 END)),0) AS sum09
			    , NVL(SUM((CASE WHEN C.read_aprov_day='10' THEN 1 ELSE 0 END)),0) AS sum10
			    , NVL(SUM((CASE WHEN C.read_aprov_day='11' THEN 1 ELSE 0 END)),0) AS sum11
			    , NVL(SUM((CASE WHEN C.read_aprov_day='12' THEN 1 ELSE 0 END)),0) AS sum12
			    , NVL(SUM((CASE WHEN C.read_aprov_day='13' THEN 1 ELSE 0 END)),0) AS sum13
			    , NVL(SUM((CASE WHEN C.read_aprov_day='14' THEN 1 ELSE 0 END)),0) AS sum14
			    , NVL(SUM((CASE WHEN C.read_aprov_day='15' THEN 1 ELSE 0 END)),0) AS sum15
			    , NVL(SUM((CASE WHEN C.read_aprov_day='16' THEN 1 ELSE 0 END)),0) AS sum16
			    , NVL(SUM((CASE WHEN C.read_aprov_day='17' THEN 1 ELSE 0 END)),0) AS sum17
			    , NVL(SUM((CASE WHEN C.read_aprov_day='18' THEN 1 ELSE 0 END)),0) AS sum18
			    , NVL(SUM((CASE WHEN C.read_aprov_day='19' THEN 1 ELSE 0 END)),0) AS sum19
			    , NVL(SUM((CASE WHEN C.read_aprov_day='20' THEN 1 ELSE 0 END)),0) AS sum20
			    , NVL(SUM((CASE WHEN C.read_aprov_day='21' THEN 1 ELSE 0 END)),0) AS sum21
			    , NVL(SUM((CASE WHEN C.read_aprov_day='22' THEN 1 ELSE 0 END)),0) AS sum22
			    , NVL(SUM((CASE WHEN C.read_aprov_day='23' THEN 1 ELSE 0 END)),0) AS sum23
			    , NVL(SUM((CASE WHEN C.read_aprov_day='24' THEN 1 ELSE 0 END)),0) AS sum24
			    , NVL(SUM((CASE WHEN C.read_aprov_day='25' THEN 1 ELSE 0 END)),0) AS sum25
			    , NVL(SUM((CASE WHEN C.read_aprov_day='26' THEN 1 ELSE 0 END)),0) AS sum26
			    , NVL(SUM((CASE WHEN C.read_aprov_day='27' THEN 1 ELSE 0 END)),0) AS sum27
			    , NVL(SUM((CASE WHEN C.read_aprov_day='28' THEN 1 ELSE 0 END)),0) AS sum28
			    , NVL(SUM((CASE WHEN C.read_aprov_day='29' THEN 1 ELSE 0 END)),0) AS sum29
			    , NVL(SUM((CASE WHEN C.read_aprov_day='30' THEN 1 ELSE 0 END)),0) AS sum30
			    , NVL(SUM((CASE WHEN C.read_aprov_day='31' THEN 1 ELSE 0 END)),0) AS sum31
			FROM (
				(
					SELECT A.record_center_id, B.handl_org_cd
						, SUBSTR(B.read_aprov_ymd,7,2) AS read_aprov_day
					FROM  TB_RDREADREQ A
					<isEqual property="divCd" compareValue="1">
						, TB_RDFOLDERREADDETL B
					</isEqual>
					<isNotEqual property="divCd" compareValue="1">
						, TB_RDRECORDREADDETL B
					</isNotEqual>
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					AND   A.read_req_div_cd = #divCd:VARCHAR#
					AND   B.record_center_id = A.record_center_id
					AND   B.read_reqno = A.read_reqno
					AND   B.read_aprov_cd = '2'
					AND   B.read_aprov_ymd LIKE #readApprYmd:VARCHAR#
					<isNotEmpty prepend="AND" property="orgCd">
						B.handl_org_cd = #orgCd:VARCHAR#
					</isNotEmpty>
				) UNION ALL (
					SELECT A.record_center_id, B.handl_org_cd
						, SUBSTR(B.read_aprov_ymd,7,2) AS read_aprov_day
					FROM  TB_NKREADREQ A
					<isEqual property="divCd" compareValue="1">
						, TB_NKFOLDERREADDETL B
					</isEqual>
					<isNotEqual property="divCd" compareValue="1">
						, TB_NKRECORDREADDETL B
					</isNotEqual>
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					AND   A.read_req_div_cd = #divCd:VARCHAR#
					AND   B.record_center_id = A.record_center_id
					AND   B.read_reqno = A.read_reqno
					AND   B.read_aprov_cd = '2'
					AND   B.read_aprov_ymd LIKE #readApprYmd:VARCHAR#
					<isNotEmpty prepend="AND" property="orgCd">
						B.handl_org_cd = #orgCd:VARCHAR#
					</isNotEmpty>
				)
			) C
			GROUP BY C.record_center_id, C.handl_org_cd
		) D
		ORDER BY org_nm
	</select>

	<!--
		이용현황 열람승인처리통계
		: 월별 통계
	-->
	<resultMap id="findUsageCurStateReadApprStatMonthList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
		<result property="sum11"			column="sum11"			/>
		<result property="sum12"			column="sum12"			/>
	</resultMap>
	<select id="findUsageCurStateReadApprStatMonthTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateReadApprStatMonthList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
		    , COUNT(1) AS total
		    , NVL(SUM((CASE WHEN C.read_aprov_month='01' THEN 1 ELSE 0 END)),0) AS sum01
		    , NVL(SUM((CASE WHEN C.read_aprov_month='02' THEN 1 ELSE 0 END)),0) AS sum02
		    , NVL(SUM((CASE WHEN C.read_aprov_month='03' THEN 1 ELSE 0 END)),0) AS sum03
		    , NVL(SUM((CASE WHEN C.read_aprov_month='04' THEN 1 ELSE 0 END)),0) AS sum04
		    , NVL(SUM((CASE WHEN C.read_aprov_month='05' THEN 1 ELSE 0 END)),0) AS sum05
		    , NVL(SUM((CASE WHEN C.read_aprov_month='06' THEN 1 ELSE 0 END)),0) AS sum06
		    , NVL(SUM((CASE WHEN C.read_aprov_month='07' THEN 1 ELSE 0 END)),0) AS sum07
		    , NVL(SUM((CASE WHEN C.read_aprov_month='08' THEN 1 ELSE 0 END)),0) AS sum08
		    , NVL(SUM((CASE WHEN C.read_aprov_month='09' THEN 1 ELSE 0 END)),0) AS sum09
		    , NVL(SUM((CASE WHEN C.read_aprov_month='10' THEN 1 ELSE 0 END)),0) AS sum10
		    , NVL(SUM((CASE WHEN C.read_aprov_month='11' THEN 1 ELSE 0 END)),0) AS sum11
		    , NVL(SUM((CASE WHEN C.read_aprov_month='12' THEN 1 ELSE 0 END)),0) AS sum12
		FROM (
			(
				SELECT A.record_center_id, B.handl_org_cd
					, SUBSTR(B.read_aprov_ymd,5,2) AS read_aprov_month
				FROM  TB_RDREADREQ A
				<isEqual property="divCd" compareValue="1">
					, TB_RDFOLDERREADDETL B
				</isEqual>
				<isNotEqual property="divCd" compareValue="1">
					, TB_RDRECORDREADDETL B
				</isNotEqual>
				WHERE A.record_center_id = #recordCenterId:VARCHAR#
				AND   A.read_req_div_cd = #divCd:VARCHAR#
				AND   B.record_center_id = A.record_center_id
				AND   B.read_reqno = A.read_reqno
				AND   B.read_aprov_cd = '2'
				AND   B.read_aprov_ymd LIKE #readApprYmd:VARCHAR#
				<isNotEmpty prepend="AND" property="orgCd">
					B.handl_org_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			) UNION ALL (
				SELECT A.record_center_id, B.handl_org_cd
					, SUBSTR(B.read_aprov_ymd,5,2) AS read_aprov_month
				FROM  TB_NKREADREQ A
				<isEqual property="divCd" compareValue="1">
					, TB_NKFOLDERREADDETL B
				</isEqual>
				<isNotEqual property="divCd" compareValue="1">
					, TB_NKRECORDREADDETL B
				</isNotEqual>
				WHERE A.record_center_id = #recordCenterId:VARCHAR#
				AND   A.read_req_div_cd = #divCd:VARCHAR#
				AND   B.record_center_id = A.record_center_id
				AND   B.read_reqno = A.read_reqno
				AND   B.read_aprov_cd = '2'
				AND   B.read_aprov_ymd LIKE #readApprYmd:VARCHAR#
				<isNotEmpty prepend="AND" property="orgCd">
					B.handl_org_cd = #orgCd:VARCHAR#
				</isNotEmpty>
			)
		) C
	</select>
	<select id="findUsageCurStateReadApprStatMonthList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateReadApprStatMonthList-result">
		SELECT B.handl_org_cd AS org_cd
			, (CASE WHEN (B.handl_org_cd IS NULL OR B.handl_org_cd = '') THEN '기록관승인' ELSE (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.handl_org_cd) END) AS org_nm
			, (CASE WHEN (B.handl_org_cd IS NULL OR B.handl_org_cd = '') THEN '기록관승인' ELSE (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=B.record_center_id AND Z.org_cd=B.handl_org_cd) END) AS org_abbr_nm
			, B.total
			, B.sum01, B.sum02, B.sum03, B.sum04, B.sum05, B.sum06, B.sum07, B.sum08, B.sum09, B.sum10
			, B.sum11, B.sum12
		FROM (
			SELECT C.record_center_id
				, C.handl_org_cd
				, COUNT(1) AS total
			    , NVL(SUM((CASE WHEN C.read_aprov_month='01' THEN 1 ELSE 0 END)),0) AS sum01
			    , NVL(SUM((CASE WHEN C.read_aprov_month='02' THEN 1 ELSE 0 END)),0) AS sum02
			    , NVL(SUM((CASE WHEN C.read_aprov_month='03' THEN 1 ELSE 0 END)),0) AS sum03
			    , NVL(SUM((CASE WHEN C.read_aprov_month='04' THEN 1 ELSE 0 END)),0) AS sum04
			    , NVL(SUM((CASE WHEN C.read_aprov_month='05' THEN 1 ELSE 0 END)),0) AS sum05
			    , NVL(SUM((CASE WHEN C.read_aprov_month='06' THEN 1 ELSE 0 END)),0) AS sum06
			    , NVL(SUM((CASE WHEN C.read_aprov_month='07' THEN 1 ELSE 0 END)),0) AS sum07
			    , NVL(SUM((CASE WHEN C.read_aprov_month='08' THEN 1 ELSE 0 END)),0) AS sum08
			    , NVL(SUM((CASE WHEN C.read_aprov_month='09' THEN 1 ELSE 0 END)),0) AS sum09
			    , NVL(SUM((CASE WHEN C.read_aprov_month='10' THEN 1 ELSE 0 END)),0) AS sum10
			    , NVL(SUM((CASE WHEN C.read_aprov_month='11' THEN 1 ELSE 0 END)),0) AS sum11
			    , NVL(SUM((CASE WHEN C.read_aprov_month='12' THEN 1 ELSE 0 END)),0) AS sum12
			FROM (
				(
					SELECT A.record_center_id, B.handl_org_cd
						, SUBSTR(B.read_aprov_ymd,5,2) AS read_aprov_month
					FROM  TB_RDREADREQ A
					<isEqual property="divCd" compareValue="1">
						, TB_RDFOLDERREADDETL B
					</isEqual>
					<isNotEqual property="divCd" compareValue="1">
						, TB_RDRECORDREADDETL B
					</isNotEqual>
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					AND   A.read_req_div_cd = #divCd:VARCHAR#
					AND   B.record_center_id = A.record_center_id
					AND   B.read_reqno = A.read_reqno
					AND   B.read_aprov_cd = '2'
					AND   B.read_aprov_ymd LIKE #readApprYmd:VARCHAR#
					<isNotEmpty prepend="AND" property="orgCd">
						B.handl_org_cd = #orgCd:VARCHAR#
					</isNotEmpty>
				) UNION ALL (
					SELECT A.record_center_id, B.handl_org_cd
						, SUBSTR(B.read_aprov_ymd,5,2) AS read_aprov_month
					FROM  TB_NKREADREQ A
					<isEqual property="divCd" compareValue="1">
						, TB_NKFOLDERREADDETL B
					</isEqual>
					<isNotEqual property="divCd" compareValue="1">
						, TB_NKRECORDREADDETL B
					</isNotEqual>
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					AND   A.read_req_div_cd = #divCd:VARCHAR#
					AND   B.record_center_id = A.record_center_id
					AND   B.read_reqno = A.read_reqno
					AND   B.read_aprov_cd = '2'
					AND   B.read_aprov_ymd LIKE #readApprYmd:VARCHAR#
					<isNotEmpty prepend="AND" property="orgCd">
						B.handl_org_cd = #orgCd:VARCHAR#
					</isNotEmpty>
				)
			) C
			GROUP BY C.record_center_id, C.handl_org_cd
		) B
		ORDER BY org_nm
	</select>

	<!--
		이용현황 열람승인처리통계
		: 년도별 통계
	-->
	<resultMap id="findUsageCurStateReadApprStatYearList-result" class="rms.srch.stat.domain.UsageCurState">
		<result property="orgCd"			column="org_cd"			/>
		<result property="orgNm"			column="org_nm"			/>
		<result property="orgAbbrNm"		column="org_abbr_nm"	/>
		<result property="total"			column="total"			/>
		<result property="sum01"			column="sum01"			/>
		<result property="sum02"			column="sum02"			/>
		<result property="sum03"			column="sum03"			/>
		<result property="sum04"			column="sum04"			/>
		<result property="sum05"			column="sum05"			/>
		<result property="sum06"			column="sum06"			/>
		<result property="sum07"			column="sum07"			/>
		<result property="sum08"			column="sum08"			/>
		<result property="sum09"			column="sum09"			/>
		<result property="sum10"			column="sum10"			/>
	</resultMap>
	<select id="findUsageCurStateReadApprStatYearTotal" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateReadApprStatYearList-result">
		SELECT '' AS org_cd
			, '총계' AS org_nm
			, '총계' AS org_abbr_nm
			, NVL((SUM(D.sum01)+SUM(D.sum02)+SUM(D.sum03)+SUM(D.sum04)+SUM(D.sum05)+SUM(D.sum06)+SUM(D.sum07)+SUM(D.sum08)+SUM(D.sum09)+SUM(D.sum10)),0) AS total
		    , NVL(SUM(D.sum01),0) AS sum01
		    , NVL(SUM(D.sum02),0) AS sum02
		    , NVL(SUM(D.sum03),0) AS sum03
		    , NVL(SUM(D.sum04),0) AS sum04
		    , NVL(SUM(D.sum05),0) AS sum05
		    , NVL(SUM(D.sum06),0) AS sum06
		    , NVL(SUM(D.sum07),0) AS sum07
		    , NVL(SUM(D.sum08),0) AS sum08
		    , NVL(SUM(D.sum09),0) AS sum09
		    , NVL(SUM(D.sum10),0) AS sum10
		FROM (
			SELECT NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-9),4,'0') THEN 1 ELSE 0 END)),0) AS sum01
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-8),4,'0') THEN 1 ELSE 0 END)),0) AS sum02
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-7),4,'0') THEN 1 ELSE 0 END)),0) AS sum03
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-6),4,'0') THEN 1 ELSE 0 END)),0) AS sum04
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-5),4,'0') THEN 1 ELSE 0 END)),0) AS sum05
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-4),4,'0') THEN 1 ELSE 0 END)),0) AS sum06
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-3),4,'0') THEN 1 ELSE 0 END)),0) AS sum07
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-2),4,'0') THEN 1 ELSE 0 END)),0) AS sum08
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-1),4,'0') THEN 1 ELSE 0 END)),0) AS sum09
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-0),4,'0') THEN 1 ELSE 0 END)),0) AS sum10
			FROM (
				(
					SELECT A.record_center_id, B.handl_org_cd
						, SUBSTR(B.read_aprov_ymd,1,4) AS read_aprov_year
					FROM  TB_RDREADREQ A
					<isEqual property="divCd" compareValue="1">
						, TB_RDFOLDERREADDETL B
					</isEqual>
					<isNotEqual property="divCd" compareValue="1">
						, TB_RDRECORDREADDETL B
					</isNotEqual>
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					AND   A.read_req_div_cd = #divCd:VARCHAR#
					AND   B.record_center_id = A.record_center_id
					AND   B.read_reqno = A.read_reqno
					AND   B.read_aprov_cd = '2'
					AND  (B.read_aprov_ymd BETWEEN LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-9),4,'0')||'0101' AND #readApprYmd:VARCHAR#||'1231')
					<isNotEmpty prepend="AND" property="orgCd">
						B.handl_org_cd = #orgCd:VARCHAR#
					</isNotEmpty>
				) UNION ALL (
					SELECT A.record_center_id, B.handl_org_cd
						, SUBSTR(B.read_aprov_ymd,1,4) AS read_aprov_year
					FROM  TB_NKREADREQ A
					<isEqual property="divCd" compareValue="1">
						, TB_NKFOLDERREADDETL B
					</isEqual>
					<isNotEqual property="divCd" compareValue="1">
						, TB_NKRECORDREADDETL B
					</isNotEqual>
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					AND   A.read_req_div_cd = #divCd:VARCHAR#
					AND   B.record_center_id = A.record_center_id
					AND   B.read_reqno = A.read_reqno
					AND   B.read_aprov_cd = '2'
					AND  (B.read_aprov_ymd BETWEEN LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-9),4,'0')||'0101' AND #readApprYmd:VARCHAR#||'1231')
					<isNotEmpty prepend="AND" property="orgCd">
						B.handl_org_cd = #orgCd:VARCHAR#
					</isNotEmpty>
				)
			) C
		) D
	</select>
	<select id="findUsageCurStateReadApprStatYearList" parameterClass="rms.srch.stat.domain.UsageCurState" resultMap="findUsageCurStateReadApprStatYearList-result">
		SELECT D.handl_org_cd AS org_cd
			, (CASE WHEN (D.handl_org_cd IS NULL OR D.handl_org_cd = '') THEN '기록관승인' ELSE (SELECT Z.org_nm FROM TB_STORG Z WHERE Z.record_center_id=D.record_center_id AND Z.org_cd=D.handl_org_cd) END) AS org_nm
			, (CASE WHEN (D.handl_org_cd IS NULL OR D.handl_org_cd = '') THEN '기록관승인' ELSE (SELECT Z.org_abbr_nm FROM TB_STORG Z WHERE Z.record_center_id=D.record_center_id AND Z.org_cd=D.handl_org_cd) END) AS org_abbr_nm
			, NVL((D.sum01+D.sum02+D.sum03+D.sum04+D.sum05+D.sum06+D.sum07+D.sum08+D.sum09+D.sum10),0) total
		    , NVL(D.sum01,0) AS sum01
		    , NVL(D.sum02,0) AS sum02
		    , NVL(D.sum03,0) AS sum03
		    , NVL(D.sum04,0) AS sum04
		    , NVL(D.sum05,0) AS sum05
		    , NVL(D.sum06,0) AS sum06
		    , NVL(D.sum07,0) AS sum07
		    , NVL(D.sum08,0) AS sum08
		    , NVL(D.sum09,0) AS sum09
		    , NVL(D.sum10,0) AS sum10
		FROM (
			SELECT C.record_center_id
				, C.handl_org_cd
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-9),4,'0') THEN 1 ELSE 0 END)),0) AS sum01
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-8),4,'0') THEN 1 ELSE 0 END)),0) AS sum02
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-7),4,'0') THEN 1 ELSE 0 END)),0) AS sum03
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-6),4,'0') THEN 1 ELSE 0 END)),0) AS sum04
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-5),4,'0') THEN 1 ELSE 0 END)),0) AS sum05
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-4),4,'0') THEN 1 ELSE 0 END)),0) AS sum06
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-3),4,'0') THEN 1 ELSE 0 END)),0) AS sum07
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-2),4,'0') THEN 1 ELSE 0 END)),0) AS sum08
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-1),4,'0') THEN 1 ELSE 0 END)),0) AS sum09
				, NVL(SUM((CASE WHEN C.read_aprov_year=LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-0),4,'0') THEN 1 ELSE 0 END)),0) AS sum10
			FROM (
				(
					SELECT A.record_center_id, B.handl_org_cd
						, SUBSTR(B.read_aprov_ymd,1,4) AS read_aprov_year
					FROM  TB_RDREADREQ A
					<isEqual property="divCd" compareValue="1">
						, TB_RDFOLDERREADDETL B
					</isEqual>
					<isNotEqual property="divCd" compareValue="1">
						, TB_RDRECORDREADDETL B
					</isNotEqual>
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					AND   A.read_req_div_cd = #divCd:VARCHAR#
					AND   B.record_center_id = A.record_center_id
					AND   B.read_reqno = A.read_reqno
					AND   B.read_aprov_cd = '2'
					AND  (B.read_aprov_ymd BETWEEN LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-9),4,'0')||'0101' AND #readApprYmd:VARCHAR#||'1231')
					<isNotEmpty prepend="AND" property="orgCd">
						B.handl_org_cd = #orgCd:VARCHAR#
					</isNotEmpty>
				) UNION ALL (
					SELECT A.record_center_id, B.handl_org_cd
						, SUBSTR(B.read_aprov_ymd,1,4) AS read_aprov_year
					FROM  TB_NKREADREQ A
					<isEqual property="divCd" compareValue="1">
						, TB_NKFOLDERREADDETL B
					</isEqual>
					<isNotEqual property="divCd" compareValue="1">
						, TB_NKRECORDREADDETL B
					</isNotEqual>
					WHERE A.record_center_id = #recordCenterId:VARCHAR#
					AND   A.read_req_div_cd = #divCd:VARCHAR#
					AND   B.record_center_id = A.record_center_id
					AND   B.read_reqno = A.read_reqno
					AND   B.read_aprov_cd = '2'
					AND  (B.read_aprov_ymd BETWEEN LPAD(TO_CHAR(TO_NUMBER(#readApprYmd:VARCHAR#)-9),4,'0')||'0101' AND #readApprYmd:VARCHAR#||'1231')
					<isNotEmpty prepend="AND" property="orgCd">
						B.handl_org_cd = #orgCd:VARCHAR#
					</isNotEmpty>
				)
			) C
			GROUP BY C.record_center_id, C.handl_org_cd
		) D
		ORDER BY org_nm
	</select>

</sqlMap>
